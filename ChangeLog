2008-04-03 Ray Strode <rstrode@redhat.com>
	* gui/simple-greeter/gdm-timer.[ch]:
	new files to make animations easier
	* gui/simple-greeter/gdm-chooser-widget.c
	(struct GdmChooserWidgetPrivate),
	(on_shrink_animation_tick), (on_grow_animation_tick),
	(on_shrink_animation_stop), (on_grow_animation_stop),
	(start_shrink_animation), (gdm_chooser_widget_finalize):
	* common/gdm-marshal.list:
	Switch chooser over to use timer

2008-04-03 Ray Strode <rstrode@redhat.com>

	* gui/simple-greeter/gdm-chooser-widget.c
	(struct GdmChooserWidgetPrivate),
	(run_animation), (run_shrink_animation), (run_grow_animation),
	(on_shrink_animation_done), (on_animation_done),
	(on_grow_animation_done), (start_shrink_animation),
	(start_grow_animation), (skip_animation), (skip_resize_animation),
	(gdm_chooser_widget_hide), (gdm_chooser_widget_show):
	Split grow and shrink animation into independent code paths

2008-04-03 Ray Strode <rstrode@redhat.com>

	* gui/simple-greeter/gdm-chooser-widget.c
	(struct GdmChooserWidgetPrivate), (on_animation_timeout),
	(on_animation_done), (start_animation):
	s/animation_timeout_id/resize_animation_timeout_id/

2008-04-02  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-welcome-session.c: (spawn_child_setup),
	(spawn_command_line_sync_as_user),
	(spawn_command_line_async_as_user), (start_dbus_daemon),
	(gdm_welcome_session_spawn):
	Log greeter output to a file in /var/log/gdm.

2008-04-02  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/greeter-main.c: (at_set_gtk_modules),
	(load_a11y):
	Enable a11y unless it is explicitly turned off.

2008-04-02  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-local-display-factory.c:
	(on_static_display_status_changed):
	* daemon/gdm-session-worker.c:
	(gdm_session_worker_update_username), (state_change_idle):
	Fix text in some debug statements and warnings.

2008-04-02  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-local-display-factory.c:
	(on_static_display_status_changed):
	Don't g_critical when bailing out after max num of
	xserver failures since that triggers a backtrace.

2008-03-31  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-manager.c: (remove_displays_for_connection):
	Remove a particularly noisy debug line.

2008-03-31  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-user-manager.c: (reload_passwd),
	(reload_shells), (gdm_user_manager_init):
	Explicitly exclude users with shells that are well
	known as invalid shells: /sbin/nologin, /bin/false.

2008-03-31  William Jon McCann  <jmccann@redhat.com>

	* utils/gdmflexiserver.c: (gdm_flexiserver_error_quark),
	(maybe_lock_screen), (create_transient_display),
	(goto_login_session), (main):
	Display nicer error messages.  Use an icon.  Use
	close button instead of ok.

2008-03-31  William Jon McCann  <jmccann@redhat.com>

	* utils/gdmflexiserver.c: (main):
	Add --version command line option.

2008-03-31  William Jon McCann  <jmccann@redhat.com>

	* gui/user-switch-applet/Makefile.am:
	* gui/user-switch-applet/gdm-user-switch-applet.glade:
	Remove some unused glade stuff.
	* gui/user-switch-applet/gdm-user-menu-item.c: (reset_sensitivity),
	(on_user_icon_changed):
	Fix some warnings.
	* gui/user-switch-applet/applet.c: (user_sessions_changed_cb),
	(maybe_add_user), (manager_user_added_cb), (fill_applet):
	Until we add support to GDM for preselecting the user during
	FUS we should only display the currently logged in users in the applet.

2008-03-27  Brian Cameron  <brian.cameron@sun.com>

	* daemon/gdm-session-linux-auditor.[ch],
	  daemon/gdm-session-auditor.[ch],
	  daemon/gdm-session-solaris-auditor.[ch]:  Add ", Inc." to
	  "Sun Microsystems, Inc." copyright notice so it is correct.

2008-03-26  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode),
	(gdm_greeter_login_window_key_press_event),
	(gdm_greeter_login_window_init):
	Don't cancel the dialog when there is nothing to cancel.

2008-03-26  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-address.c:
	* configure.ac:
	Add a configure check for stropts.h since it has been
	removed from glibc.

2008-03-26  William Jon McCann  <jmccann@redhat.com>

	* data/session-setup.entries:
	Disable g-p-m context menu.

2008-03-26  William Jon McCann  <jmccann@redhat.com>

	* data/session-setup.entries:
	Add more lockdown.

	* gui/simple-greeter/gdm-greeter-session.c:
	(activate_settings_daemon), (start_settings_daemon),
	(toggle_all_levels):
	Add back manually starting g-s-d if we can't activate it.

2008-03-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-language-chooser-widget.c
	(GdmLanguageChooserWidgetPrivate),
	(gdm_language_chooser_widget_realize),
	(gdm_language_chooser_class_init):
	populate the language list when the widget is realized
	instead of when it is first created

2008-03-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-language-chooser-widget.c
	(gdm_language_chooser_widget_dispose),
	(gdm_langauge_chooser_widget_class_init):
	move some blocks of code around in the file to
	facilitate readability

2008-03-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c
	(gdm_get_language_from_name),
	(gdm_get_all_language_names):
	only create/populate the hash tables that are needed
	from either function instead of all hash tables from
	both functions

2008-03-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c
	(gdm_locale_free), (collect_locales):
	rename chooser_locale_free to gdm_locale_free

2008-03-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c
	(add_locale), (collect_locales_from_archive),
	(collect_locales_from_directory):
	refactor common inner loop code between
	collect_locales_from_* to new add_locale function

2008-03-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c
	(collect_locales_from_archive), (collect_locales):
	Don't read from archive by default for now. We're
	really interested in which locales the user has
	translations for, not all the locales glibc knows
	about.

2008-03-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c
	(GdmLocale), (chooser_locale_free),
	(utf8_convert), (get_lc_identification),
	(collect_locales_from_archive),
	(collect_locales_from_directory):
	Don't get the LC_IDENTIFICATION information about
	locales, since we don't need it and it's just
	extra work

2008-03-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-language-chooser-dialog.c
	(gdm_language_chooser_dialog_init):
	Replace erroneous use of g_get_language_names with
	setlocale (LC_MESSAGES, NULL)

2008-03-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c
	(collect_locales_from_aliases),
	(collect_locales):
	drop unimplemented function

2008-03-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(collect_locales_from_directory):
	if a directory name in /usr/share/locale isn't a
	valid utf-8 locale, then try appending .utf8 to
	the name to find the utf8 locale.

2008-03-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages:
	(select_dirs), (collect_locales_from_directory):
	When looking for locales, look in /usr/share/locale
	instead of /usr/lib/locale

2008-03-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(collect_locales_from_archive):
	Don't sort names read from archive, since they're just
	going to get stuffed into a hash table

2008-03-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(collect_locales_from_archive),
	(collect_locales):
	Don't scandir locale directory if we've successfully
	read the locales from the archive

2008-03-24  Brian Cameron  <brian.cameron@sun.com>

	* common/gdm-profile.c: Fix NULL string issue in printf call.

2008-03-24  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(create_computer_info), (custom_widget_constructor), (load_theme):
	* gui/simple-greeter/gdm-greeter-session.c:
	(gdm_greeter_session_init):
	* gui/simple-greeter/greeter-main.c: (assistive_registry_launch),
	(assistive_registry_start), (at_set_gtk_modules):
	Add some more profile resolution.

2008-03-23  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-language-option-widget.c: (create_dialog),
	(gdm_language_option_widget_init):
	* gui/simple-greeter/test-languages.c: (print_languages), (main):
	Add a test tool for language lookup and resolution.

2008-03-23  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_constructor),
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-panel.c:
	(gdm_greeter_panel_constructor), (gdm_greeter_panel_init):
	Add a few more profile points.

2008-03-23  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-profile.h:
	* configure.ac:
	* gui/simple-greeter/gdm-greeter-client.c:
	(gdm_greeter_client_start):
	* gui/simple-greeter/gdm-greeter-session.c: (toggle_panel),
	(toggle_login_window), (launch_compiz), (launch_metacity),
	(start_window_manager), (activate_settings_daemon),
	(gdm_greeter_session_start):
	* gui/simple-greeter/gdm-session-manager.c: (_change_level),
	(gdm_session_manager_set_level):
	* gui/simple-greeter/greeter-main.c: (load_a11y), (main):
	Add some more profiling stuff.

	The greeter can now be profiled like so:
	strace -ttt -f -o /tmp/logfile.strace -p `/sbin/pidof gdm-binary`
	python plot-timeline.py -o prettygraph.png /tmp/logfile.strace

	See: http://www.gnome.org/~federico/news-2006-03.html#09

2008-03-23  William Jon McCann  <jmccann@redhat.com>

	* common/Makefile.am:
	* common/gdm-profile.c: (_gdm_profile_log):
	* common/gdm-profile.h:
	Add a function to help with profiling.

2008-03-19  William Jon McCann  <jmccann@redhat.com>

	* data/session-setup.entries:
	Use gdm-screenshot.

2008-03-19  William Jon McCann  <jmccann@redhat.com>

	* gui/user-switch-applet/applet.c: (sort_menu):
	* utils/Makefile.am:
	* utils/gdm-screenshot.c: (screenshot_grab_lock),
	(screenshot_release_lock), (screenshot_get_pixbuf),
	(screenshot_save), (prepare_screenshot), (main):
	Add screenshot tool.

2008-03-19  Ray Strode <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c
	(do_cancel), (reset_dialog):
	Consolidate do_cancel and reset_dialog since they
	overlapped in functionality.
	(gdm_greeter_login_window_key_press_event):
	call do_cancel instead of reset_dialog when escape is pressed

2008-03-19  Ray Strode <rstrode@redhat.com>

	* daemon/gdm-simple-slave.c
	(gdm_simple_slave_accredit_when_ready):
	reset "waiting_to_start_session" state variable to FALSE
	once we've initiated a session start operation

2008-03-19  Ray Strode <rstrode@redhat.com>

	* daemon/gdm-session-worker.c
	(gdm_session_worker_accredit_user):
	* daemon/gdm-session-direct.c
	(setup_session_environment):
	Make PATH setup consistent between two file

2008-03-18  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-user-manager.c:
	Add missing include.

2008-03-18  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-simple-slave.c:
	(gdm_simple_slave_accredit_when_ready), (start_session_timeout),
	(on_session_accreditation_failed):
	Make sure to kill the simple slave after switching to an
	existing session.

2008-03-18  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-user-manager.c: (get_seat_id_for_session),
	(get_x11_display_for_session), (reload_ck_history),
	(reload_passwd), (reload_users), (reload_shells),
	(on_shells_monitor_changed), (on_passwd_monitor_changed),
	(gdm_user_manager_init), (gdm_user_manager_finalize):
	Load local users and monitor passwd for changes.

2008-03-17  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-session-worker.c: (on_start_program):
	* daemon/gdm-simple-slave.c: (start_session_timeout),
	(on_session_accreditation_failed), (on_greeter_cancel):
	Close the session immediately after migration so there
	are no races.

2008-03-17  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(gdm_language_chooser_widget_add_language):
	* gui/simple-greeter/gdm-language-option-widget.c:
	(gdm_language_option_widget_lookup_item):
	* gui/simple-greeter/gdm-languages.c: (get_translated_language),
	(get_translated_territory), (gdm_get_language_from_name):
	* gui/simple-greeter/gdm-languages.h:
	Show name in current language in a tooltip.
	From: Matthias Clasen <mclasen@redhat.com>

2008-03-17  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-signal-handler.c: (gdm_signal_handler_finalize):
	* daemon/gdm-display.c: (gdm_display_real_create_authority),
	(gdm_display_real_add_user_authorization),
	(gdm_display_constructor):
	* daemon/gdm-slave.c: (gdm_slave_finalize):
	* daemon/main.c: (main):
	Fix a few more mem and fd leaks.

2008-03-17  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-common.c: (gdm_wait_on_pid), (gdm_signal_pid),
	(_read_bytes), (gdm_generate_random_bytes):
	* common/gdm-common.h:
	* common/gdm-settings-desktop-backend.c: (parse_key_string),
	(gdm_settings_desktop_backend_get_value),
	(gdm_settings_desktop_backend_finalize):
	* common/gdm-settings-utils.c: (gdm_settings_parse_schemas):
	* daemon/gdm-server.c: (server_died), (gdm_server_stop):
	* daemon/gdm-session-worker-job.c: (session_worker_job_died),
	(gdm_session_worker_job_stop):
	* daemon/gdm-slave-proxy.c: (child_watch), (kill_slave),
	(gdm_slave_proxy_stop), (gdm_slave_proxy_dispose),
	(gdm_slave_proxy_finalize):
	* daemon/gdm-welcome-session.c: (stop_dbus_daemon),
	(welcome_session_died), (gdm_welcome_session_stop):
	* daemon/main.c: (main):
	* gui/simple-greeter/gdm-remote-login-window.c: (xserver_died):
	* gui/simple-greeter/gdm-session-client.c: (client_died),
	(gdm_session_client_stop):
	Move wait_on_child to common.  Always check return value of
	gdm_signal_pid.  Fix a number of small leaks.  Make sure
	to signal the slaves when exiting.

2008-03-17  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-panel.c: (gdm_greeter_panel_init):
	Don't set opacity on login window.

2008-03-17  William Jon McCann  <jmccann@redhat.com>

	* data/session-setup.entries:
	Add a few more required plugins.

2008-03-17  William Jon McCann  <jmccann@redhat.com>

	* data/session-setup.entries:
	* gui/simple-greeter/gdm-greeter-session.c: (launch_compiz),
	(start_window_manager):
	Lock down some compiz keys.  Set LIBGL_ALWAYS_INDIRECT for compiz.

2008-03-17  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-session.c: (start_window_manager):
	* gui/simple-greeter/gdm-simple-greeter.schemas.in:
	Add a gconf key to enable preferring compiz over metacity.

2008-03-17  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-welcome-session.c (get_welcome_environment):
	Set an environment variable to disable fuse mounts in gvfs.
	From: Matthias Clasen <mclasen@redhat.com>

2008-03-17  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-chooser-widget.c: (search_equal_func),
	(gdm_chooser_widget_init):
	Compare both name and id fields when doing typeahead search.

2008-03-17  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-simple-slave.c: (on_session_started),
	(gdm_simple_slave_accredit_when_ready):
	Don't pretend to support refreshing creds.

2008-03-16  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_problem):
	* gui/simple-greeter/gdm-simple-greeter.schemas.in:
	Beep on auth problem.  Enable sound plugin.

2008-03-15  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(on_window_state_event), (gdm_greeter_login_window_init):
	Deiconify the window when it is iconified.

2008-03-15  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-session-direct.c: (session_worker_message):
	* daemon/gdm-session-worker.c: (on_reauthenticate),
	(on_reauthorize), (on_refresh_credentials),
	(worker_dbus_handle_message):
	* daemon/gdm-session-worker.h:
	Add preliminary support to the state machine for
	session unlocking.

2008-03-14  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-manager.c: (bus_name_owner_changed):
	* daemon/gdm-product-slave.c: (send_dbus_string_method),
	(send_dbus_void_method), (send_dbus_int_method),
	(relay_session_started), (on_session_started),
	(on_relay_refresh_credentials), (relay_dbus_handle_message):
	* daemon/gdm-session-direct.c:
	(gdm_session_direct_handle_session_started), (do_introspect),
	(gdm_session_direct_accredit):
	* daemon/gdm-session-private.h:
	* daemon/gdm-session-relay.c: (gdm_session_relay_accredit),
	(handle_secret_info_query), (handle_info), (handle_problem),
	(handle_session_started), (do_introspect),
	(gdm_session_iface_init):
	* daemon/gdm-session-worker.c:
	(gdm_session_worker_update_environment_from_passwd_info),
	(_change_user), (_lookup_passwd_info),
	(gdm_session_worker_accredit_user), (on_refresh_credentials),
	(worker_dbus_handle_message):
	* daemon/gdm-session.c: (gdm_session_class_init),
	(_gdm_session_session_started):
	* daemon/gdm-session.h:
	* daemon/gdm-simple-slave.c: (on_session_started),
	(gdm_simple_slave_accredit_when_ready), (on_greeter_connected):
	* daemon/gdm-slave.c: (gdm_slave_get_primary_session_id_for_user),
	(gdm_slave_switch_to_user_session):
	* daemon/gdm-slave.h:
	Refactor things a little.  Rename renew to refresh.  Add a pid to the
	session started signal.

2008-03-13  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-panel.c: (gdm_greeter_panel_init):
	Really center the choosers.

2008-03-13  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-session-worker.c (gdm_session_worker_pam_new_messages_handler):
	Check for null response.

2008-03-13  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-panel.c:
	(is_a11y_button_disabled), (gdm_greeter_panel_init):
	* gui/simple-greeter/test-greeter-panel.c: (main):
	Try centering language and session chooser widgets on panel.

2008-03-12  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-session.c: (launch_compiz):
	use glib and gconf plugins when running compiz

2008-03-12  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-chooser-server.c: (handle_select_hostname),
	(handle_disconnect), (do_introspect):
	* daemon/gdm-product-slave.c: (send_dbus_string_method),
	(send_dbus_void_method):
	* daemon/gdm-session-worker.c: (send_dbus_string_method),
	(send_dbus_int_method), (send_dbus_void_method):
	* daemon/gdm-slave.c: (activate_session_id), (session_unlock):
	* gui/simple-chooser/gdm-chooser-client.c:
	(send_dbus_string_method), (send_dbus_void_method):
	* gui/simple-greeter/gdm-greeter-client.c:
	(send_dbus_string_method), (send_dbus_bool_method),
	(send_dbus_void_method):
	* gui/simple-greeter/gdm-greeter-session.c:
	(send_dbus_string_method):
	* gui/simple-greeter/gdm-user-manager.c: (activate_session_id):
	* utils/gdmflexiserver.c: (create_transient_display),
	(get_current_session_id), (get_seat_id_for_session),
	(activate_session_id), (session_is_login_window),
	(seat_can_activate_sessions):
	Fix a few leaks and make sure we don't unref null replies.

2008-03-11  Ray Strode <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(on_user_interaction), (on_xevent),
	(stop_watching_for_user_interaction),
	(watch_for_user_interaction):
	Restart automatic login timer if user is doing
	things in the session.

2008-03-10  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-user-manager.c: (process_ck_history_line):
	* gui/user-switch-applet/applet.c: (fill_applet):
	Handle case where we can't lookup a GdmUser (for whatever reason).
	Could be gone, excluded, etc...

2008-03-10  William Jon McCann  <jmccann@redhat.com>

	* configure.ac: Post release version bump

==== 2.21.9 ====

2008-03-10  William Jon McCann  <jmccann@redhat.com>

	* NEWS: Update for release

2008-03-10  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-signal-handler.c: (signal_io_watch),
	(crashlogger_get_backtrace), (gdm_signal_handler_backtrace),
	(signal_handler), (gdm_signal_handler_add_fatal):
	* common/gdm-signal-handler.h:
	* daemon/main.c: (signal_cb), (main):
	* gui/simple-greeter/greeter-main.c: (signal_cb), (main):
	Don't glog in the signal handlers.  Add a default
	SIGTRAP handler so we get backtraces in unstable releases.

2008-03-10  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_class_init):
	Remove duplicate signal definition.

2008-03-10  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-crash-logger.c: (main):
	Log pid too.  Only do perror if available.

2008-03-10  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-server.c: (_gdm_server_set_disable_tcp),
	(gdm_server_set_property), (gdm_server_get_property),
	(gdm_server_class_init):
	Add a property for disable-tcp and default to TRUE.

2008-03-10  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-chooser-widget.c:
	(start_timer), (stop_timer):
	Actually remove high frequency timeout when
	timer is stopped...

2008-03-10  Ray Strode  <rstrode@redhat.com>

	* daemon/Makefile.am: add gdm-session-direct.xml to
	EXTRA_DIST

2008-03-09  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-simple-slave.c:
	(on_session_authorized),
	* daemon/gdm-greeter-server.[ch]:
	(gdm_greeter_server_user_authorized),
	(do_introspect):
	When the user has successfully been verified,
	inform the greeter, so that it can make a judgement
	about whether the user's session should be opened.
	* gui/simple-greeter/gdm-greeter-client.c:
	(on_user_authorized), (client_dbus_handle_message),
	(gdm_greeter_client_class_init):
	* gui/simple-greeter/gdm-greeter-session.c
	(on_user_authorized), (gdm_greeter_session_init):
	forward "user-authorized" signal from slave to
	login window
	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_user_authorized):
	When the user is verified start the session as soon
	as the user has had an opporunity to interact with
	language and session choosers

2008-03-09  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.[ch]:
	(do_cancel), (gdm_greeter_login_window_start_when_ready),
	(gdm_greeter_login_window_class_init):
	add new "start-session" to replace "interactive" from before
	* gui/simple-greeter/gdm-greeter-session.c:
	(on_start_session), (toggle_login_window):
	Tell slave to start session when login window is ready for
	the session to be started.

2008-03-09  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(GdmGreeterLoginWindowPrivate),
	(_gdm_greeter_login_window_set_interactive),
	(timed_login_timer), (on_button_clicked_answer_query),
	(on_login_button_clicked_timed_login), (do_cancel),
	(gdm_greeter_login_window_set_property),
	(gdm_greeter_login_window_get_property),
	(gdm_greeter_login_window_class_init)):
	Make "is-interactive" property to replace "interactive"
	signal, since we're going to need to track it's state
	from within the login window.
	* gui/simple-greeter/gdm-greeter-session.c:
	(GdmGreeterSessionPrivate), (on_reset):
	Don't track interactive state here anymore, we'll
	rely on the login window to tell us when to start
	the session instead of trying to figure it out
	ourselves

2008-03-09  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c
	(gdm_greeter_login_window_request_timed_login),
	(do_cancel), (on_user_chosen):
	Keep timed_login_enabled in sync with state of
	automatic login user selection

2008-03-09  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c
	(switch_mode), (do_cancel), (reset_dialog),
	(gdm_greeter_login_window_request_timed_login),
	(on_user_chosen):
	Only show automatic login timer when the automatic
	login user is selected

2008-03-09  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-simple-slave.c (on_greeter_auto_login):
	* daemon/gdm-greeter-server.[ch]:
	(handle_begin_auto_login), (greeter_handle_child_message),
	(gdm_greeter_server_class_init):
	* gui/gdm-greeter-client.[ch]:
	(gdm_greeter_client_call_begin_auto_login):
	* gui/gdm-greeter-session.[ch]:
	(on_begin_auto_login):
	* gui/gdm-greeter-login-window.[ch]:
	(timed_login_timer), (on_login_button_clicked_answer_query),
	(on_user_chosen), (gdm_greeter_login_window_class_init):
	Rename "Timed Login" request on the slave to "Auto Login"
	since that's what it is.  All the delay logic happens in
	the greeter and the slave just logins in immediately after
	getting the request

2008-03-09  Ray Strode  <rstrode@redhat.com>

	Read timed login configuration from the daemon,
	and pass along rather than reading it from the daemon
	and greeter.

	* daemon/gdm-simple-slave.c:
	(get_timed_login_details):
	(on_session_opened):
	* daemon/gdm-greeter-server.[ch]:
	(gdm_server_request_timed_login):
	Read timed login configuration and forward to greeter
	* gui/simple-greeter/gdm-greeter-client.[ch]:
	(on_timed_login_requested), (client_dbus_handle_message),
	(gdm_greeter_client_class_init):
	* gui/simple-greeter/gdm-greeter-session.[ch]:
	(on_timed_login_requested), (gdm_greeter_session_init):
	Forward timed login requests from slave to login window
	* gui/simple-greeter/gdm-greeter-login-window.[ch]:
	(load_theme): don't show "automatic login" entry here
	anymore
	(gdm_greeter_login_window_request_timed_login):
	show "automatic login" entry in face browser, start
	timer
	(read_configuration): drop function
	(gdm_greeter_login_window_constructor): don't call
	read_configuration anymore
	(gdm_greeter_login_window_init): don't initialized
	timed_login_delay here anymore since it's sent up from
	slave now

2008-03-09  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.[ch]:
	(on_login_button_clicked_answer_query):
	(gdm_greeter_login_window_class_init):
	* gui/simple-greeter/gdm-greeter-session.c:
	(GdmGreeterSessionPrivate), (on_reset),
	(on_interactive), (toggle_login_window):
	Add new "interactive" signal to login window which is
	emitted when the user has had an opportunity to interact
	with session / language choosers. Have greeter session
	watch for this signal to decide when to tell the slave
	when to proceed with starting the session

2008-03-09  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-simple-slave.c:
	(GdmSimpleSlavePrivate),
	(gdm_simple_slave_accredit_when_ready),
	(on_start_session_when_ready),
	(on_start_session_later),
	(setup_server):
	* daemon/gdm-greeter-server.[ch]:
	(handle_start_session_when_ready):
	(greeter_handle_child_message):
	(do_introspect):
	(gdm_greeter_server_class_init):
	* gui/simple-greeter/gdm-greeter-client.[ch]:
	(gdm_greeter_client_call_start_session_when_ready):
	After successfully verifying the user, wait until
	the greeter gives the go ahead before starting the
	user's session

2008-03-09  Ray Strode  <rstrode@redhat.com>

	* common/gdm-marshal.list (VOID:STRING,INT):
	* daemon/gdm-greeter-server.c:
	(send_dbus_string_and_int_signal):
	* gui/simple-greeter/gdm-greeter-client.c
	(emit_string_and_int_signal_for_message),
	(send_dbus_bool_method),
	(send_dbus_bool_method):
	Add some helper functions that will be useful later

2008-03-08  William Jon McCann  <jmccann@redhat.com>

	* common/Makefile.am:
	* common/gdb-cmd:
	* common/gdm-crash-logger.c: (main):
	* configure.ac:
	Add crash logger tool.

2008-03-08  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-signal-handler.c: (signal_io_watch):
	* gui/simple-greeter/greeter-main.c: (signal_cb), (main):
	Hook up signal handler to greeter.

2008-03-06  Brian Cameron  <brian.cameron@sun.com>

	* gui/simple-greeter/gdm-greeter-login-window.c:  Fix NULL string
	  issue in debug statement.

2008-03-06  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-signal-handler.c (signal_handler): Cast the signal
	number to a byte before sending over the pipe.
	Patch from: David Woodhouse <dwmw2@redhat.com>

2008-03-05  William Jon McCann  <jmccann@redhat.com>

	* daemon/Makefile.am:
	* daemon/gdm-product-slave.c: (create_new_session):
	* daemon/gdm-session-direct.c: (gdm_session_direct_init),
	(_gdm_session_direct_set_display_id),
	(gdm_session_direct_set_property),
	(gdm_session_direct_get_property), (gdm_session_direct_dispose),
	(gdm_session_direct_finalize), (register_session),
	(gdm_session_direct_constructor), (gdm_session_direct_class_init),
	(gdm_session_direct_new), (gdm_session_direct_restart),
	(gdm_session_direct_stop), (gdm_session_direct_detach):
	* daemon/gdm-session-direct.h:
	* daemon/gdm-session-direct.xml:
	* daemon/gdm-simple-slave.c: (create_new_session):
	* daemon/gdm-slave.c: (gdm_slave_constructor):
	* daemon/test-session.c: (main):
	* data/gdm.conf:
	Put the SessionDirect on the bus.  Doesn't do anything yet.

2008-03-05  William Jon McCann  <jmccann@redhat.com>

	* data/gdm.conf:
	Invert the sense of the policy.  Deny first.

2008-03-05  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-settings-desktop-backend.c:
	Don't allow empty strings for keys.

2008-03-05  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-session-worker.c: (script_execute), (my_strchrnul),
	(gdm_session_execute), (gdm_session_worker_process_pam_message),
	(gdm_session_worker_pam_new_messages_handler):
	* gui/simple-greeter/gdm-greeter-login-window.c:
	(delete_entry_text), (reset_dialog),
	(gdm_greeter_login_window_info_query),
	(gdm_greeter_login_window_secret_info_query):
	Try a little harder to not keep sensitive data in memory.

2008-03-05  Ray Strode <rstrode@redhat.com>

	* gui/simple-greeter/gdm-cell-renderer-timer.c
	(gdm_cell_renderer_timer_render):
	Draw selected timers with the right colors when they
	aren't focused

2008-03-05  Ray Strode <rstrode@redhat.com>

	* gui/simple-greeter/Makefile.am:
	Link common convenience lib to test binary, to
	prevent build failure

2008-03-04  Ray Strode <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c
	(restart_timed_login_timeout):
	add timer animation next to automatic login user

2008-03-04  Ray Strode <rstrode@redhat.com>

	* gui/simple-greeter/Makefile.am:
	add timer cell renderer to build
	* gui/simple-greeter/gdm-chooser-widget.[ch]:
	(GdmChooserWidgetPrivate), (gdm_chooser_widget_init),
	(gdm_chooser_widget_finalize), (get_current_time),
	(on_timer_timeout), (start_timer), (stop_timer),
	(update_timer_from_time), (gdm_chooser_widget_set_item_timer):
	Add new timer api to chooser widget that shows a timer
	in the status column

2008-03-04  Ray Strode <rstrode@redhat.com>

	* gui/simple-greeter/gdm-chooser-widget.c:
	(GdmChooserWidgetPrivate), (update_column_visibility),
	(gdm_chooser_widget_init), (gdm_chooser_widget_update_item),
	(gdm_chooser_widget_add_item), (gdm_chooser_widget_remove_item),
	(gdm_chooser_widget_set_item_in_use):
	rename in_use_column and number_of_in_use_rows to status_column
	and number_of_rows_with_status respectively, in preparation for
	packing the animated timer into the same status column

2008-03-04  Ray Strode <rstrode@redhat.com>

	* gui/simple-greeter/gdm-cell-renderer-timer.[ch]:
	New cell renderer that does clock count-down animation
	(will be improved to be themable later)

2008-03-04  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-chooser/gdm-host-chooser-dialog.c:
	(gdm_host_chooser_dialog_constructor):
	* gui/simple-chooser/gdm-host-chooser.c: (main):
	* gui/simple-greeter/gdm-remote-login-window.c:
	(gdm_remote_login_window_init):
	Use a connect button, set an initial size for the window,
	remove decorations.

2008-03-04  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-remote-login-window.c: (wait_on_child),
	(xserver_died), (stop_xserver), (xserver_child_watch),
	(start_xephyr):
	* gui/simple-greeter/gdm-session-client.c: (wait_on_child),
	(gdm_session_client_dispose):
	* gui/simple-greeter/test-remote-login-window.c: (main):
	Destroy the remote login window when the xserver quits.

2008-03-04  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-chooser/Makefile.am:
	* gui/simple-chooser/gdm-chooser-host.c:
	(gdm_chooser_host_get_address), (gdm_chooser_host_get_description),
	(gdm_chooser_host_get_kind), (gdm_chooser_host_get_willing),
	(_gdm_chooser_host_set_address),
	(_gdm_chooser_host_set_description), (_gdm_chooser_host_set_kind),
	(_gdm_chooser_host_set_willing), (gdm_chooser_host_set_property),
	(gdm_chooser_host_get_property), (gdm_chooser_host_class_init),
	(gdm_chooser_host_init), (gdm_chooser_host_finalize):
	* gui/simple-chooser/gdm-chooser-host.h:
	* gui/simple-chooser/gdm-chooser-session.c: (on_dialog_response),
	(gdm_chooser_session_start):
	* gui/simple-chooser/gdm-host-chooser-dialog.c:
	(gdm_host_chooser_dialog_get_host),
	(_gdm_host_chooser_dialog_set_kind_mask),
	(gdm_host_chooser_dialog_set_property), (on_response),
	(gdm_host_chooser_dialog_constructor),
	(gdm_host_chooser_dialog_class_init),
	(gdm_host_chooser_dialog_init), (gdm_host_chooser_dialog_new):
	* gui/simple-chooser/gdm-host-chooser-dialog.h:
	* gui/simple-chooser/gdm-host-chooser-widget.c: (find_known_host),
	(browser_add_host), (decode_packet), (xdmcp_init),
	(gdm_host_chooser_widget_refresh),
	(gdm_host_chooser_widget_get_host),
	(_gdm_host_chooser_widget_set_kind_mask),
	(gdm_host_chooser_widget_set_property),
	(gdm_host_chooser_widget_constructor),
	(gdm_host_chooser_widget_dispose),
	(gdm_host_chooser_widget_class_init),
	(gdm_host_chooser_widget_init), (gdm_host_chooser_widget_new):
	* gui/simple-chooser/gdm-host-chooser-widget.h:
	* gui/simple-chooser/gdm-host-chooser.c: (main):
	Abstract the host selection to be able to support
	other kinds in addition to XDMCP.

2008-03-03  William Jon McCann  <jmccann@redhat.com>

	* gui/user-switch-applet/applet.c: (maybe_lock_screen),
	(do_switch):
	Be sure to lock screen when switching to login window.
	Also trim some fat.

2008-03-03  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-user.c: (gdm_user_collate):
	* gui/user-switch-applet/applet.c: (sort_menu_comparedatafunc),
	(sort_menu), (menu_style_set_cb), (fill_applet):
	Order the users in the applet the same way we do for the greeter:
	in order of login frequency.

2008-03-03  William Jon McCann  <jmccann@redhat.com>

	* gui/user-switch-applet/gdm-user-menu-item.c: (reset_icon),
	(reset_sensitivity), (on_user_notify), (on_user_icon_changed),
	(on_user_sessions_changed), (_gdm_user_menu_item_set_user):
	Desensitize the current user.

2008-02-29  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c
	(is_capslock_on): return state of caps lock key,
	not state of caps lock indicator light

2008-02-29  Ray Strode  <rstrode@redhat.com>

	Don't eat all key presses in caps lock handler

	* gui/simple-greeter/gdm-greeter-login-window.c
	(gdm_greeter_login_window_key_press_event):
	check caps lock here
	(window_key_press), (gdm_greeter_login_window_init):
	drop separate function that checks caps lock.

2008-02-28  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	* gui/simple-greeter/gdm-greeter-session.c:
	(send_dbus_string_method), (activate_settings_daemon),
	(toggle_all_levels):
	Use the new g-s-d method to dbus activate the service.
	Block while the plugins load so we don't cause problems
	and ugliness when widgets start to draw.

2008-02-28  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(get_show_restart_buttons), (load_theme), (update_banner_message),
	(gdm_greeter_login_window_constructor), (on_gconf_key_changed),
	(gdm_greeter_login_window_init),
	(gdm_greeter_login_window_finalize):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	* gui/simple-greeter/gdm-simple-greeter.schemas.in:
	Add a banner message feature.

2008-02-28  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-direct.c
	(get_session_command_for_file):
	Don't bail if TryExec isn't set. It's optional.

2008-02-28  William Jon McCann  <jmccann@redhat.com>

	* data/session-setup.entries:
	Set /apps/nautilus/preferences/show_desktop to false
	to work around #518750.

2008-02-27  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c: (capslock_update),
	(is_capslock_on), (load_theme), (window_key_press),
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Add a capslock key warning message.

2008-02-27  Ray Strode  <rstrode@redhat.com>

	* daemon/main.c (main):
	ignore unknown options, so removed options don't cause it to
	abort

2008-02-27  William Jon McCann  <jmccann@redhat.com>

	* gui/user-switch-applet/GNOME_FastUserSwitchApplet.xml:
	* gui/user-switch-applet/Makefile.am:
	* gui/user-switch-applet/applet.c: (get_glade_xml),
	(menubar_button_press_event_cb), (help_cb), (set_menuitem_icon),
	(applet_style_set_cb), (gdm_applet_data_free), (sort_menu),
	(menu_style_set_cb), (menuitem_destroy_cb),
	(menuitem_style_set_cb), (maybe_lock_screen), (do_switch),
	(user_item_activate_cb), (user_sessions_changed_cb), (add_user),
	(manager_user_added_cb), (login_screen_activate_cb),
	(client_notify_applet_func), (client_notify_global_func),
	(fill_applet), (applet_factory):
	* gui/user-switch-applet/gdm-user-switch-applet.schemas.in:
	Remove gconf settings from user switch applet - simplifies
	code dramatically.  Fix crash when adding multiple applets
	to panel.

2008-02-27  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-option-widget.c:
	(gdm_option_widget_set_default_item): handle NULL item better
	(was causing crash on failed auth)

2008-02-27  William Jon McCann  <jmccann@redhat.com>

	* data/gdm.conf: Allow sending to LocalDisplayFactory interface
	by default.

2008-02-27  William Jon McCann  <jmccann@redhat.com>

	* gui/user-switch-applet/GNOME_FastUserSwitchApplet.server.in.in:
	* gui/user-switch-applet/GNOME_GdmUserSwitchApplet.server.in.in:
	* gui/user-switch-applet/GNOME_GdmUserSwitchApplet.xml:
	* gui/user-switch-applet/Makefile.am:
	* gui/user-switch-applet/applet.c: (about_me_cb), (about_cb),
	(applet_fill_cb):
	Use the same oafiid as FUSA so we can be a drop in replacement.
	Note that we now conflict with FUSA.

2008-02-26  William Jon McCann  <jmccann@redhat.com>

	* daemon/main.c: (main):
	Don't daemonize and remove some unused options.

2008-02-26  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-worker.c:
	(gdm_session_worker_set_session_name),
	(on_set_session_name),
	(gdm_session_worker_set_language_name),
	(on_set_language_name),
	(worker_dbus_handle_message):
	Update session and language state in the worker, when
	the slave informs it about language/session changes the
	user makes from the greeter

2008-02-26  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-direct.c
	(do_introspect), (gdm_session_direct_select_session),
	(gdm_session_direct_select_language):
	Tell worker about language/session changes the user
	makes from the greeter

2008-02-26  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-worker.c: (_save_user_settings),
	(gdm_session_worker_start_user_session):
	Save out user settings to ~/.dmrc before starting the
	session

2008-02-26  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-settings.[ch]:
	Make language and session setters non-static
	functions so there's a way to change the settings.

2008-02-26  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-settings.[ch]:
	(gdm_session_settings_save):
	Add save support to GdmSessionSettings object, so
	~/.dmrc changes can be saved out.

2008-02-26  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-settings.c
	(gdm_session_settings_is_loaded):
	Track is_loaded status by whether either session or
	language are explicitly set instead of relying on a
	boolean that wasn't being kept in sync.

2008-02-26  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-panel.c:
	(is_a11y_button_disabled), (gdm_greeter_panel_init):
	* gui/simple-greeter/gdm-simple-greeter.schemas.in:
	Allow disabling the a11y button in the greeter
	using a gconf key.

2008-02-25  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-session-direct.c: (is_prog_in_path),
	(get_session_command_for_file), (get_session_command_for_name),
	(gdm_session_direct_handle_saved_session_name_read),
	(get_session_name):
	Verify that the dmrc session is available before using it.

2008-02-25  William Jon McCann  <jmccann@redhat.com>

	* configure.ac: Post release bump

==== 2.21.8 ====

2008-02-25  William Jon McCann  <jmccann@redhat.com>

	* NEWS: Update for release.

2008-02-25  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-panel.c:
	(gdm_greeter_panel_dispose), (set_struts), (update_geometry):
	Drop a few debug messages we don't need anymore.

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(GdmLocale),
	(chooser_locale_free),
	(collect_locales_from_{directory,archive}):
	store a separate "id" in the locale structure
	that is less specific than the name, so that
	e.g., en_US and en_US.utf8 are keyed the same
	in the lookup map.  When figuring out which
	locale to choose, pick the one with the longest
	name. Thinking about it more, it might be better
	to pick the one with the most components

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(get_translated_language), (get_translated_territory):
	fix up spacing

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(collect_locales_from_{archives,directory}):
	don't discard modifier and codeset

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(collect_locales_from_directory),
	(collect_locales_from_archives):
	filter out invalid and non-utf8 locales
	from language list

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(gdm_normalize_language_name):
	when normalizing language names, don't
	discard codeset and modifier

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(construct_language_name):
	when constructing language name, don't
	ignore codeset and modifier

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(language_name_is_valid),
	(language_name_is_utf8):
	new functions to check locale validity

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c
	(chooser_locale_free):
	plug a small leak

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(gdm_parse_language_name):
	normalize the codeset before returning
	it

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(gdm_parse_language_name):
	If regex match returns empty string for one
	of the components of a locale, just free it
	and return NULL

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(normalize_codeset): new function to
	fold the various legal forms for codeset
	into one consistent format

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(gdm_parse_language_name):
	update locale parsing regex to cover more
	valid locales

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.c:
	(get_first_item_in_semicolon_list),
	(get_translated_language),
	(get_translated_territory):
	Move some duplicated code for pulling
	language/territory names out into a common
	function

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-language-option-widget.c
	(gdm_language_option_widget_set_current_language_name):
	Normalize language name before adding to the list, so
	we don't end up with duplicate entries for the same
	locale

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-language-chooser-widget.c
	(gdm_language_chooser_widget_get_current_language_name):
	fallback to setlocale (LC_MESSAGES, NULL) instead of
	g_get_language_names()[0]

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-language-option-widget.c
	(gdm_language_option_widget_activated):
	Set language dialog language to whatever gets put
	in the option widget.
	(gdm_language_option_widget_init):
	Don't set option widget to language dialog language
	initially

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-language-chooser-dialog.[ch]:
	(gdm_language_chooser_set_current_language_name):
	New function to let the language option widget change
	which language to show in its chooser dialog

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-language-option-widget.c:
	(gdm_language_option_widget_init)
	* gui/simple-greeter/gdm-session-option-widget.c:
	(add_available_sessions):
	Get rid of the "Last Language" and "Last Session" options.
	We'll just fallback to the slave specified default items
	now.

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-panel.c:
	(gdm_greeter_panel_set_default_language_name):
	Call new gdm_option_widget_set_default_item instead of
	gdm_language_option_widget_set_current_language_name.
	Add language to list if it isn't there already.
	(gdm_greeter_panel_set_default_session_name):
	Use gdm_option_widget_set_default_item here too.

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-option-widget.[ch]:
	(activate_from_item_id): allow NULL input
	to deselect combo box
	(gdm_option_widget_get_default_item):
	(gdm_option_widget_set_default_item):
	(gdm_option_widget_set_property):
	(gdm_option_widget_get_property):
	Add new concept of a default item, to fall
	back to if the user hasn't picked on yet
	(on_changed): If no default item is set
	don't activate whatever invalid item is
	selected
	(gdm_option_widget_init):
	(on_default_item_changed): set combo box
	to insensitive if there is no default item
	(name_cell_data_func): show the default item
	in italics
	(gdm_option_widget_remove_item): don't let the
	default item get removed

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-client.[ch]:
	(on_default_language_name_changed),
	(on_default_session_name_changed),
	(client_dbus_handle_message),
	(gdm_greeter_client_class_init):
	* gui/simple-greeter/gdm-greeter-panel.[ch]:
	(gdm_greeter_panel_reset):
	(gdm_greeter_panel_set_default_language_name):
	(gdm_greeter_panel_set_default_session_name):
	* gui/simple-greeter/gdm-greeter-session.c
	(on_default_language_name_changed):
	(on_default_session_name_changed):
	Change greeter to use the new slave interface setup in
	the last commit

2008-02-25  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-private.h:
	* daemon/gdm-session.h:
	* daemon/gdm-session.c:
	(gdm_session_class_init),
	(_gdm_session_default_language_name_changed),
	(_gdm_session_default_session_name_changed),
	(_gdm_session_default_session_name_changed),
	* daemon/gdm-session-direct.c:
	(get_default_language_name),
	(get_default_session_name),
	(gdm_session_direct_defaults_changed),
	(gdm_session_direct_select_user),
	(gdm_session_direct_handle_username_changed),
	(gdm_session_direct_handle_saved_language),
	(gdm_session_direct_setup),
	(gdm_session_direct_setup_for_user),
	(get_language_name),
	(get_session_name):
	* daemon/gdm-simple-slave:
	(on_default_language_name_changed):
	(on_default_session_name_changed):
	(create_new_session):
	* daemon/gdm-greeter-server.[ch]:
	(gdm_greeter_server_default_language_name_changed),
	(gdm_greeter_server_default_session_name_changed),
	(do_introspect):
	Change "SavedLanguageNameRead"/"SavedSessionNameRead"
	to "DefaultLanguageNameChanged"/"DefaultSessionNameChanged"
	and call it with system fallbacks whenever a new user is
	authenticating before ~/.dmrc is read.

2008-02-23  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(get_show_restart_buttons), (switch_mode), (load_theme):
	* gui/simple-greeter/gdm-simple-greeter.schemas.in:
	Add a gconf key to control allow disabling the
	restart/shutdown/suspend buttons in the greeter.

2008-02-22  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-language-option-widget.c
	(gdm_language_option_widget_get_current_language_name):
	because of changes made to the greeter a couple of commits
	ago, we should no longer need to hardcode encoding.
	We s/g_get_language_names ()[0]/setlocale (LC_MESSAGES, NULL)/

2008-02-21  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-direct.c:
	remove stale TODO items from top of file

2008-02-21  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-display-store.c: (remove_display),
	(gdm_display_store_remove):
	* daemon/gdm-display.c: (gdm_display_add_user_authorization),
	(gdm_display_set_slave_bus_name),
	(gdm_display_remove_user_authorization), (finish_idle),
	(slave_exited), (slave_died), (_gdm_display_set_status),
	(gdm_display_real_manage), (gdm_display_manage),
	(gdm_display_real_finish), (gdm_display_finish),
	(gdm_display_real_unmanage), (gdm_display_set_property),
	(gdm_display_get_property), (gdm_display_dispose),
	(gdm_display_class_init), (gdm_display_init),
	(gdm_display_finalize):
	* daemon/gdm-display.h:
	* daemon/gdm-local-display-factory.c: (take_next_display_number),
	(on_display_disposed), (on_static_display_status_changed),
	(create_display):
	* daemon/gdm-manager.c: (remove_display_for_connection):
	* daemon/gdm-static-display.c: (gdm_static_display_finish):
	Add quick death and looping detection for displays.

2008-02-21  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-direct.c
	(gdm_session_direct_handle_saved_language)
	(gdm_session_direct_handle_saved_session):
	when the .dmrc gets read remember the results
	(get_session_name), (get_language_name):
	new functions to figure out which of
	1) value reported from greeter 2) value saved
	in .dmrc 3) some fallback is the value we
	should actually use when logging in
	(get_session_command), (setup_session_environment):
	use the new get_{session,language}_name functions
	(gdm_session_direct_select_session):
	if the greeter tells us to use the value that are in
	~/.dmrc then discard anything the greeter told us
	earlier and just default to fallback behavior.
	(gdm_session_direct_finalize): memleak fixes

2008-02-21  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(remove_timed_login_timeout), (restart_timed_login_timeout),
	(switch_mode), (on_user_chosen):
	Pause timed login until selected user verification
	times out or is cancelled.

2008-02-20  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-panel.c
	(gdm_greeter_panel_reset):
	Set language and session to defaults when
	reseting the user
	* gui/simple-greeter/gdm-language-option-widget.c
	(gdm_language_option_widget_init):
	(gdm_language_option_widget_set_current_language_name):
	* gui/simple-greeter/gdm-session-option-widget.c
	(gdm_session_option_widget_init):
	(gdm_session_option_widget_set_current_session_name):
	Create "Last Language" and "Last Session" items
	to go to when we don't know more specific values
	for language and session.  Make set_current_*_name (..., NULL)
	revert to these values.

2008-02-20  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-panel.[ch]:
	(gdm_greeter_panel_reset):
	new function that is an analog of
	gdm_greeter_login_window_reset.  Right now
	it just hides user options.

	* gui/simple-greeter/gdm-greeter-session.c:
	(on_reset): call gdm_greeter_panel_reset instead
	of gdm_greeter_paneL_hide_user_options

2008-02-20  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-settings.c
	(gdm_session_settings_load):
	Don't fail if optional fields are missing in ~/.dmrc

2008-02-20  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-session-direct.c: (gdm_session_direct_init),
	(get_session_command_for_file), (get_session_command):
	Add the .desktop extension when looking for session file.

2008-02-20  Brian Cameron  <brian.cameron@sun.com>

	* configure.ac: Remove Solaris devperm checking.

2008-02-20  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-factory-slave.c
	(run_greeter):
	* daemon/gdm-simple-slave.c
	(run_greeter):
	* daemon/gdm-xdmcp-chooser-slave.c:
	(run_chooser):
	Run /etc/gdm/Init/Default, not /etc/gdm/Init.
	We should probably run the per-display scripts,
	too.

2008-02-20  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-settings-keys.h:
	* common/test-settings-client.c: (test_settings_client):
	* daemon/gdm-manager.c: (gdm_manager_class_init):
	* daemon/main.c: (main):
	Set XDMCP enabled/disabled from configuration settings.

2008-02-20  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-settings-client.c (get_entry_for_key):
	Warn if we can't find the schema.

2008-02-20  William Jon McCann  <jmccann@redhat.com>

	* data/gdm.schemas.in.in:
	Make the changes here instead of .in.  Whoops.

2008-02-20  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-session.c:
	(on_segfault),
	(gdm_greeter_session_new):
	revert some debug code that snuck in the last
	commit

2008-02-20  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-local-display-factory.c:
	(gdm_local_display_factory_create_product_display):
	don't call create_authority here anymore either,
	since it's handled by gdm_display_manage now.

2008-02-20  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-local-display-factory.c
	(gdm_local_display_factory_create_transient_display):
	* daemon/gdm-xdmcp-display-factory.c:
	(gdm_xdmcp_display_create):
	don't call create_authority here anymore, since it's
	handled by gdm_display_manage now.

2008-02-20  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-settings-client.c: (gdm_settings_client_get_string):
	* common/gdm-settings-keys.h:
	* daemon/gdm-factory-slave.c: (on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user):
	* daemon/gdm-greeter-server.c: (handle_begin_timed_login),
	(greeter_handle_child_message), (do_introspect),
	(gdm_greeter_server_class_init):
	* daemon/gdm-greeter-server.h:
	* daemon/gdm-product-slave.c: (on_relay_setup),
	(on_relay_setup_for_user):
	* daemon/gdm-session-direct.c: (gdm_session_direct_init),
	(send_setup), (send_setup_for_user), (gdm_session_direct_setup),
	(gdm_session_direct_setup_for_user),
	(gdm_session_direct_set_property),
	(gdm_session_direct_get_property), (gdm_session_direct_dispose),
	(gdm_session_direct_class_init):
	* daemon/gdm-session-relay.c: (send_dbus_string_string_signal),
	(gdm_session_relay_setup), (gdm_session_relay_setup_for_user),
	(do_introspect):
	* daemon/gdm-session.c: (gdm_session_setup),
	(gdm_session_setup_for_user):
	* daemon/gdm-session.h:
	* daemon/gdm-simple-slave.c: (on_greeter_begin_verification),
	(on_greeter_begin_timed_login),
	(on_greeter_begin_verification_for_user), (run_greeter):
	* daemon/simple-slave-main.c: (main):
	* daemon/test-session.c: (on_open):
	* gui/simple-greeter/gdm-greeter-client.c:
	(emit_string_signal_for_message),
	(gdm_greeter_client_call_begin_timed_login):
	* gui/simple-greeter/gdm-greeter-client.h:
	* gui/simple-greeter/gdm-greeter-login-window.c:
	(remove_timed_login_timeout), (timed_login_timer),
	(restart_timed_login_timeout),
	(on_login_button_clicked_answer_query),
	(on_login_button_clicked_timed_login), (set_log_in_button_mode),
	(switch_mode), (do_cancel), (reset_dialog),
	(gdm_greeter_login_window_info_query),
	(gdm_greeter_login_window_secret_info_query), (on_user_chosen),
	(load_theme), (read_configuration),
	(gdm_greeter_login_window_constructor),
	(gdm_greeter_login_window_class_init),
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-login-window.h:
	* gui/simple-greeter/gdm-greeter-session.c: (on_begin_timed_login),
	(toggle_login_window):
	* gui/simple-greeter/gdm-user-chooser-dialog.c:
	(gdm_user_chooser_dialog_set_show_other_user),
	(gdm_user_chooser_dialog_set_show_guest_user),
	(gdm_user_chooser_dialog_set_show_auto_user),
	(gdm_user_chooser_dialog_init):
	* gui/simple-greeter/gdm-user-chooser-dialog.h:
	* gui/simple-greeter/gdm-user-chooser-widget.c: (add_user_other),
	(add_user_guest), (add_user_auto), (remove_user_other),
	(remove_user_guest), (remove_user_auto),
	(gdm_user_chooser_widget_set_show_other_user),
	(gdm_user_chooser_widget_set_show_guest_user),
	(gdm_user_chooser_widget_set_show_auto_user),
	(gdm_user_chooser_widget_constructor),
	(gdm_user_chooser_widget_init):
	* gui/simple-greeter/gdm-user-chooser-widget.h:
	* gui/simple-greeter/greeter-main.c: (main):
	* gui/simple-greeter/test-greeter-login-window.c: (main):
	* gui/simple-greeter/test-user-chooser.c: (main):
	Add initial support for timed login.

2008-02-20  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-local-display-factory.c (create_display)
	* daemon/gdm-display.c (gdm_display_real_manage):
	create authority file in gdm_display_manage instead of
	create_display so that it gets recreated when the display
	gets finished (and remanaged, not destroyed)

2008-02-20  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-user-manager.c (reload_users):
	Don't bother running ck-history if seat id isn't set.

2008-02-20  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-user-manager.c (reload_users):
	Handle ck-history spawn errors.

2008-02-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-a11y-preferences-dialog.glade:
	Fix up some typos and awkwardness.

2008-02-19  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-display.c (gdm_display_real_unmanage):
	correct typo that was preventing the access file from getting
	deleted and making it get reused.

2008-02-19  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-chooser/Makefile.am:
	* gui/simple-chooser/test-host-chooser.c:
	* gui/simple-greeter/gdm-remote-login-window.c: (start_xephyr),
	(start_xdmx), (gdm_remote_login_window_connect),
	(gdm_remote_login_window_init):
	* gui/simple-greeter/test-remote-login-window.c: (main):
	Install the test program as gdm-host-chooser.  Add a
	stub for Xdmx support.

2008-02-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-chooser/gdm-host-chooser-dialog.c (gdm_host_chooser_dialog_init):
	Fix dialog title, icon, and spacing.

2008-02-19  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-slave.c: (gdm_slave_add_user_authorization):
	Add more debug for user auth.

2008-02-19  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(get_show_restart_buttons), (do_suspend), (suspend_button_clicked),
	(get_action_from_error), (load_theme):
	Hook up Suspend button.  Probably won't work due to dbus
	security policy... need to fix that.

2008-02-19  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-settings-client.c:
	(gdm_settings_client_get_locale_string),
	(gdm_settings_client_init):
	* common/gdm-settings-desktop-backend.c: (save_settings):
	* common/gdm-settings-direct.c: (gdm_settings_direct_init):
	* common/test-log.c: (test_log):
	* common/test-settings-client.c: (test_settings_client):
	* daemon/gdm-chooser-server.c: (gdm_chooser_server_constructor):
	* daemon/gdm-chooser-session.c: (gdm_chooser_session_set_property),
	(gdm_chooser_session_get_property),
	(gdm_chooser_session_constructor):
	* daemon/gdm-display-access-file.c:
	* daemon/gdm-display.c: (_create_access_file_for_user),
	(gdm_display_constructor):
	* daemon/gdm-factory-slave.c: (gdm_factory_slave_start),
	(gdm_factory_slave_stop), (gdm_factory_slave_set_property),
	(gdm_factory_slave_get_property), (gdm_factory_slave_constructor):
	* daemon/gdm-greeter-server.c: (gdm_greeter_server_constructor):
	* daemon/gdm-greeter-session.c: (gdm_greeter_session_set_property),
	(gdm_greeter_session_get_property):
	* daemon/gdm-local-display-factory.c:
	(gdm_local_display_factory_set_property),
	(gdm_local_display_factory_get_property),
	(gdm_local_display_factory_constructor):
	* daemon/gdm-manager.c: (gdm_manager_constructor):
	* daemon/gdm-product-display.c: (gdm_product_display_constructor):
	* daemon/gdm-product-slave.c: (gdm_product_slave_start),
	(gdm_product_slave_stop), (gdm_product_slave_set_property),
	(gdm_product_slave_get_property), (gdm_product_slave_constructor):
	* daemon/gdm-server.c: (gdm_server_constructor):
	* daemon/gdm-session-auditor.c:
	* daemon/gdm-session-direct.c: (gdm_session_direct_open):
	* daemon/gdm-session-linux-auditor.c:
	* daemon/gdm-session-relay.c: (gdm_session_relay_set_property),
	(gdm_session_relay_get_property), (gdm_session_relay_constructor):
	* daemon/gdm-session-settings.c:
	* daemon/gdm-session-worker-job.c:
	(gdm_session_worker_job_constructor):
	* daemon/gdm-session-worker.c: (gdm_session_worker_constructor):
	* daemon/gdm-simple-slave.c: (gdm_simple_slave_start),
	(gdm_simple_slave_stop), (gdm_simple_slave_set_property),
	(gdm_simple_slave_get_property), (gdm_simple_slave_constructor):
	* daemon/gdm-slave.c: (gdm_slave_run_script),
	(_get_primary_user_session_id), (gdm_slave_constructor):
	* daemon/gdm-static-display.c: (gdm_static_display_set_property),
	(gdm_static_display_get_property):
	* daemon/gdm-static-factory-display.c:
	(gdm_static_factory_display_set_property),
	(gdm_static_factory_display_get_property),
	(gdm_static_factory_display_constructor):
	* daemon/gdm-transient-display.c:
	(gdm_transient_display_set_property),
	(gdm_transient_display_get_property):
	* daemon/gdm-welcome-session.c: (parse_dbus_launch_output),
	(gdm_welcome_session_constructor):
	* daemon/gdm-xdmcp-chooser-slave.c:
	(gdm_xdmcp_chooser_slave_start), (gdm_xdmcp_chooser_slave_stop),
	(gdm_xdmcp_chooser_slave_set_property),
	(gdm_xdmcp_chooser_slave_get_property),
	(gdm_xdmcp_chooser_slave_constructor):
	* daemon/gdm-xdmcp-display-factory.c: (do_bind),
	(indirect_client_create), (gdm_xdmcp_handle_forward_query):
	* daemon/test-session.c: (main):
	* gui/simple-chooser/gdm-chooser-client.c:
	(gdm_chooser_client_set_property),
	(gdm_chooser_client_get_property),
	(gdm_chooser_client_constructor), (gdm_chooser_client_dispose):
	* gui/simple-chooser/gdm-chooser-session.c:
	(gdm_chooser_session_set_property),
	(gdm_chooser_session_get_property),
	(gdm_chooser_session_constructor), (gdm_chooser_session_dispose):
	* gui/simple-chooser/gdm-host-chooser-dialog.c:
	(gdm_host_chooser_dialog_set_property),
	(gdm_host_chooser_dialog_get_property),
	(gdm_host_chooser_dialog_constructor),
	(gdm_host_chooser_dialog_dispose):
	* gui/simple-chooser/gdm-host-chooser-widget.c:
	(gdm_host_chooser_widget_set_property),
	(gdm_host_chooser_widget_get_property),
	(gdm_host_chooser_widget_constructor):
	* gui/simple-greeter/gdm-a11y-preferences-dialog.c:
	(gdm_a11y_preferences_dialog_set_property),
	(gdm_a11y_preferences_dialog_get_property),
	(gdm_a11y_preferences_dialog_constructor),
	(gdm_a11y_preferences_dialog_dispose):
	* gui/simple-greeter/gdm-chooser-widget.c:
	(shrink_edge_toward_active_row), (gdm_chooser_widget_constructor):
	* gui/simple-greeter/gdm-greeter-client.c:
	(gdm_greeter_client_set_property),
	(gdm_greeter_client_get_property),
	(gdm_greeter_client_constructor), (gdm_greeter_client_dispose):
	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_constructor):
	* gui/simple-greeter/gdm-greeter-panel.c:
	(gdm_greeter_panel_set_property), (gdm_greeter_panel_get_property),
	(gdm_greeter_panel_constructor), (gdm_greeter_panel_dispose):
	* gui/simple-greeter/gdm-greeter-session.c:
	(gdm_greeter_session_set_property),
	(gdm_greeter_session_get_property),
	(gdm_greeter_session_constructor), (gdm_greeter_session_dispose):
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(gdm_language_chooser_widget_dispose):
	* gui/simple-greeter/gdm-option-widget.c: (activate_from_item_id),
	(gdm_option_widget_constructor):
	* gui/simple-greeter/gdm-recent-option-widget.c:
	(gdm_recent_option_widget_dispose):
	* gui/simple-greeter/gdm-remote-login-window.c:
	(gdm_remote_login_window_set_property),
	(gdm_remote_login_window_get_property),
	(gdm_remote_login_window_constructor):
	* gui/simple-greeter/gdm-session-client.c:
	(gdm_session_client_constructor), (gdm_session_client_dispose):
	* gui/simple-greeter/gdm-session-manager.c:
	(gdm_session_manager_set_property),
	(gdm_session_manager_get_property),
	(gdm_session_manager_constructor), (gdm_session_manager_dispose):
	* gui/simple-greeter/gdm-user-chooser-dialog.c:
	(gdm_user_chooser_dialog_set_property),
	(gdm_user_chooser_dialog_get_property),
	(gdm_user_chooser_dialog_constructor),
	(gdm_user_chooser_dialog_dispose):
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_set_property),
	(gdm_user_chooser_widget_get_property),
	(gdm_user_chooser_widget_constructor):
	* gui/simple-greeter/gdm-user-manager.c:
	(_get_primary_user_session_id), (_get_login_window_session_id):
	* gui/simple-greeter/gdm-user.c:
	* gui/simple-greeter/libnotificationarea/na-tray-manager.c:
	(na_tray_manager_handle_begin_message):
	* gui/simple-greeter/libnotificationarea/na-tray.c:
	* gui/user-switch-applet/applet.c: (prefs_cb),
	(switch_to_user_session), (display_key_changed), (applet_fill_cb):
	* gui/user-switch-applet/gdm-user-menu-item.c:
	* tests/s-common-address.c: (START_TEST):
	* utils/gdmflexiserver.c: (get_login_window_session_id):
	Fix a bunch of compiler warnings and remove unused code.
	Patch from: Kjartan Maraas <kmaraas@broadpark.no>

2008-02-18  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-address.c:
	* gui/simple-greeter/gdm-greeter-login-window.c: (load_theme):
	* gui/simple-greeter/gdm-simple-greeter.schemas.in:
	Allow the login window icon to be changed via gconf.

2008-02-18  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-client.[ch]:
	(on_saved_language_name_read),
	(on_saved_session_name_read),
	(client_dbus_handle_message):
	(gdm_greeter_client_class_init):
	inform greeter session about language and
	session name changes in slave
	* gui/simple-greeter/gdm-greeter-panel.[ch]:
	(gdm_greeter_panel_set_language_name_hint),
	(gdm_greeter_panel_set_session_name_hint):
	* gui/simple-greeter/gdm-greeter-session.c:
	(on_saved_language_name_read),
	(on_saved_session_name_read):
	(gdm_greeter_session_init):
	Set greeter language and session based on ~/.dmrc.
	We'll probably need some policy here so we don't
	override the user's explicit choice in the event
	~/.dmrc doesn't get read right away.

2008-02-18  William Jon McCann  <jmccann@redhat.com>

	* common/gdm-common.c: (gdm_is_version_unstable),
	(gdm_set_fatal_warnings_if_unstable):
	* common/gdm-common.h:
	Add a function to see if release is unstable.
	* gui/simple-greeter/gdm-session-client.c:
	(gdm_session_client_start):
	Don't redirect client output to /dev/null in unstable
	releases.

2008-02-18  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-direct.c
	(gdm_session_direct_handle_saved_language_name_read),
	(gdm_session_direct_handle_saved_session_name_read):
	remove unused variables

2008-02-18  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-option-widget.c
	(gdm_option_widget_init): drop superfluous
	G_TYPE_BOOLEAN from gtk_list_store_new call.

2008-02-18  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-session-client.c: (client_child_watch),
	(gdm_session_client_start), (wait_on_child), (client_died),
	(gdm_session_client_stop), (gdm_session_client_class_init):
	* gui/simple-greeter/gdm-session-client.h:
	Watch session client processes.

2008-02-18  Ray Strode  <rstrode@redhat.com>

	Read ~/.dmrc when available, and bubble the
	results up to the greeter

	* daemon/Makefile.am: add gdm-session-settings.[ch] to 
	worker sources
	* daemon/gdm-session-private.h:
	* daemon/gdm-session.[ch]:
	(_gdm_session_saved_language_name_read),
	(_gdm_session_saved_session_name_read),
	(gdm_session_class_init):
	Add two new signals: "saved-language-name-read"
	and "saved-session-name-read"
	* daemon/gdm-session-worker.c (GdmSessionWorkerPrivate):
	session settings object to hold ~/.dmrc info.
	(attempt_to_load_user_settings_as_root): new function
	to switch from root to user, load settings, and switch
	back
	(do_setup), (gdm_session_worker_update_username):
	Create session settings object, and try to load ~/.dmrc
	in to object at various points in the pam conversation.
	(on_saved_language_name_read), (on_saved_session_name_read):
	report session settings changes from worker to slave
	* daemon/gdm-greeter-server.[ch]:
	(gdm_greeter_server_saved_language_name_read),
	(gdm_greeter_server_saved_session_name_read),
	(do_introspect): send language and session name to greeter

2008-02-18  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-language-option-widget.c:
	(gdm_language_option_widget_new):
	* gui/simple-greeter/gdm-option-widget.c:
	(gdm_option_widget_get_icon_name),
	(gdm_option_widget_set_icon_name),
	(gdm_option_widget_set_property), (gdm_option_widget_get_property),
	(gdm_option_widget_class_init), (gdm_option_widget_init),
	(gdm_option_widget_finalize):
	* gui/simple-greeter/gdm-session-option-widget.c:
	(gdm_session_option_widget_new):
	Add icons for language and session choosers.

2008-02-18  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-language-chooser-dialog.c:
	(gdm_language_chooser_dialog_init):
	Give the language dialog an icon and fix the
	border width to line up the buttons and chooser.

2008-02-18  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-session-client.c:
	(load_from_desktop_file):
	* gui/simple-greeter/gdm-session-manager.c: (_change_level):
	Now that we honor the enabled property make sure that
	we set it correctly for clients loaded from .desktop files.

2008-02-18  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-panel.c: (gdm_greeter_panel_init):
	Make the a11y button sit in the corner of the screen to
	make it easier to find and click.

2008-02-18  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-a11y-preferences-dialog.c:
	(gdm_a11y_preferences_dialog_init):
	Fix the last commit better.

2008-02-18  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-a11y-preferences-dialog.c:
	(gdm_a11y_preferences_dialog_init):
	Make a11y dialog automatically shrink/grow when
	font size changes.

2008-02-15  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-settings.c
	(gdm_session_settings_class_init):
	Don't mark property strings for translation,
	it breaks string freeze

2008-02-15  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-settings.[ch]:
	New class for reading settings from ~/.dmrc

2008-02-15  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm/simple-greeter/gdm-sessions.c
	(collect_sessions_from_directory),
	(load_session_file): strip .desktop extension
	from desktop ids (to match what's in ~/.dmrc).

2008-02-15  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-auditor.c
	(gdm_session_auditor_set_property):
	Don't leak property values

2008-02-14  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-a11y-preferences-dialog.c:
	(gdm_a11y_preferences_dialog_init):
	Make a11y dialog resizable.

2008-02-14  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-option-widget.[ch]:
	* gui/simple-greeter/gdm-recent-option-widget.c:
	(gdm_recent_option_widget_sync_items_from_gconf):
	* gui/simple-greeter/gdm-language-option-widget.[ch]:
	(gdm_recent_option_widget_init):
	* gui/simple-greeter/gdm-session-option-widget.[ch]:
	(add_available_sessions):
	Update to allow a top separator and a bottom
	separator (So we can add "Last Language" above the list
	of languages)

2008-02-14  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-session.c (setup_at_tools):
	Run gok in login window mode instead of normal mode

2008-02-13  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c: (do_disconnect),
	(disconnect_button_clicked), (load_theme):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Use disconnect stock button.  Hook up to quit.

2008-02-12  William Jon McCann  <mccann@jhu.edu>

	* configure.ac: Bump version

==== 2.21.7 ====

2008-02-12  William Jon McCann  <mccann@jhu.edu>

	* NEWS: Update for release.

2008-02-12  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-session-direct.c:
	(_gdm_session_direct_set_service_name),
	(gdm_session_direct_set_property),
	(gdm_session_direct_get_property), (gdm_session_direct_class_init):
	Make service name a property.

2008-02-12  William Jon McCann  <mccann@jhu.edu>

	* gui/user-switch-applet/GNOME_GdmUserSwitchApplet.server.in.in:
	Fix bugzilla component and applet name.

2008-02-11  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-user.c: (render_icon_from_home):
	Patch from: Wouter Bolsterlee <wbolster@gnome.org>
	Fixes #515740

2008-02-11  William Jon McCann  <jmccann@redhat.com>

	* configure.ac: Don't use -Werror.

2008-02-08  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-worker.c
	(gdm_session_worker_update_username):
	report to auditor username even if it doesn't
	change over the course of the pam conversation

2008-02-08  Brian Cameron  <brian.cameron@sun.com>

	* gui/simple-greeter/gdm-option-widget.c:  Fix NULL print
	  issue causing crash on Solaris.
	* gui/gdm-languages.c:  Fix NULL print issue causing crash
	  on Solaris.

2008-02-08  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-session.c
	(gdm_greeter_session_event_handler):
	If a mnemonic is successfully applied to a window
	then focus that window (since often activating
	a mnemonic implies setting the focus widget for
	the window to the activated widget)

2008-02-08  William Jon McCann  <jmccann@redhat.com>

	* configure.ac:
	Give an error if we can't find pam.

2008-02-08  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-a11y-preferences-dialog.c:
	(get_large_font), (config_get_large_print),
	(config_set_large_print):
	Use pango to parse fonts.  Increase font size by
	PANGO_SCALE_XX_LARGE instead of using a fixed size.

2008-02-08  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-a11y-preferences-dialog.c: (setup_dialog),
	(gdm_a11y_preferences_dialog_finalize):
	Disconnect gconf notify callbacks.

2008-02-08  William Jon McCann  <jmccann@redhat.com>

	* data/Makefile.am:
	* data/gconf.path:
	Unset existing values in the mandatory gconf source
	so that we'll be able to change values as needed.

2008-02-08  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-greeter-panel.c:
	(on_a11y_dialog_response):
	Destroy and disconnect signals instead of hiding.
	Makes it handle font resizing better and not crash when
	we forgot to handle delete event etc.

2008-02-08  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-session.c
	(gdm_greeter_session_init), (gdm_greeter_session_event_handler):
	Listen for key presses and try to apply them as mnemonics on
	all toplevels, not just the focused toplevel (so for instance,
	pressing Alt-L should focus the language option widget in the
	panel when the user is doing the pam conversation in the login
	window)

2008-02-08  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c
	(gdm_greeter_login_window_init): set title to
	"Login Window"

	* gui/simple-greeter/gdm-greeter-panel.c
	(gdm_greeter_panel_init): set title to "Panel"

2008-02-07  Ray Strode  <rstrode@redhat.com>

	* data/session-setup.entries: don't disable the
	key combinations to focus panels

2008-02-07  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-a11y-preferences-dialog.c:
	(config_get_large_print), (config_set_large_print),
	(on_large_print_checkbutton_toggled), (ui_set_large_print),
	(setup_dialog):
	* gui/simple-greeter/gdm-a11y-preferences-dialog.glade:
	Add Large Print a11y option.

2008-02-07  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-panel.c
	(gdm_greeter_panel_init):
	set CAN_FOCUS flag on widget

2008-02-07  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-panel.c
	(gdm_greeter_panel_init):
	don't set skip taskbar/pager hint, so metacity
	puts it in the ctrl-alt-tab menu

2008-02-07  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-a11y-preferences-dialog.c:
	(key_changed_cb):
	* gui/simple-greeter/gdm-greeter-panel.c:
	(on_a11y_dialog_response):
	* gui/simple-greeter/gdm-greeter-session.c: (toggle_screen_reader),
	(toggle_screen_magnifier), (toggle_screen_keyboard),
	(on_a11y_key_changed), (setup_at_tools),
	(gdm_greeter_session_init):
	* gui/simple-greeter/gdm-session-client.c:
	(gdm_session_client_get_enabled), (gdm_session_client_set_enabled),
	(gdm_session_client_get_name), (gdm_session_client_set_name),
	(gdm_session_client_get_command), (gdm_session_client_set_command),
	(gdm_session_client_get_try_exec),
	(gdm_session_client_set_try_exec),
	(gdm_session_client_get_priority),
	(gdm_session_client_set_priority),
	(gdm_session_client_set_property),
	(gdm_session_client_get_property), (gdm_session_client_class_init):
	* gui/simple-greeter/gdm-session-client.h:
	* gui/simple-greeter/gdm-session-manager.c:
	(is_client_in_current_level), (on_client_enable_notify),
	(gdm_session_manager_add_client), (_change_level):
	* gui/simple-greeter/gdm-simple-greeter.schemas.in:
	Start/stop orca etc in the greeter session.

2008-02-07  Ray Strode  <rstrode@redhat.com>

	Make sure the user never sees the string "Prompt: "

	* gui/simple-greeter/gdm-greeter-login-window.c
	(switch_mode):
	(gdm_greeter_login_window_{secret,}info_query):
	Don't show auth input hbox as soon as going into
	authentication mode
	explicitly show the auth input hbox when pam
	asks for input.
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	drop the string "Prompt:" entirely

2008-02-07  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-linux-auditor.c
	(gdm_session_linux_auditor_report_login_attempt):
	strdup "unknown" string so a literal doesn't get
	freed later

2008-02-07  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-a11y-preferences-dialog.c:
	(gdm_a11y_preferences_dialog_set_property),
	(gdm_a11y_preferences_dialog_get_property),
	(gdm_a11y_preferences_dialog_constructor),
	(gdm_a11y_preferences_dialog_dispose),
	(gdm_a11y_preferences_dialog_class_init), (on_response),
	(config_get_string), (config_get_bool), (config_get_high_contrast),
	(config_set_high_contrast), (config_get_sticky_keys),
	(config_set_sticky_keys), (config_get_bounce_keys),
	(config_set_bounce_keys), (config_get_slow_keys),
	(config_set_slow_keys), (config_get_screen_keyboard),
	(config_set_screen_keyboard), (config_get_screen_reader),
	(config_set_screen_reader), (config_get_screen_magnifier),
	(config_set_screen_magnifier),
	(on_sticky_keys_checkbutton_toggled),
	(on_bounce_keys_checkbutton_toggled),
	(on_slow_keys_checkbutton_toggled),
	(on_high_contrast_checkbutton_toggled),
	(on_screen_keyboard_checkbutton_toggled),
	(on_screen_reader_checkbutton_toggled),
	(on_screen_magnifier_checkbutton_toggled), (ui_set_sticky_keys),
	(ui_set_bounce_keys), (ui_set_slow_keys), (ui_set_high_contrast),
	(ui_set_screen_keyboard), (ui_set_screen_reader),
	(ui_set_screen_magnifier), (key_changed_cb), (setup_dialog),
	(gdm_a11y_preferences_dialog_init),
	(gdm_a11y_preferences_dialog_finalize),
	(gdm_a11y_preferences_dialog_new):
	* gui/simple-greeter/gdm-a11y-preferences-dialog.glade:
	* gui/simple-greeter/gdm-a11y-preferences-dialog.h:
	* gui/simple-greeter/gdm-greeter-panel.c:
	(on_a11y_dialog_response), (on_a11y_button_clicked),
	(gdm_greeter_panel_init):
	* gui/simple-greeter/test-a11y-preferences.c: (main):
	Add initial cut at a11y dialog.  Orca etc don't start yet.

2008-02-07  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.[ch]:
	* gui/simple-greeter/gdm-greeter-session.c:
	drop some signals that aren't used anymore

2008-02-07  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-session-chooser-widget.[ch]:
	* gui/simple-greeter/gdm-session-chooser-dialog.[ch]:
	* gui/simple-greeter/test-session-chooser.c:
	* gui/simple-greeter/Makefile.am:
	Axe some now unused code

2008-02-07  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c
	(struct GdmGreeterLoginWindowPrivate), (update_clock),
	(set_clock_timeout), (update_clock_timeout_cb),
	(remove_clock_timeout), (get_time_format):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Remove clock from login dialog since its on panel now

2008-02-07  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-session.c
	(on_reset), (on_select_user), (on_cancelled):
	show language and session selection when a
	user is authenticating.  Hide them when we're
	waiting for a user to get picked.

2008-02-07  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-panel.[ch]
	(gdm_greeter_panel_show_user_options),
	(gdm_greeter_panel_hide_user_options):
	new apis to show and hide language and
	session selection depending on if a user
	is currently active
	(gdm_greeter_panel_init): don't show language
	and session selection by default

2008-02-07  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c
	(on_user_chosen): emit "user-selected" signal
	when a user is selected

2008-02-07  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-session.c (on_query_answer):
	Make sure handler arguments are swapped since that's
	what we asked for.

2008-02-07  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-clock-widget.[ch]:
	* gui/simple-greeter/gdm-greeter-panel.c:
	Refactor the clock code from the login window
	to its own widget, and add clock widget to panel.

2008-02-07  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(add_special_users):
	Don't show guest until it does something.

2008-02-06  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-sessions.c:
	include gdm-sessions.h instead of gdm-langauges.h

2008-02-06  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-factory-slave.c: (on_server_ready),
	(on_server_exited), (on_server_died), (gdm_factory_slave_run):
	* daemon/gdm-product-slave.c: (on_server_ready),
	(on_server_exited), (on_server_died),
	(gdm_product_slave_create_server):
	* daemon/gdm-server.c: (server_child_watch),
	(gdm_server_class_init):
	* daemon/gdm-server.h:
	* daemon/gdm-simple-slave.c: (on_server_ready), (on_server_exited),
	(on_server_died), (gdm_simple_slave_run):
	* daemon/gdm-slave.c: (gdm_slave_connect_to_x11_display):
	Make sure we catch the xserver exiting.

2008-02-06  Ray Strode  <rstrode@redhat.com>

	Drop session chooser from login window, since its on the panel
	now.

	* gui/simple-greeter/gdm-greeter-login-window.c
	(struct GdmGreeterLoginWindowPrivate): get rid of session_chooser
	field.
	(switch_mode): don't show/hide session-chooser widget anymore
	(do_cancel): don't call set_current_session_name anymore
	(on_session_activated): kill
	(custom_widget_constructor): drop special casing session-chooser
	in glade file.
	(load_theme): don't try to load session-chooser from glade file
	* gui/simple-greeter/gdm-greeter-login-window.glade: drop
	session-chooser from glade file

2008-02-06  Ray Strode  <rstrode@redhat.com>

	Sessions api added 4 commits back dealed in terms of filenames,
	while the daemon works in terms of desktop ids.  Change everything
	to be in terms of desktop ids

	* gui/simple-greeter/gdm-sessions.c (struct _GdmSessionFile):
	rename filename to id.
	(load_session_file): set ->id to desktop id.  store id in
	hash table.
	(gdm_get_all_sessions): add ids insteads of filenames to
	returned list of sessions
	(gdm_get_details_for_session): change argument name from
	filename to id.
	* gui/simple-greeter/gdm-sessions.h: change argument name
	from filename to id.
	* gui/simple-greeter/gdm-session-option-widget.c
	(add_available_sessions): s/files/ids/

2008-02-06  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-session.c (toggle_panel):
	connect to 'session-selected' signal of panel and inform
	daemon about new session selection when it gets made

2008-02-06  Ray Strode  <rstrode@redhat.com>

	Add the session option widget to the panel

	* gui/simple-greeter/gdm-greeter-panel.c (GdmGreeterPanelPrivate):
	Add session_option_widget to struct.
	(gdm_greeter_panel_class_init): add session-selected signal
	(on_session_activated): new function to handle session-activated
	signal from the option widget.  It emits session-selected on the
	panel.
	(gdm_greeter_panel_init): create the option widget and connect
	session-activated to on_session_activated

	* gui/simple-greeter/gdm-greeter-panel.h: add session_selected
	member to class struct

	* gui/simple-greeter/Makefile.am: add session option widget to
	makefile

2008-02-06  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-session-option-widget.[ch]:
	Add the start of a session option widget for the panel

2008-02-06  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-sessions.[ch]:
	Copy session handling code from gdm-session-chooser-widget
	to its own file (sort of like gdm-languages.c but for sessions)
	This will make it easier to add a session option widget to the
	panel.

2008-02-06  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-linux-auditor.c
	(gdm_session_linux_auditor_report_login_attempt):
	Apply patch from Eamon Walsh <ewalsh@tycho.nsa.gov>
	to remove superfluos getpwnam() call.

2008-02-06  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-factory-slave.c: (idle_connect_to_display):
	* daemon/gdm-product-slave.c: (idle_connect_to_display):
	* daemon/gdm-simple-slave.c: (idle_connect_to_display):
	* daemon/gdm-slave.c: (gdm_slave_run_script):
	* daemon/gdm-xdmcp-chooser-slave.c: (idle_connect_to_display):
	* daemon/simple-slave-main.c: (main):
	Make sure we retry connecting to the xserver.  This also ensures
	that we reach the exit if we fail the max number of times.

2008-02-05  Ray Strode  <rstrode@redhat.com>

	Add PAM auditing logic.  Based on patch and feedback from
	Brian Cameron and earlier code from Gary Winiger and
	Steve Grubb.

	* configure.ac: set HAVE_ADT and HAVE_LIBAUDIT as appropriate
	for solaris and linux audit support, respectively.
	* daemon/Makefile.am: add new auditing code to Makefile.
	* daemon/gdm-session-auditor.[ch]: generic base class for doing
	auditing.
	* daemon/gdm-session-linux-auditor.[ch]: linux auditor subclass
	* daemon/gdm-session-solaris-auditor.[ch]: solaris auditor 
	subclass
	* daemon/gdm-session-worker.c (GdmSessionWorkerPrivate): track
	auditor
	(gdm_session_worker_update_username): inform audit code about
	username changes
	(gdm_session_worker_start_auditor): instantiate the auditor
	(gdm_session_worker_stop_auditor): free the auditor
	(gdm_session_worker_uninitialize_pam): inform audit code about
	logout/login failure and then free the auditor
	(_get_tty_for_pam): fix calling return more than once on solaris
	(gdm_session_worker_initialize_pam): instantiate the auditor.
	(gdm_session_worker_authorize_user): inform audit code about
	password changes
	(gdm_session_worker_accredit_user): inform audit code about
	user getting credentials
	(gdm_session_worker_open_user_session): inform audit code about
	successful login

2008-02-05  William Jon McCann  <jmccann@redhat.com>

	* data/session-setup.entries:
	* gui/simple-greeter/gdm-simple-greeter.schemas.in:
	Enable the g-s-d a11y-keyboard plugin.  Set the
	/desktop/gnome/accessibility/keyboard/enable to TRUE
	for the login window session.

2008-02-05  William Jon McCann  <jmccann@redhat.com>

	* utils/gdmflexiserver.c: (create_transient_display),
	(get_current_session_id), (get_seat_id_for_session),
	(get_current_seat_id), (activate_session_id),
	(session_is_login_window), (seat_can_activate_sessions),
	(get_path_array_from_iter), (seat_get_sessions),
	(get_login_window_session_id), (goto_login_session), (main):
	Add support for finding and switching to existing greeters.

2008-02-05  William Jon McCann  <jmccann@redhat.com>

	* gui/user-switch-applet/gdm-user-switch-applet.schemas.in:
	Display name by default in user switcher.

2008-02-05  Brian Cameron  <brian.cameron@sun.com>

	* configure.ac:  Add gio to COMMON_LIBS, needed to link on
	  Solaris.
	* gui/simple-greeter/Makefile.am,
	  gui/user-switch-applet/Makefile.am:  Reference COMMON_LIBS
	  so programs link.

2008-02-05  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-user-manager.c: (seat_session_added):
	Oops.  Remove extra call to add user.

2008-02-05  William Jon McCann  <jmccann@redhat.com>

	* gui/user-switch-applet/Makefile.in:
	Remove accidentally committed file.

2008-02-05  William Jon McCann  <jmccann@redhat.com>

	* daemon/gdm-slave.c: (session_unlock),
	(gdm_slave_switch_to_user_session):
	Unlock session after switching.

2008-02-04  William Jon McCann  <jmccann@redhat.com>

	* configure.ac:
	* daemon/gdm-slave.c: (_get_primary_user_session_id):
	* gui/Makefile.am:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-user-manager.c: (start_new_login_session),
	(_get_primary_user_session_id), (activate_session_id),
	(session_is_login_window), (_get_login_window_session_id),
	(gdm_user_manager_goto_login_session),
	(gdm_user_manager_activate_user_session),
	(maybe_add_session_for_user), (seat_session_added),
	(gdm_user_manager_get_user_by_uid):
	* gui/simple-greeter/gdm-user-manager.h:
	* gui/simple-greeter/gdm-user.c: (_gdm_user_add_session),
	(_gdm_user_remove_session), (gdm_user_get_num_sessions),
	(gdm_user_get_sessions):
	* gui/simple-greeter/gdm-user.h:
	* gui/user-switch-applet/GNOME_GdmUserSwitchApplet.server.in.in:
	* gui/user-switch-applet/GNOME_GdmUserSwitchApplet.xml:
	* gui/user-switch-applet/Makefile.am:
	* gui/user-switch-applet/Makefile.in:
	* gui/user-switch-applet/applet.c: (about_me_cb), (get_glade_xml),
	(make_label_bold), (make_label_small_italic),
	(prefs_radio_toggled_cb), (prefs_xnest_check_toggled_cb),
	(prefs_lock_check_toggled_cb), (reset_login_screen_item),
	(system_can_do_xnest), (reset_login_window_item),
	(menubar_button_press_event_cb), (prefs_cb), (help_cb), (about_cb),
	(admin_cb), (setup_cb), (set_menuitem_icon), (applet_style_set_cb),
	(applet_change_background_cb), (applet_key_press_event_cb),
	(applet_size_allocate_cb), (gdm_applet_data_free),
	(menubar_expose_event_cb), (sort_menu_comparedatafunc),
	(sort_menu), (menu_style_set_cb), (menuitem_destroy_cb),
	(menuitem_style_set_cb), (user_notify_display_name_cb),
	(menu_expose_cb), (switch_to_user_session), (maybe_lock_screen),
	(do_switch), (user_item_activate_cb), (user_sessions_changed_cb),
	(manager_user_added_cb), (login_screen_activate_cb),
	(login_window_activate_cb), (display_key_changed),
	(xnest_key_changed), (client_notify_applet_func),
	(client_notify_global_func), (client_notify_lockdown_func),
	(applet_fill_cb):
	* gui/user-switch-applet/gdm-user-menu-item.c: (user_weak_notify),
	(reset_label), (reset_icon), (user_notify_cb),
	(user_icon_changed_cb), (user_sessions_changed_cb),
	(_gdm_user_menu_item_set_user), (gdm_user_menu_item_set_property),
	(gdm_user_menu_item_get_property), (gdm_user_menu_item_finalize),
	(gdm_user_menu_item_expose_event),
	(gdm_user_menu_item_size_request), (gdm_user_menu_item_class_init),
	(image_style_set_cb), (label_style_set_cb),
	(gdm_user_menu_item_init), (gdm_user_menu_item_new),
	(gdm_user_menu_item_get_user), (gdm_user_menu_item_get_icon_size),
	(gdm_user_menu_item_set_icon_size):
	* gui/user-switch-applet/gdm-user-menu-item.h:
	* gui/user-switch-applet/gdm-user-switch-applet.glade:
	* gui/user-switch-applet/gdm-user-switch-applet.schemas.in:
	Add a user switcher applet.  This is here at the moment instead
	of in fusa so that we can share code and stay in sync.  This
	is important since it is very likely we'll need to change interfaces
	slightly.

2008-02-04  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-user-chooser-widget.c: (update_icons):
	Forgot to add a priority argument to the load_icons foreach func.

2008-02-04  William Jon McCann  <jmccann@redhat.com>

	* configure.ac:
	* gui/simple-greeter/gdm-user.c: (gdm_user_init),
	(render_icon_from_home):
	* gui/simple-greeter/test-user-chooser.c: (main):
	* gui/simple-greeter/test-user-manager.c: (main):
	Migrate to GIO.
	Patch from Cosimo Cecchi <anarki@lilik.it>
	Fixes #513645

2008-02-04  William Jon McCann  <jmccann@redhat.com>

	* gui/simple-greeter/gdm-chooser-widget.c: (foreach_item),
	(compare_item), (gdm_chooser_widget_init),
	(gdm_chooser_widget_update_item), (gdm_chooser_widget_add_item),
	(gdm_chooser_widget_lookup_item),
	(gdm_chooser_widget_set_item_priority):
	* gui/simple-greeter/gdm-chooser-widget.h:
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(gdm_language_chooser_widget_add_language):
	* gui/simple-greeter/gdm-session-chooser-widget.c: (add_session),
	(add_available_sessions):
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(add_special_users), (on_user_added),
	(on_user_login_frequency_changed), (gdm_user_chooser_widget_init):
	* gui/simple-greeter/gdm-user-manager.c: (parse_value_as_ulong),
	(parse_ck_history_line), (process_ck_history_line),
	(ck_history_watch), (reload_users), (reload_users_timeout),
	(queue_reload_users), (gdm_user_manager_class_init),
	(gdm_user_manager_init), (gdm_user_manager_finalize):
	* gui/simple-greeter/gdm-user-manager.h:
	* gui/simple-greeter/gdm-user.c: (_gdm_user_set_login_frequency),
	(gdm_user_set_property), (gdm_user_get_property),
	(gdm_user_class_init), (gdm_user_init),
	(gdm_user_get_login_frequency):
	* gui/simple-greeter/gdm-user.h:
	Only show users that have frequently logged in.

2008-02-01  Brian Cameron  <brian.cameron@sun.com>

	* configure.ac, common/gdm-address.c use HAVE_SYS_SOCKIO_H
	  for sys/sockio.h inclusion.

2008-02-01  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-session.c: (gdm_greeter_session_new):
	Set flag to register greeter session with CK.

2008-02-01  Brian Cameron  <brian.cameron@sun.com>

	* configure.ac:  Make check an optional dependency.
	* common/gdm-address.c: Add needed includes to build on 
	  Solaris.

2008-02-01  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (on_greeter_session_start),
	(on_greeter_session_stop), (on_greeter_session_exited),
	(on_greeter_session_died), (run_greeter):
	* daemon/gdm-simple-slave.c: (on_greeter_session_start),
	(on_greeter_session_stop), (on_greeter_session_exited),
	(on_greeter_session_died), (run_greeter):
	* daemon/gdm-welcome-session.c: (stop_dbus_daemon),
	(welcome_session_child_watch), (start_dbus_daemon):
	Make sure slaves respond to exit of welcome session.

2008-02-01  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/gdm-chooser-session.c: (gdm_chooser_session_set_property),
	(gdm_chooser_session_get_property),
	(gdm_chooser_session_class_init), (gdm_chooser_session_init),
	(gdm_chooser_session_finalize), (gdm_chooser_session_new):
	* daemon/gdm-chooser-session.h:
	* daemon/gdm-factory-slave.c: (run_greeter),
	(gdm_factory_slave_stop):
	* daemon/gdm-greeter-session.c: (gdm_greeter_session_set_property),
	(gdm_greeter_session_get_property),
	(gdm_greeter_session_class_init), (gdm_greeter_session_init),
	(gdm_greeter_session_finalize), (gdm_greeter_session_new):
	* daemon/gdm-greeter-session.h:
	* daemon/gdm-simple-slave.c: (start_session_timeout),
	(run_greeter), (gdm_simple_slave_stop):
	* daemon/gdm-welcome-session.c: (listify_hash),
	(open_welcome_session), (close_welcome_session),
	(get_welcome_environment), (welcome_session_child_watch),
	(spawn_child_setup), (spawn_command_line_sync_as_user),
	(spawn_command_line_async_as_user), (parse_value_as_integer),
	(parse_dbus_launch_output), (start_dbus_daemon),
	(stop_dbus_daemon), (gdm_welcome_session_spawn),
	(gdm_welcome_session_start), (wait_on_child),
	(welcome_session_died), (gdm_welcome_session_stop),
	(gdm_welcome_session_set_server_address),
	(_gdm_welcome_session_set_x11_display_name),
	(_gdm_welcome_session_set_x11_display_hostname),
	(_gdm_welcome_session_set_x11_display_device),
	(_gdm_welcome_session_set_x11_display_is_local),
	(_gdm_welcome_session_set_x11_authority_file),
	(_gdm_welcome_session_set_user_name),
	(_gdm_welcome_session_set_group_name),
	(_gdm_welcome_session_set_server_dbus_path),
	(_gdm_welcome_session_set_server_dbus_interface),
	(_gdm_welcome_session_set_command),
	(_gdm_welcome_session_set_server_env_var_name),
	(_gdm_welcome_session_set_register_ck_session),
	(gdm_welcome_session_set_property),
	(gdm_welcome_session_get_property),
	(gdm_welcome_session_constructor),
	(gdm_welcome_session_class_init), (gdm_welcome_session_init),
	(gdm_welcome_session_finalize):
	* daemon/gdm-welcome-session.h:
	* daemon/gdm-xdmcp-chooser-slave.c: (run_chooser),
	(gdm_xdmcp_chooser_slave_stop):
	Add a base class to share code between chooser and greeter sessions.

2008-02-01  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-manager.c:
	(maybe_add_session_for_user), (add_sessions_for_user),
	(get_uid_from_session_id), (seat_session_added), (get_seat_proxy):
	Fix filtering out sessions that don't have x11 displays.

2008-02-01  Ray Strode  <rstrode@redhat.com>

	Patch from Eamon Walsh <ewalsh@tycho.nsa.gov> to
	pass path of authority file to pam code so that it
	can be given to PAM at a later time.

	* daemon/test-session.c (main):
	* daemon/gdm-product-slave.c (create_new_session):
	* daemon/gdm-simple-slave.c (create_new_session):
	grab authority file and pass to session direct
	object
	* daemon/gdm-session-worker.c (do_setup),
	(on_setup_for_user):,
	stash away location for authority file
	* daemon/gdm-session-direct.c (do_introspect),
	(send_setup), (send_setup_for_user):
	add authority file to dbus interface
	(_gdm_session_direct_set_display_x11_authority_file):
	(gdm_session_direct_new):
	stash away location for authority file

2008-02-01  Ray Strode  <rstrode@redhat.com>

	* configure.ac: add patch from Cosimo Cecchi to
	fix build

2008-02-01  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-language-chooser-widget.c
	(gdm_language_chooser_widget_get_current_language_name):
	if the language list couldn't be loaded (for whatever reason),
	return current locale instead of null

2008-02-01  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/Makefile.am: change
	LIBLOCALEDIR to $(prefix)/lib/locale instead
	of $(libdir)/locale to fix multilib

2008-02-01  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-language-chooser-dialog.c
	(gdm_language_chooser_dialog_size_request),
	(gdm_language_chooser_dialog_class_init): size dialog better
	(gdm_language_chooser_dialog_init): set initial language to
	the highest priority language returned from g_get_language_names ()
	(gdm_language_chooser_dialog_new): set a title and add some padding

2008-02-01  Ray Strode  <rstrode@redhat.com>

	Put language selector in panel

	* configure.ac: put gconf libs in $GCONF_LIBS
	* gui/simple-greeter/Makefile.am: add widget to makefile
	New subclass of gdm-recent-option-widget that shows
	recently used languages.
	* gui/simple-greeter/gdm-greeter-panel.c
	(gdm_greeter_panel_class_init): create new 'language-selected' signal
	(on_language_activated): new function to emit language-selected when
	language option widget is changed
	(gdm_greeter_panel_init): drop dummy label, add option-widget to panel
	* gui/simple-greeter/gdm-greeter-session.c (on_select_language):
	move user data to first argument and drop GdmGreeterLoginWindow arg
	(toggle_panel): call on_select_language when language-selected is
	emitted from panel
	(toggle_login_window): s/connect/connect_swapped/ to deal with
	on_select_language signature change

2008-02-01  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-language-option-widget.[ch]:
	New subclass of gdm-recent-option-widget that shows
	recently used languages.

2008-02-01  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-panel.c (update_geometry):
	Fix apparent bug where panel always gets allocated twice
	the height it requests.

2008-01-31  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-recent-option-widget.[ch]:
	New subclass of gdm-option-widget that pulls from
	gconf and restrains its size to a fixed number of
	items

2008-01-31  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-language-chooser-widget.[ch]:
	make gdm-language-chooser-widget subclass 
	gdm-chooser-widget for consistency.  
	Drop all the code that's been moved to gdm-languages.c
	and just call into it there.

2008-01-31  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-languages.[ch]:
	New files that copy and paste the non-widget
	specific locale handling code from
	gdm-language-chooser (so it can be used
	for language selection from the panel too)

2008-01-31  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-option-widget.[ch]:
	New widget to help with language/keyboard/session
	selection

2008-01-31  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-chooser-widget.c
	(name_cell_data_func)):
	don't mark every list item as bold

2008-01-31  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-greeter-server.c
	(greeter_handle_child_message)):
	s/SelectSession/SelectLanguage/ in dbus filter function

2008-01-31  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-session-chooser-widget.c
	(gdm_session_chooser_widget_constructor):
	Drop optional stub function

2008-01-31  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-greeter-session.c (get_greeter_environment):
	Pass LANG and LC_* environment variables through to greeter

2008-01-31  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Remove initial tranlated date string.
	Fixes #499943

2008-01-31  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c: (gdm_session_worker_initialize_pam),
	(_open_session_log):
	Don't translate some warnings that have problematic translations.
	Fixes #507531

2008-01-31  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* gui/simple-chooser/Makefile.am:
	* gui/simple-greeter/Makefile.am:
	* tests/Makefile.am:
	Pass convenience libs to linker ahead of global libs.
	Patch from <dmacks@netspace.org>
	Fixes #508169

2008-01-31  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-xdmcp-chooser-slave.xml:
	Ooops. Forgot to add file.

2008-01-30  William Jon McCann  <mccann@jhu.edu>

	* configure.ac: Post release version bump

==== 2.21.6 ====

2008-01-30  William Jon McCann  <mccann@jhu.edu>

	* NEWS: Update for release

2008-01-30  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-address.c: (add_local_siocgifconf),
	(add_local_addrinfo), (gdm_address_peek_local_list):
	* daemon/Makefile.am:
	* daemon/gdm-chooser-server.c: (generate_address),
	(handle_select_hostname), (handle_disconnect),
	(chooser_handle_child_message), (do_introspect),
	(chooser_server_message_handler),
	(chooser_server_unregister_handler), (connection_filter_function),
	(allow_user_function), (handle_connection),
	(gdm_chooser_server_start), (gdm_chooser_server_stop),
	(gdm_chooser_server_get_address),
	(_gdm_chooser_server_set_display_id),
	(_gdm_chooser_server_set_user_name),
	(_gdm_chooser_server_set_group_name),
	(gdm_chooser_server_set_property),
	(gdm_chooser_server_get_property),
	(gdm_chooser_server_constructor), (gdm_chooser_server_class_init),
	(gdm_chooser_server_init), (gdm_chooser_server_finalize),
	(gdm_chooser_server_new):
	* daemon/gdm-chooser-server.h:
	* daemon/gdm-chooser-session.c: (listify_hash),
	(get_chooser_environment), (chooser_session_child_watch),
	(spawn_child_setup), (spawn_command_line_sync_as_user),
	(spawn_command_line_async_as_user), (parse_value_as_integer),
	(parse_dbus_launch_output), (start_dbus_daemon),
	(stop_dbus_daemon), (gdm_chooser_session_spawn),
	(gdm_chooser_session_start), (wait_on_child),
	(chooser_session_died), (gdm_chooser_session_stop),
	(gdm_chooser_session_set_server_address),
	(_gdm_chooser_session_set_x11_display_name),
	(_gdm_chooser_session_set_x11_display_hostname),
	(_gdm_chooser_session_set_x11_display_device),
	(_gdm_chooser_session_set_x11_authority_file),
	(_gdm_chooser_session_set_user_name),
	(_gdm_chooser_session_set_group_name),
	(gdm_chooser_session_set_property),
	(gdm_chooser_session_get_property),
	(gdm_chooser_session_constructor),
	(gdm_chooser_session_class_init), (gdm_chooser_session_init),
	(gdm_chooser_session_finalize), (gdm_chooser_session_new):
	* daemon/gdm-chooser-session.h:
	* daemon/gdm-display.c: (gdm_display_real_set_slave_bus_name),
	(gdm_display_set_slave_bus_name), (gdm_display_class_init):
	* daemon/gdm-display.h:
	* daemon/gdm-display.xml:
	* daemon/gdm-factory-slave.c:
	* daemon/gdm-greeter-server.c:
	* daemon/gdm-greeter-session.c: (gdm_greeter_session_init):
	* daemon/gdm-product-slave.c:
	* daemon/gdm-simple-slave.c:
	* daemon/gdm-slave.c: (gdm_slave_set_slave_bus_name),
	(gdm_slave_real_start), (register_slave), (gdm_slave_constructor):
	* daemon/gdm-xdmcp-chooser-display.c: (on_hostname_selected),
	(gdm_xdmcp_chooser_display_set_slave_bus_name),
	(gdm_xdmcp_chooser_display_manage),
	(gdm_xdmcp_chooser_display_class_init),
	(gdm_xdmcp_chooser_display_init),
	(gdm_xdmcp_chooser_display_finalize),
	(gdm_xdmcp_chooser_display_new):
	* daemon/gdm-xdmcp-chooser-display.h:
	* daemon/gdm-xdmcp-chooser-display.xml:
	* daemon/gdm-xdmcp-chooser-slave.c: (on_chooser_session_start),
	(on_chooser_session_stop), (on_chooser_session_exited),
	(on_chooser_session_died), (on_chooser_hostname_selected),
	(on_chooser_disconnected), (on_chooser_connected), (setup_server),
	(run_chooser), (idle_connect_to_display),
	(gdm_xdmcp_chooser_slave_run), (gdm_xdmcp_chooser_slave_start),
	(gdm_xdmcp_chooser_slave_stop),
	(gdm_xdmcp_chooser_slave_set_property),
	(gdm_xdmcp_chooser_slave_get_property),
	(gdm_xdmcp_chooser_slave_constructor),
	(gdm_xdmcp_chooser_slave_class_init),
	(gdm_xdmcp_chooser_slave_init), (gdm_xdmcp_chooser_slave_finalize),
	(gdm_xdmcp_chooser_slave_new):
	* daemon/gdm-xdmcp-chooser-slave.h:
	* daemon/gdm-xdmcp-display-factory.c: (set_port_for_request),
	(gdm_xdmcp_send_forward_query), (indirect_client_create),
	(indirect_client_destroy), (indirect_client_lookup_by_chosen),
	(indirect_client_lookup), (gdm_xdmcp_handle_indirect_query),
	(forward_query_destroy), (remove_oldest_forward),
	(forward_query_create), (forward_query_lookup),
	(gdm_xdmcp_handle_forward_query), (gdm_xdmcp_send_decline),
	(on_hostname_selected), (gdm_xdmcp_display_create),
	(gdm_xdmcp_handle_request), (gdm_xdmcp_send_refuse),
	(gdm_xdmcp_handle_manage), (gdm_xdmcp_handle_managed_forward):
	* daemon/gdm-xdmcp-display.c: (gdm_xdmcp_display_class_init),
	(gdm_xdmcp_display_finalize):
	* daemon/gdm-xdmcp-display.h:
	* daemon/gdm-xdmcp-display.xml:
	* daemon/gdm-xdmcp-greeter-display.c:
	(gdm_xdmcp_greeter_display_class_init),
	(gdm_xdmcp_greeter_display_init),
	(gdm_xdmcp_greeter_display_finalize),
	(gdm_xdmcp_greeter_display_new):
	* daemon/gdm-xdmcp-greeter-display.h:
	* daemon/xdmcp-chooser-slave-main.c: (get_system_bus), (signal_cb),
	(on_slave_stopped), (main):
	* data/gdm.conf:
	* gui/simple-chooser/Makefile.am:
	* gui/simple-chooser/chooser-main.c: (assistive_registry_launch),
	(filter_watch), (filter_timeout), (assistive_registry_start),
	(at_set_gtk_modules), (load_a11y), (main):
	* gui/simple-chooser/gdm-chooser-client.c:
	(gdm_chooser_client_error_quark), (send_dbus_string_method),
	(send_dbus_void_method), (gdm_chooser_client_call_select_hostname),
	(gdm_chooser_client_call_disconnect), (client_dbus_handle_message),
	(client_dbus_filter_function), (gdm_chooser_client_start),
	(gdm_chooser_client_stop), (gdm_chooser_client_set_property),
	(gdm_chooser_client_get_property),
	(gdm_chooser_client_constructor), (gdm_chooser_client_dispose),
	(gdm_chooser_client_class_init), (gdm_chooser_client_init),
	(gdm_chooser_client_finalize), (gdm_chooser_client_new):
	* gui/simple-chooser/gdm-chooser-client.h:
	* gui/simple-chooser/gdm-chooser-session.c: (launch_compiz),
	(launch_metacity), (start_window_manager), (start_settings_daemon),
	(on_dialog_response), (gdm_chooser_session_start),
	(gdm_chooser_session_stop), (gdm_chooser_session_set_property),
	(gdm_chooser_session_get_property),
	(gdm_chooser_session_constructor), (gdm_chooser_session_dispose),
	(gdm_chooser_session_class_init), (gdm_chooser_session_init),
	(gdm_chooser_session_finalize), (gdm_chooser_session_new):
	* gui/simple-chooser/gdm-chooser-session.h:
	* gui/simple-chooser/test-host-chooser.c:
	(assistive_registry_launch), (filter_watch), (filter_timeout),
	(assistive_registry_start), (at_set_gtk_modules), (load_a11y),
	(main):
	* gui/simple-greeter/greeter-main.c: (load_a11y), (main):
	Initial support for XDMCP IndirectQuery choosers.
	Also fix broken gdm_address_is_local.

2008-01-29  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/gdm-greeter-login-window.c:
	(get_show_restart_buttons), (switch_mode):
	Fix RBAC patch so it works on Linux.

2008-01-29  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-xdmcp-display-factory.c:
	(gdm_xdmcp_handle_managed_forward):
	Fix up spacing.

2008-01-28  Brian Cameron  <brian.cameron@sun.com>

	* acconfig.h, configure.ac, gui/simple-greeter/Makefile.am,
	  gui/simple-greeter/gdm-greeter-login-window.c:  Make
	  polkit-gnome an optional dependency.  Also support
	  RBAC for shutdown/reboot if the --enable-rbac-shutdown
	  configure option is provided.
	* configure.ac: Remove old RBAC configuration options that
	  were used in the GDM 2.20 branch.
	* gui/simple-greeter/gdm-chooser-widget.c: Fix a null string
	  argument problem causing core dumping on Solaris.

2008-01-28  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-display.c: (gdm_display_get_seat_id),
	(gdm_display_class_init):
	* daemon/gdm-display.h:
	* daemon/gdm-display.xml:
	* daemon/gdm-local-display-factory.c:
	(gdm_local_display_factory_create_transient_display),
	(gdm_local_display_factory_create_product_display),
	(create_display):
	* daemon/gdm-simple-slave.c: (on_session_authorized),
	(try_migrate_session), (start_session_timeout),
	(queue_start_session), (on_session_accredited),
	(on_session_accreditation_failed):
	* daemon/gdm-slave.c: (gdm_slave_real_start),
	(_get_uid_and_gid_for_user), (x11_session_is_on_seat),
	(_get_primary_user_session_id), (activate_session_id),
	(gdm_slave_switch_to_user_session),
	(_gdm_slave_set_display_seat_id), (gdm_slave_set_property),
	(gdm_slave_get_property), (gdm_slave_class_init):
	* daemon/gdm-slave.h:
	Initial session migration support.  We still need to
	make the slave die after if it is a transient display.

2008-01-25  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-local-display-factory.c: (store_display),
	(gdm_local_display_factory_create_transient_display),
	(gdm_local_display_factory_create_product_display),
	(create_display), (create_display_for_device),
	(gdm_local_display_factory_start):
	Don't use HAL to get seats since we don't know what to do
	with that info yet.  Hardcode starting one display for
	Seat1 and set the seat-id for all local displays.

2008-01-25  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-session.c: (open_greeter_session):
	Set the ConsoleKit session-type to LoginWindow for the
	greeter sessions.

2008-01-25  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-local-display-factory.c:
	* utils/Makefile.am:
	* utils/gdmflexiserver.c: (is_program_in_path),
	(maybe_lock_screen), (calc_pi), (create_transient_display), (main):
	Add gdmflexiserver command for backward compatibility.
	Only useful for starting a transient display.

2008-01-24  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/gdm-display-store.c: (gdm_display_store_clear),
	(gdm_display_store_remove), (gdm_display_store_finalize):
	* daemon/gdm-factory-slave.c: (create_product_display),
	(gdm_factory_slave_stop):
	* daemon/gdm-local-display-factory.c: (listify_hash), (sort_nums),
	(take_next_display_number), (on_display_disposed), (store_display),
	(gdm_local_display_factory_create_transient_display),
	(gdm_local_display_factory_create_product_display),
	(create_display_for_device), (register_factory), (connect_to_hal),
	(gdm_local_display_factory_constructor),
	(gdm_local_display_factory_class_init),
	(gdm_local_display_factory_init),
	(gdm_local_display_factory_finalize):
	* daemon/gdm-local-display-factory.h:
	* daemon/gdm-local-display-factory.xml:
	* daemon/gdm-static-factory-display.c:
	(gdm_static_factory_display_set_property),
	(gdm_static_factory_display_get_property),
	(gdm_static_factory_display_class_init),
	(gdm_static_factory_display_new):
	* daemon/gdm-static-factory-display.h:
	* daemon/gdm-static-factory-display.xml:
	* daemon/gdm-transient-display.c:
	(gdm_transient_display_create_authority),
	(gdm_transient_display_add_user_authorization),
	(gdm_transient_display_remove_user_authorization),
	(gdm_transient_display_manage), (gdm_transient_display_finish),
	(gdm_transient_display_unmanage),
	(gdm_transient_display_set_property),
	(gdm_transient_display_get_property),
	(gdm_transient_display_class_init), (gdm_transient_display_init),
	(gdm_transient_display_finalize), (gdm_transient_display_new):
	* daemon/gdm-transient-display.h:
	* daemon/gdm-transient-display.xml:
	Use the LocalDisplayFactory to assign X11 Display numbers
	to all local displays.  Try to assign the lowest available.
	Add a stub for a TransientDisplay that can be used to
	do FUS logins.

2008-01-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(get_action_from_error), (do_system_restart), (do_system_stop):
	Don't try to determine PK action independently.  Parse
	it from the error message.

2008-01-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(get_system_num_sessions), (do_system_stop):
	Set the action name for stop.

2008-01-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Remove unused ip and network computer info labels.

2008-01-23  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-session.c: (get_greeter_environment),
	(start_dbus_daemon):
	Make sure the dbus daemon for the greeter session gets the
	correct environment.  This is particularly important when
	doing service activation.

2008-01-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(do_system_restart), (do_system_stop):
	Fix ConsoleKit action names.

2008-01-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (get_int),
	(get_string), (get_user_name), (session_is_real_user),
	(get_system_num_sessions), (system_restart_auth_cb),
	(system_stop_auth_cb), (do_system_restart), (do_system_stop):
	Add support for polkit actions with multiple sessions.

2008-01-23  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/gdm-greeter-login-window.c: (try_system_stop),
	(try_system_restart), (system_restart_auth_cb),
	(system_stop_auth_cb), (do_system_restart), (do_system_stop),
	(restart_button_clicked), (shutdown_button_clicked), (load_theme):
	Initial support for CK/PK system restart/stop functionality.
	We still need to use a different action when multiple users are
	logged in.

2008-01-22  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-display.c: (gdm_display_real_add_user_authorization),
	(gdm_display_real_unmanage), (gdm_display_unmanage),
	(gdm_display_dispose), (gdm_display_finalize):
	* daemon/gdm-factory-slave.c: (on_session_session_started):
	* daemon/gdm-product-display.c:
	(gdm_product_display_add_user_authorization),
	(gdm_product_display_remove_user_authorization):
	* daemon/gdm-product-slave.c: (add_user_authorization),
	(setup_session), (on_relay_establish_credentials),
	(on_relay_renew_credentials):
	* daemon/gdm-session-direct.c: (gdm_session_direct_select_user),
	(gdm_session_direct_handle_username_changed),
	(gdm_session_direct_setup_for_user), (open_ck_session):
	* daemon/gdm-session-worker.c:
	(gdm_session_worker_update_username):
	* daemon/gdm-simple-slave.c: (on_session_accredited):
	* daemon/gdm-static-factory-display.c:
	(gdm_static_factory_display_add_user_authorization),
	(gdm_static_factory_display_remove_user_authorization):
	Make user auth work for factory display again.

2008-01-21  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-address.c: (gdm_address_peek_local_list):
	* daemon/gdm-xdmcp-display-factory.c:
	(gdm_xdmcp_display_factory_class_init),
	(gdm_xdmcp_display_factory_finalize):
	Merge a few changes from the 2.20 branch.

	* gui/simple-chooser/chooser-main.c: (main):
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-remote-login-window.c: (start_xephyr),
	(gdm_remote_login_window_connect),
	(gdm_remote_login_window_set_property),
	(gdm_remote_login_window_get_property),
	(gdm_remote_login_window_constructor),
	(gdm_remote_login_window_class_init),
	(gdm_remote_login_window_init), (gdm_remote_login_window_finalize),
	(gdm_remote_login_window_new):
	* gui/simple-greeter/gdm-remote-login-window.h:
	* gui/simple-greeter/test-remote-login-window.c: (main):
	Add initial remote login (xdmcp) client window.

2008-01-18  William Jon McCann  <mccann@jhu.edu>

	* configure.ac: Post release version bump

==== 2.21.5 ====

2008-01-18  William Jon McCann  <mccann@jhu.edu>

	* NEWS: Update for release

2007-12-22  Ray Strode  <halfline@gnome.org>

	* gui/simple-greeter/gdm-chooser-widget.c
	(gdm_chooser_widget_update_item): recheck whether icon column
	should be visible after update_item call

2007-12-21  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-chooser-widget.c: (foreach_item),
	(gdm_chooser_widget_update_foreach_item),
	(shrink_edge_toward_active_row), (run_animation),
	(set_inactive_items_visible), (gdm_chooser_widget_update_item),
	(gdm_chooser_widget_set_item_in_use):
	* gui/simple-greeter/gdm-chooser-widget.h:
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_dispose), (get_stock_person_pixbuf),
	(get_logged_in_pixbuf), (update_icons), (load_icons),
	(on_icon_theme_changed), (setup_icons), (add_special_users),
	(on_user_added), (gdm_user_chooser_widget_init):
	* gui/simple-greeter/gdm-user.c: (render_icon_from_home),
	(gdm_user_render_icon):
	* gui/simple-greeter/gdm-user.h:
	Reload the themed icons when the icon theme changes.

2007-12-21  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/Makefile.am:
	* gui/settings-daemon/Makefile.am:
	* gui/settings-daemon/gdm-settings-manager.c:
	* gui/settings-daemon/gdm-settings-manager.h:
	* gui/settings-daemon/gdm-settings-module.c:
	* gui/settings-daemon/gdm-settings-module.h:
	* gui/settings-daemon/gdm-settings-plugin.c:
	* gui/settings-daemon/gdm-settings-plugin.h:
	* gui/settings-daemon/gdm-settings-plugins-engine.c:
	* gui/settings-daemon/gdm-settings-plugins-engine.h:
	* gui/settings-daemon/main.c:
	* gui/settings-daemon/plugins/Makefile.am:
	* gui/settings-daemon/plugins/xsettings/Makefile.am:
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-manager.c:
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-manager.h:
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-plugin.c:
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-plugin.h:
	* gui/settings-daemon/plugins/xsettings/xsettings-common.c:
	* gui/settings-daemon/plugins/xsettings/xsettings-common.h:
	* gui/settings-daemon/plugins/xsettings/xsettings-manager.c:
	* gui/settings-daemon/plugins/xsettings/xsettings-manager.h:
	* gui/settings-daemon/plugins/xsettings/xsettings.gdm-settings-plugin.desktop.in:
	Remove the settings daemon.  We use gnome-settings-daemon now.

2007-12-21  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-background.c:
	* gui/simple-greeter/gdm-greeter-background.h:
	* gui/simple-greeter/gdm-greeter-session.c: (toggle_all_levels):
	* gui/simple-greeter/gdm-simple-greeter.schemas.in:
	Enable the background settings module and remove the
	gdm-greeter-background code.

2007-12-21  Brian Cameron  <brian.cameron@sun.com>

	* configure.ac, tests/Makefile.am:  Minor change to
	  add -lsocket and -lnsl when building the test programs
	  on Solaris.  This is needed to link getnameinfo,
	  getaddrinfo, freeaddrinfo, and gai_strerror which
	  are references from libgdmcommon.

2007-12-21  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-direct.c:
	(gdm_session_direct_handle_cancel_pending_query),
	(session_worker_message), (do_introspect):
	* daemon/gdm-session-worker.c: (send_question_method),
	(gdm_session_worker_process_pam_message):
	Handle D-Bus method timeouts.

2007-12-21  Ray Strode  <halfline@gnome.org>

	* gui/simple-greeter/gdm-greeter-login-window.c
	(gdm_greeter_login_window_key_press_event),
	(gdm_greeter_login_window_class_init):
	Reset dialog if escape key is pressed

2007-12-21  Ray Strode  <halfline@gnome.org>

	* gui/simple-greeter/gdm-chooser-widget.c:
	(shrink_edge_toward_active_row): bail if we're already at the top
	(run_animation): stop running if the animation finishes elsewhere
	between iterations.
	(set_inactive_items_visible): new function to hide or show all
	inactive items in one go
	(skip_animation): new function skip to the fully shrunk or fully
	grown state without any intermediate animation
	(gdm_chooser_widget_grow), (gdm_chooser_widget_shrink): skip
	animation if widget is hidden
	(gdm_chooser_widget_show), (gdm_chooser_widget_hide),
	(gdm_chooser_widget_class_init): stop any pending animations if
	the widget just gets shown or hidden

2007-12-21  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c:
	(gdm_session_worker_uninitialize_pam),
	(gdm_session_worker_initialize_pam),
	(gdm_session_worker_authenticate_user),
	(gdm_session_worker_authorize_user),
	(gdm_session_worker_accredit_user),
	(gdm_session_worker_start_user_session),
	(gdm_session_worker_open_user_session), (get_state_name),
	(state_change_idle):
	Add some debug output for the state changes.

	* gui/simple-greeter/gdm-chooser-widget.c:
	(update_column_visibility):
	* gui/simple-greeter/gdm-greeter-session.c: (start_window_manager):
	Prefer metacity over compiz.  We've had a number of compiz
	bugs show up and confuse us.

2007-12-20  Ray Strode  <halfline@gnome.org>

	* gui/simple-greeter/gdm-chooser-widget.c:
	(update_column_visibility): reenable
	(gdm_chooser_widget_add_item), (gdm_chooser_widget_remove_item),
	(gdm_chooser_widget_set_item_in_use): call
	queue_column_visibility_update as needed so columns get shown
	and hidden properly

2007-12-20  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-panel.c: (gdm_greeter_panel_init):
	* gui/simple-greeter/gdm-greeter-session.c: (toggle_panel):
	Re-enable the panel.  Don't show the hostname.

2007-12-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-manager.c:
	(get_x11_display_for_session), (add_sessions_for_user):
	Ignore sessions without an X11 display.

2007-12-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-chooser-widget.c:
	(gdm_chooser_widget_grow), (gdm_chooser_widget_shrink):
	Don't try to animate if not visible.

2007-12-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-manager.c (get_current_seat_id):
	Fix c-n-p error.

2007-12-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-manager.c: (get_seat_id_for_session),
	(get_current_seat_id):
	Make 2 warnings debugs instead

2007-12-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-manager.c: (get_seat_id_for_session),
	(add_sessions_for_user), (get_current_seat_id), (get_seat_proxy),
	(gdm_user_manager_finalize):
	Ignore sessions on other seats.

2007-12-19  Ray Strode  <rstrode@redhat.com>

	Improve the chooser animation

	* gui/simple-greeter/gdm-chooser-widget.c
	(iterate_animation): Support doing an arbitrary
	number of iterations, also rename to run_animation
	(activate_from_row), (stop_animation): Defer "activated"
	signal emission to here, so the toplevel won't react
	to user selection until the animation finishes.  Rename
	stop_animation to on_animation_done since it gets called in
	response to the animation stopping, not to initiate stopping.
	(start_animation): Before starting an animation (and thus
	expanding the scrolled window to the full height of the tree
	view), hide all rows that are currently occluded by the
	the scrolled window.  This prevents an initial grow flicker
	in the shrink sequence

2007-12-19  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c
	(custom_widget_constructor), (load_theme): don't show
	custom widgets by default

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* configure.ac: Post release version bump

==== 2.21.4 ====

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* NEWS: Update for release

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	Fix distcheck.

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c (switch_mode):
	Make sure variable is initialized.

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/gdm-greeter-session.c:
	(start_settings_daemon):
	Require new gnome-settings-daemon.

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-chooser-widget.c: (set_frame_text),
	(gdm_chooser_widget_init):
	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode),
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	* gui/simple-greeter/gdm-greeter-session.c:
	(start_settings_daemon):
	Tweak some widget spacing and alignment.

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-chooser-widget.c (update_column_visibility):
	Disable hiding the image columns for now.

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c: (on_user_added),
	(on_user_is_logged_in_changed):
	* gui/simple-greeter/gdm-user-manager.c: (add_sessions_for_user),
	(add_user), (add_new_user_for_pwent), (get_current_seat_id),
	(reload_passwd):
	Load the list of sessions for each user at startup.

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(fit_window_to_children), (gdm_greeter_login_window_size_request),
	(clear_animation_timeout_id),
	(gdm_greeter_login_window_size_allocate),
	(gdm_greeter_login_window_class_init):
	add lame animation to greeter login window
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode),
	(do_cancel), (reset_dialog), (on_user_unchosen),
	(on_session_activated), (custom_widget_constructor), (load_theme),
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	This change adds the session chooser to the login window.
	It changes the mechanism by the choosers are specified in
	the glade file to use custom widgets.
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/settings-daemon/gdm-settings-plugins-engine.c:
	(gdm_settings_plugins_engine_activate_plugin),
	(gdm_settings_plugins_engine_deactivate_plugin):
	Remove extra slashes.

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-dialog.c:
	(gdm_user_chooser_dialog_init):
	Don't shrink the chooser in the test program.
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-session-chooser-widget.c:
	(gdm_session_chooser_widget_get_current_session_name),
	(gdm_session_chooser_widget_set_current_session_name),
	(gdm_session_chooser_widget_set_show_only_chosen),
	(gdm_session_chooser_widget_dispose),
	(gdm_session_chooser_widget_class_init), (add_session),
	(add_available_sessions), (gdm_session_chooser_widget_init),
	(gdm_session_chooser_widget_new):
	* gui/simple-greeter/gdm-session-chooser-widget.h:
	Convert session chooser to derive from chooser widget.
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_set_show_other_user),
	(gdm_user_chooser_widget_set_show_guest_user),
	(gdm_user_chooser_widget_get_chosen_user_name),
	(gdm_user_chooser_widget_set_chosen_user_name),
	(gdm_user_chooser_widget_set_show_only_chosen),
	(gdm_user_chooser_widget_dispose),
	(gdm_user_chooser_widget_class_init), (add_special_users),
	(on_user_added), (on_user_removed), (on_user_is_logged_in_changed),
	(gdm_user_chooser_widget_init), (gdm_user_chooser_widget_finalize),
	(gdm_user_chooser_widget_new):
	* gui/simple-greeter/gdm-user-chooser-widget.h:
	Convert user chooser to derive from chooser widget.
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-chooser-widget.c: (find_item),
	(get_active_item_id), (gdm_chooser_widget_get_active_item),
	(activate_from_item_id), (set_frame_text),
	(translate_base_path_to_sorted_path),
	(shrink_edge_toward_active_row), (iterate_animation),
	(stop_animation), (start_animation), (gdm_chooser_widget_grow),
	(move_cursor_to_top), (clear_selection),
	(gdm_chooser_widget_shrink), (activate_from_row), (deactivate),
	(activate_selected_item), (gdm_chooser_widget_set_active_item),
	(gdm_chooser_widget_set_property),
	(gdm_chooser_widget_get_property),
	(gdm_chooser_widget_constructor), (gdm_chooser_widget_dispose),
	(gdm_chooser_widget_focus_in), (gdm_chooser_widget_size_request),
	(compare_allocation_height), (renegotiate_allocation),
	(gdm_chooser_widget_size_allocate),
	(gdm_chooser_widget_class_init), (on_row_activated),
	(path_is_separator), (compare_item), (name_cell_data_func),
	(check_cell_data_func), (get_is_in_use_pixbuf), (separator_func),
	(add_separator), (update_column_visibility),
	(clear_canceled_visibility_update),
	(queue_column_visibility_update), (on_row_changed), (add_frame),
	(on_button_release), (gdm_chooser_widget_init),
	(gdm_chooser_widget_finalize), (gdm_chooser_widget_new),
	(gdm_chooser_widget_add_item), (gdm_chooser_widget_remove_item),
	(gdm_chooser_widget_lookup_item),
	(gdm_chooser_widget_set_item_in_use),
	(gdm_chooser_widget_set_in_use_message),
	(gdm_chooser_widget_set_separator_position),
	(gdm_chooser_widget_set_hide_inactive_items):
	* gui/simple-greeter/gdm-chooser-widget.h:
	* gui/simple-greeter/gdm-greeter-session.c:
	(start_settings_daemon):
	Add a common "chooser" widget.
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* configure.ac: Fix check for check.
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-13  William Jon McCann  <mccann@jhu.edu>

	* gui/settings-daemon/main.c: (main):
	Also look for prefix in env var.

2007-12-13  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/settings-daemon/gdm-settings-manager.c:
	(gdm_settings_manager_start), (gdm_settings_manager_stop),
	(_set_gconf_prefix), (gdm_settings_manager_set_property),
	(gdm_settings_manager_get_property),
	(gdm_settings_manager_constructor), (gdm_settings_manager_dispose),
	(gdm_settings_manager_class_init), (gdm_settings_manager_init),
	(gdm_settings_manager_finalize), (gdm_settings_manager_new):
	* gui/settings-daemon/gdm-settings-manager.h:
	* gui/settings-daemon/gdm-settings-plugins-engine.c:
	(gdm_settings_plugins_engine_plugin_active_cb),
	(gdm_settings_plugins_engine_load_file),
	(gdm_settings_plugins_engine_load_dir),
	(gdm_settings_plugins_engine_init),
	(gdm_settings_plugins_engine_shutdown), (collate_values_cb),
	(gdm_settings_plugins_engine_get_plugins_list),
	(gdm_settings_plugins_engine_activate_plugin),
	(gdm_settings_plugins_engine_deactivate_plugin):
	* gui/settings-daemon/gdm-settings-plugins-engine.h:
	* gui/settings-daemon/main.c: (main):
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-session.c:
	(start_settings_daemon):
	* gui/simple-greeter/gdm-simple-greeter.schemas.in:
	Make the settings daemon load plugins from a specified gconf prefix.

2007-12-09  William Jon McCann  <mccann@jhu.edu>

	* Makefile.am:
	* common/gdm-address.c: (gdm_address_equal),
	(gdm_address_is_loopback):
	* common/gdm-common.c: (gdm_string_hex_encode),
	(gdm_string_hex_decode):
	* configure.ac:
	* tests/Makefile.am:
	* tests/m-common.c: (main):
	* tests/s-common-address.c: (setup), (teardown), (START_TEST),
	(suite_common_address):
	* tests/s-common-address.h:
	* tests/s-common-utils.c: (START_TEST), (suite_common_utils):
	* tests/s-common-utils.h:
	Add a unit testing framework.
	Based on a patch from Andrew Ziem <ahz001@gmail.com>

2007-11-30  Ray Strode  <rstrode@redhat.com>

	Fix some problems in the previous commit, spotted by
	Mike Oliver <Mike.Oliver@sun.com>

	* common/gdm-common.[ch] (gdm_generate_random_bytes):
	don't leak fd
	(_read_bytes): initialize bytes_left_to_read

2007-11-30  Ray Strode  <rstrode@redhat.com>

	Ensure second and subsequent auth cookies are
	random.  Spotted by George Lebl.

	* common/gdm-common.[ch] (gdm_generate_random_bytes):
	open /dev/urandom and read size bytes from it.
	(_fd_is_character_device): check if fd points to char
        device
	(_read_bytes): the usual loop until all bytes are read
	helper function for read().

	* daemon/gdm-display-access-file.c
	(generate_random_bytes): remove function
	(gdm_display_access_file_add_display):
	use gdm_generate_random_bytes instead of 
	_generate_random_bytes

2007-11-19  Ray Strode  <rstrode@redhat.com>

	Fix make distcheck

	* acconfig.h: add HAVE_LOG{IN,OUT,WTMP}
	* data/Makefile.am: uninstall pam and gconf files
	in uninstall-hook. fix builddir != srcdir issues

2007-11-19  Ray Strode  <rstrode@redhat.com>

	* data/Makefile.am:
	set up correct permissions on /var/lib/gdm

2007-11-19  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	Fix AC_PREREQ.  Fixes #497932

2007-11-19  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-common-unknown-origin.h:
	* configure.ac:
	* daemon/Makefile.am:
	* daemon/gdm-greeter-session.c:
	* daemon/gdm-server.c: (gdm_server_class_init):
	* daemon/gdm-session-record.c: (record_set_username),
	(gdm_session_record_login), (gdm_session_record_logout):
	* daemon/gdm-session-worker-job.c:
	(gdm_session_worker_job_class_init):
	* daemon/gdm-slave-proxy.c: (spawn_slave):
	* daemon/main.c:
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-manager.c:
	* gui/simple-chooser/gdm-host-chooser-widget.c: (do_ping):
	Fix build on FreeBSD.
	Patch from: Joe Marcus Clarke  <marcus@freebsd.org>

2007-11-19  Ray Strode  <rstrode@redhat.com>

	* data/Makefile.am:
	Add gconf.path and session-setup.entries to 
	Makefile.am

2007-11-19  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* data/Makefile.am:
	* data/gconf.path:
	* data/session-setup.entries:
	Setup gconf database for the GDM greeter session.

	Patch from: Ray Strode  <rstrode@redhat.com>
	and Matthias Clasen <mclasen@redhat.com>

2007-11-14  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-display.c (gdm_display_real_unmanage):
	 only close access file if it's open

2007-11-14  William Jon McCann  <mccann@jhu.edu>

	* configure.ac: Remove unused TSOL stuff.

2007-11-14  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-worker.c:
	(gdm_session_worker_start_user_session),
	(_open_session_log),
	(_fd_is_normal_file): log session console i/o to
	~/.xsession-errors

==== 2.21.2 ====

2007-11-12  William Jon McCann  <mccann@jhu.edu>

	* NEWS: Update for 2.21.2.

2007-11-09  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-display-access-file.c:
	(gdm_display_access_file_class_init),
	(gdm_display_access_file_new),
	(gdm_display_access_file_add_display):
	* daemon/gdm-display-access-file.h:
	Add emacs mode lines, split lines.

2007-11-09  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-common.c: (gdm_string_hex_decode):
	* common/gdm-common.h:
	* daemon/Makefile.am:
	* daemon/auth.c:
	* daemon/auth.h:
	* daemon/gdm-display.c: (_create_access_file_for_user),
	(gdm_display_real_create_authority),
	(gdm_display_real_add_user_authorization),
	(gdm_display_real_remove_user_authorization),
	(gdm_display_get_x11_cookie), (gdm_display_get_x11_authority_file),
	(gdm_display_real_unmanage), (gdm_display_set_property),
	(gdm_display_get_property), (gdm_display_class_init),
	(gdm_display_finalize):
	* daemon/gdm-display.h:
	* daemon/gdm-factory-slave.c: (gdm_factory_slave_run):
	* daemon/gdm-local-display-factory.c: (create_display_for_device):
	* daemon/gdm-manager.c: (gdm_manager_init), (gdm_manager_finalize):
	* daemon/gdm-product-slave.c: (gdm_product_slave_create_server):
	* daemon/gdm-server.c: (_gdm_server_set_auth_file),
	(gdm_server_set_property), (gdm_server_get_property),
	(gdm_server_class_init), (gdm_server_new):
	* daemon/gdm-server.h:
	* daemon/gdm-simple-slave.c: (gdm_simple_slave_run):
	* daemon/gdm-slave.c: (gdm_slave_connect_to_x11_display),
	(gdm_slave_real_start), (gdm_slave_set_property),
	(gdm_slave_get_property), (gdm_slave_class_init):
	* daemon/gdm-static-display.c:
	(gdm_static_display_add_user_authorization),
	(gdm_static_display_remove_user_authorization):
	* daemon/gdm-xdmcp-display-factory.c: (gdm_xdmcp_handle_request):
	* daemon/gdm-xdmcp-display.c: (gdm_xdmcp_display_create_authority),
	(gdm_xdmcp_display_add_user_authorization),
	(gdm_xdmcp_display_remove_user_authorization),
	(gdm_xdmcp_display_unmanage):
	* daemon/gdm-display-access-file.c:
	* daemon/gdm-display-access-file.h:
	With this patch we now invoke the X server with the -auth argument
	and disable machine wide access to the X server.  This patch also
	drops the md5 hashing of random bytes to create cookies and
	instead just creates cookies directly (like the X server would if
	we asked the X server to generate the cookies for us).

	Patch from: Ray Strode  <rstrode@redhat.com>

2007-11-07  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/test-hal-seats.c: (list_seats):
	Build the test hal seats tool

2007-11-07  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (greeter_reset_timeout),
	(queue_greeter_reset), (on_session_setup_complete),
	(on_session_setup_failed), (on_session_reset_complete),
	(on_session_reset_failed), (on_session_authenticated),
	(on_session_authentication_failed), (on_session_authorized),
	(on_session_authorization_failed), (on_session_accredited),
	(on_session_accreditation_failed), (on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user),
	(gdm_factory_slave_start):
	* daemon/gdm-product-slave.c: (on_session_setup_complete),
	(on_session_setup_failed), (on_session_reset_complete),
	(on_session_reset_failed), (on_session_authenticated),
	(on_session_authentication_failed), (on_session_authorized),
	(on_session_authorization_failed), (on_session_accredited),
	(on_session_accreditation_failed), (on_relay_setup),
	(on_relay_setup_for_user), (on_relay_authenticate),
	(on_relay_authorize), (on_relay_establish_credentials),
	(on_relay_renew_credentials), (create_new_session),
	(relay_dbus_handle_message):
	* daemon/gdm-session-direct.c: (send_dbus_void_signal),
	(on_authentication_failed), (on_session_start_failed),
	(gdm_session_direct_handle_setup_complete),
	(gdm_session_direct_handle_setup_failed),
	(gdm_session_direct_handle_reset_complete),
	(gdm_session_direct_handle_reset_failed),
	(gdm_session_direct_handle_authenticated),
	(gdm_session_direct_handle_authentication_failed),
	(gdm_session_direct_handle_authorized),
	(gdm_session_direct_handle_authorization_failed),
	(gdm_session_direct_handle_accredited),
	(gdm_session_direct_handle_accreditation_failed),
	(gdm_session_direct_handle_start_failed), (session_worker_message),
	(do_introspect), (gdm_session_direct_init), (worker_exited),
	(worker_died), (gdm_session_direct_open), (send_setup),
	(send_setup_for_user), (gdm_session_direct_setup),
	(gdm_session_direct_setup_for_user),
	(gdm_session_direct_authenticate), (gdm_session_direct_authorize),
	(gdm_session_direct_accredit), (gdm_session_direct_close),
	(gdm_session_iface_init):
	* daemon/gdm-session-direct.h:
	* daemon/gdm-session-private.h:
	* daemon/gdm-session-relay.c: (send_dbus_string_signal),
	(send_dbus_void_signal), (gdm_session_relay_setup),
	(gdm_session_relay_setup_for_user),
	(gdm_session_relay_authenticate), (gdm_session_relay_authorize),
	(gdm_session_relay_accredit), (gdm_session_relay_answer_query),
	(handle_setup_complete), (handle_setup_failed),
	(handle_authenticated), (handle_authentication_failed),
	(handle_authorized), (handle_authorization_failed),
	(handle_accredited), (handle_accreditation_failed),
	(handle_session_started), (handle_session_stopped),
	(handle_opened), (session_handle_child_message), (do_introspect),
	(gdm_session_iface_init):
	* daemon/gdm-session-worker.c: (gdm_session_execute),
	(gdm_session_worker_update_username),
	(gdm_session_worker_initialize_pam),
	(gdm_session_worker_accredit_user), (session_worker_child_watch),
	(gdm_session_worker_start_user_session), (do_setup),
	(do_authenticate), (do_authorize), (do_accredit),
	(do_open_session), (do_start_session), (state_change_idle),
	(on_setup), (on_setup_for_user), (on_authenticate), (on_authorize),
	(on_establish_credentials), (on_renew_credentials),
	(worker_dbus_handle_message):
	* daemon/gdm-session.c: (gdm_session_setup),
	(gdm_session_setup_for_user), (gdm_session_authenticate),
	(gdm_session_authorize), (gdm_session_accredit),
	(gdm_session_class_init), (_gdm_session_setup_complete),
	(_gdm_session_setup_failed), (_gdm_session_reset_complete),
	(_gdm_session_reset_failed), (_gdm_session_authenticated),
	(_gdm_session_authentication_failed), (_gdm_session_authorized),
	(_gdm_session_authorization_failed), (_gdm_session_accredited),
	(_gdm_session_accreditation_failed),
	(_gdm_session_session_start_failed):
	* daemon/gdm-session.h:
	* daemon/gdm-simple-slave.c: (greeter_reset_timeout),
	(queue_greeter_reset), (on_session_setup_complete),
	(on_session_setup_failed), (on_session_reset_complete),
	(on_session_reset_failed), (on_session_authenticated),
	(on_session_authentication_failed), (on_session_authorized),
	(on_session_authorization_failed), (on_session_accredited),
	(on_session_accreditation_failed), (create_new_session),
	(on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user):
	* daemon/test-session.c: (on_open), (on_session_setup_complete),
	(on_session_setup_failed), (on_session_reset_complete),
	(on_session_reset_failed), (on_session_authenticated),
	(on_session_authentication_failed), (on_session_authorized),
	(on_session_authorization_failed), (on_session_accredited),
	(on_session_accreditation_failed), (on_session_started),
	(on_session_exited), (on_session_died), (main):
	Split up the Verification step in the GdmSession interface into
	component parts: setup, authenticate, authorize, accredit.

2007-11-06  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c: (send_dbus_void_method),
	(send_authenticated), (send_session_startup_failed),
	(send_authentication_failed), (send_authorization_failed),
	(send_accreditation_failed), (gdm_session_worker_initialize_pam),
	(gdm_session_worker_authenticate_user),
	(gdm_session_worker_accredit_user),
	(gdm_session_worker_start_user_session),
	(gdm_session_worker_open_user_session), (do_initialize),
	(do_authenticate), (do_authorize), (do_accredit),
	(do_open_session), (do_start_session), (state_change_idle),
	(queue_state_change), (on_start_program), (on_begin_verification),
	(on_begin_verification_for_user):
	Make worker internally use a state machine.

2007-11-06  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c:
	(gdm_session_worker_uninitialize_pam),
	(gdm_session_worker_authenticate_user),
	(gdm_session_worker_authorize_user),
	(gdm_session_worker_give_user_credentials),
	(gdm_session_worker_open_user_session),
	(gdm_session_worker_start_program):
	* daemon/gdm-session-worker.h:
	Make a bit more like a state machine.  This will make it easier to
	separate the steps but make sure they occur in the proper order.

2007-11-05  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c: (choose_user_id),
	(on_user_added), (on_user_removed), (on_user_is_logged_in_changed):
	* gui/simple-greeter/gdm-user-manager.c:
	(on_user_sessions_changed), (on_user_icon_changed), (create_user),
	(add_new_user_for_pwent), (get_current_seat_id),
	(get_uid_from_session_id), (seat_session_added),
	(seat_session_removed), (on_proxy_destroy), (get_seat_proxy),
	(gdm_user_manager_get_user), (reload_passwd),
	(gdm_user_manager_init), (gdm_user_manager_finalize):
	* gui/simple-greeter/gdm-user-private.h:
	* gui/simple-greeter/gdm-user.c: (session_compare),
	(_gdm_user_add_session), (_gdm_user_remove_session):
	Use ConsoleKit to drive populate the list of sessions for each user.

2007-11-04  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c: (on_user_added),
	(on_user_is_logged_in_changed):
	* gui/simple-greeter/gdm-user.c: (gdm_user_get_num_sessions),
	(gdm_user_init):
	More session list stuff.

2007-11-04  William Jon McCann  <mccannwj@acsnb1>

	* gui/simple-greeter/gdm-user-manager.c: (reload_passwd):
	* gui/simple-greeter/gdm-user-private.h:
	* gui/simple-greeter/gdm-user.c: (_gdm_user_add_session),
	(_gdm_user_remove_session), (gdm_user_get_property),
	(gdm_user_class_init):
	* gui/simple-greeter/gdm-user.h:
	Add back the session list to GdmUser.

2007-11-02  William Jon McCann  <mccann@jhu.edu>

	* data/gdm.conf:
	Block Settings.SetValue by default in the dbus security policy.

2007-11-02  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-settings-keys.h:
	* common/gdm-settings.c: (gdm_settings_set_value):
	* common/test-settings-client.c: (test_settings_client):
	Remove obsolete config keys.  Add examples for
	using dbus-send.  Fix return value of SetValue.

2007-11-01  William Jon McCann  <mccann@jhu.edu>

	* Makefile.am:
	* data/Makefile.am:
	Fix build.

2007-11-01  William Jon McCann  <mccann@jhu.edu>

	* config/.cvsignore:
	Remove config dir.

2007-11-01  William Jon McCann  <mccann@jhu.edu>

	* config/Init.in:
	* config/Makefile.am:
	* config/PostLogin:
	* config/PostSession.in:
	* config/PreSession.in:
	* config/Xsession.in:
	* config/gdm:
	* config/gdm-autologin:
	* config/gdm.conf-custom.in:
	* configure.ac:
	* data/Makefile.am:
	Move stuff from config to data.

2007-11-01  William Jon McCann  <mccann@jhu.edu>

	* config/Makefile.am:
	* config/gdm.conf-custom.in:
	* config/gdm.conf.in:
	* data/gdm.schemas.in.in:
	Kill config options that we don't use.

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* configure.ac: Fix typo

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	Add Xau and Xext to XLIB_LIBS when x11.pc isn't
	found.  Fixes #492022 more

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/Makefile.am:
	If x11.pc doesn't exist then try a fallback.
	Fixes #492022

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-direct.c: (gdm_session_direct_start_session):
	This patch is sort of the minimum we need to get the session run
	through Xsession (which makes sure ssh-agent/dbus/etc get
	started).
	Patch from: Ray Strode <halfline@gmail.com>

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c:
	(gdm_session_worker_uninitialize_pam):
	change error_code to status to make it clear
	it isn't just for errors.

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c: (session_worker_child_watch):
	make sure we close the session on logout
	Patch from: Ray Strode <halfline@gmail.com>

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* configure.ac: Post release version bump

==== 2.21.1 ====

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* NEWS: Update for release

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/INTERNALS: Update with new GdmSession interface.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-direct.c: (send_begin_verification),
	(send_begin_verification_for_user), (open_ck_session):
	* daemon/gdm-session-record.c: (record_set_host),
	(record_set_line):
	Be careful about sending NULLs over DBus and etc.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c: (send_dbus_string_method),
	(send_dbus_int_method), (send_user_verified),
	(send_question_method), (gdm_session_worker_start_program):
	Convert some warnings to debugs

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (on_session_user_verified):
	* daemon/gdm-product-slave.c: (send_dbus_string_method),
	(send_dbus_void_method), (relay_session_started),
	(relay_session_opened), (on_session_opened), (disconnect_relay),
	(on_session_started), (on_session_exited), (on_session_died),
	(on_session_user_verified), (on_session_user_verification_error),
	(on_session_info), (on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_relay_begin_verification),
	(on_relay_begin_verification_for_user), (on_relay_answer_query),
	(on_relay_session_selected), (on_relay_language_selected),
	(on_relay_user_selected), (on_relay_open),
	(on_relay_start_session), (on_relay_cancelled),
	(relay_dbus_handle_message), (relay_dbus_filter_function),
	(connect_to_session_relay), (gdm_product_slave_init):
	* daemon/gdm-session-worker.c: (worker_dbus_handle_message),
	(worker_dbus_filter_function):
	* gui/simple-greeter/gdm-greeter-client.c:
	(client_dbus_handle_message):
	Convert to libdbus.  Complete the migration to the new GdmSession
	interface.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-background.c:
	(cairo_surface_get_height), (update_surface), (load_image),
	(update_background), (update_geometry),
	(gdm_greeter_background_real_expose),
	(gdm_greeter_background_real_configure):
	* gui/simple-greeter/gdm-greeter-client.c:
	(emit_string_signal_for_message), (on_ready), (on_reset),
	(send_dbus_string_method), (send_dbus_void_method),
	(send_get_display_id), (cache_display_values),
	(client_dbus_filter_function), (gdm_greeter_client_start),
	(gdm_greeter_client_dispose):
	* gui/simple-greeter/gdm-greeter-login-window.c: (reset_dialog),
	(gdm_greeter_login_window_info),
	(gdm_greeter_login_window_problem),
	(gdm_greeter_login_window_info_query):
	* gui/simple-greeter/gdm-greeter-session.c: (on_info),
	(on_problem), (on_ready), (on_reset), (on_selected_user_changed),
	(on_info_query), (on_secret_info_query), (toggle_login_window),
	(launch_compiz), (launch_metacity), (start_settings_daemon),
	(gdm_greeter_session_dispose):
	* gui/simple-greeter/gdm-session-client.c:
	(gdm_session_client_start), (gdm_session_client_stop):
	* gui/simple-greeter/gdm-session-manager.c:
	(gdm_session_manager_load_autostart_dir), (_change_level):
	Prefix debug messages with class name to make output easier to read.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-local-display-factory.c: (create_display_for_device):
	oops that sneaked in.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-signal-handler.c: (signal_io_watch), (catch_signal),
	(uncatch_signal), (gdm_signal_handler_add),
	(gdm_signal_handler_remove_and_free_data),
	(gdm_signal_handler_finalize):
	* daemon/gdm-display-store.c: (gdm_display_store_clear),
	(gdm_display_store_remove), (gdm_display_store_add),
	(display_unref):
	* daemon/gdm-factory-slave.c: (on_greeter_start),
	(on_greeter_stop), (on_session_info), (on_session_problem),
	(on_session_info_query), (on_session_secret_info_query),
	(on_session_opened), (on_session_user_verified),
	(on_session_user_verification_error), (on_session_session_started),
	(create_product_display), (on_session_relay_disconnected),
	(on_session_relay_connected), (on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user), (on_greeter_answer),
	(on_greeter_connected), (run_greeter), (idle_connect_to_display),
	(server_ready_cb), (gdm_factory_slave_run),
	(gdm_factory_slave_start), (gdm_factory_slave_stop),
	(gdm_factory_slave_finalize):
	* daemon/gdm-greeter-server.c: (send_dbus_message),
	(send_dbus_string_signal), (send_dbus_void_signal),
	(handle_begin_verification), (handle_begin_verification_for_user),
	(handle_answer_query), (handle_select_session),
	(handle_select_hostname), (handle_select_language),
	(handle_select_user), (do_introspect),
	(connection_filter_function), (handle_connection),
	(gdm_greeter_server_start), (gdm_greeter_server_stop):
	* daemon/gdm-greeter-session.c: (listify_hash),
	(open_greeter_session), (greeter_session_child_watch),
	(spawn_child_setup), (start_dbus_daemon),
	(gdm_greeter_session_spawn), (gdm_greeter_session_start),
	(wait_on_child), (greeter_session_died),
	(gdm_greeter_session_stop):
	* daemon/gdm-local-display-factory.c: (create_display_for_device),
	(create_displays_for_pci_devices):
	* daemon/gdm-manager.c: (gdm_manager_start),
	(gdm_manager_set_wait_for_go), (remove_displays_for_connection),
	(bus_name_owner_changed):
	* daemon/gdm-product-display.c:
	(gdm_product_display_get_relay_address):
	* daemon/gdm-product-slave.c: (on_session_opened),
	(on_session_started), (on_session_exited), (on_session_died),
	(gdm_product_slave_create_server), (on_session_user_verified),
	(on_session_user_verification_error), (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_relay_begin_verification),
	(on_relay_begin_verification_for_user), (on_relay_answer),
	(on_relay_session_selected), (on_relay_language_selected),
	(on_relay_user_selected), (create_new_session),
	(on_relay_cancelled), (session_relay_proxy_destroyed),
	(get_relay_address), (connect_to_session_relay),
	(gdm_product_slave_stop):
	* daemon/gdm-server.c: (_gdm_server_query_ck_for_display_device),
	(emit_ready_idle), (connect_to_parent), (change_user),
	(server_child_setup), (server_child_watch), (gdm_server_spawn),
	(wait_on_child), (server_died), (gdm_server_stop):
	* daemon/gdm-session-direct.c: (send_dbus_string_signal),
	(gdm_session_direct_handle_verified),
	(gdm_session_direct_handle_verification_failed),
	(gdm_session_direct_handle_username_changed),
	(cancel_pending_query), (gdm_session_direct_handle_info_query),
	(gdm_session_direct_handle_secret_info_query),
	(gdm_session_direct_handle_info),
	(gdm_session_direct_handle_problem),
	(gdm_session_direct_handle_session_started),
	(gdm_session_direct_handle_startup_failed),
	(gdm_session_direct_handle_session_exited),
	(gdm_session_direct_handle_session_died), (do_introspect),
	(session_message_handler), (allow_user_function),
	(handle_connection), (setup_server), (worker_stopped),
	(worker_started), (worker_exited), (worker_died),
	(gdm_session_direct_open), (send_begin_verification),
	(send_begin_verification_for_user), (send_environment_variable),
	(get_session_command_for_file), (gdm_session_direct_close),
	(_gdm_session_direct_set_display_device),
	(gdm_session_direct_dispose):
	* daemon/gdm-session-relay.c: (send_dbus_message),
	(send_dbus_string_signal), (send_dbus_void_signal),
	(gdm_session_relay_begin_verification),
	(gdm_session_relay_begin_verification_for_user),
	(gdm_session_relay_answer_query), (handle_info_query),
	(handle_secret_info_query), (handle_info), (handle_problem),
	(handle_user_verified), (handle_user_verification_error),
	(handle_session_started), (handle_session_stopped),
	(handle_opened), (handle_reset), (do_introspect),
	(session_relay_message_handler), (connection_filter_function),
	(handle_connection), (gdm_session_relay_start),
	(gdm_session_relay_stop):
	* daemon/gdm-session-worker-job.c:
	(session_worker_job_child_watch), (gdm_session_worker_job_spawn),
	(gdm_session_worker_job_start), (wait_on_child),
	(session_worker_job_died), (gdm_session_worker_job_stop):
	* daemon/gdm-session-worker.c: (send_dbus_string_method),
	(send_dbus_int_method), (send_user_verified),
	(gdm_session_worker_get_username),
	(gdm_session_worker_update_username), (send_question_method),
	(gdm_session_worker_process_pam_message),
	(gdm_session_worker_pam_new_messages_handler),
	(gdm_session_worker_uninitialize_pam),
	(gdm_session_worker_initialize_pam),
	(gdm_session_worker_authenticate_user),
	(gdm_session_worker_authorize_user),
	(gdm_session_worker_verify_user), (session_worker_child_watch),
	(gdm_session_worker_open_user_session), (gdm_session_worker_open),
	(on_set_environment_variable), (on_start_program), (open_idle),
	(on_begin_verification), (on_begin_verification_for_user),
	(worker_dbus_filter_function), (gdm_session_worker_constructor):
	* daemon/gdm-simple-slave.c: (on_session_started),
	(on_session_exited), (on_session_died), (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_session_opened),
	(on_session_selected_user_changed), (create_new_session),
	(on_greeter_start), (on_greeter_stop),
	(on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user),
	(on_greeter_user_selected), (on_greeter_cancel),
	(on_greeter_connected), (run_greeter), (gdm_simple_slave_run),
	(gdm_simple_slave_stop):
	* daemon/gdm-slave-proxy.c: (child_watch), (spawn_slave),
	(gdm_slave_proxy_stop), (gdm_slave_proxy_dispose):
	* daemon/gdm-slave.c: (listify_hash), (gdm_slave_run_script),
	(set_local_auth), (gdm_slave_connect_to_x11_display),
	(display_proxy_destroyed_cb), (gdm_slave_real_start),
	(gdm_slave_real_stop), (gdm_slave_start), (gdm_slave_stop),
	(gdm_slave_constructor):
	* daemon/gdm-static-factory-display.c:
	(gdm_static_factory_display_create_product_display):
	* daemon/gdm-xdmcp-display-factory.c: (debug_addrinfo), (do_bind),
	(setup_multicast), (open_port), (gdm_xdmcp_send_willing),
	(gdm_xdmcp_send_unwilling), (gdm_xdmcp_send_forward_query),
	(gdm_forward_query_dispose), (gdm_forward_query_lookup),
	(gdm_xdmcp_handle_forward_query),
	(gdm_xdmcp_really_send_managed_forward),
	(gdm_xdmcp_send_got_managed_forward), (display_dispose_check),
	(gdm_xdmcp_send_decline), (gdm_xdmcp_display_alloc),
	(gdm_xdmcp_send_accept), (gdm_xdmcp_handle_request),
	(gdm_xdmcp_send_failed), (gdm_xdmcp_send_refuse),
	(gdm_xdmcp_handle_manage), (gdm_xdmcp_handle_managed_forward),
	(gdm_xdmcp_handle_got_managed_forward), (gdm_xdmcp_send_alive),
	(gdm_xdmcp_handle_keepalive), (decode_packet),
	(gdm_xdmcp_display_factory_start):
	* daemon/gdm-xdmcp-display.c: (gdm_xdmcp_display_create_authority),
	(gdm_xdmcp_display_add_user_authorization):
	Prefix debug messages with class name to make output easier to read.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-direct.c: (stop_worker),
	(gdm_session_direct_close):
	Make a stop_worker function for symmetry.

	* daemon/session-worker-main.c: (main):
	Add gdm_set_fatal_warnings_if_unstable

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-server.c: (send_dbus_message),
	(send_dbus_string_signal),
	(gdm_greeter_server_selected_user_changed), (do_introspect):
	* daemon/gdm-greeter-server.h:
	* daemon/gdm-session-worker.c: (send_dbus_string_method),
	(gdm_session_worker_get_username),
	(gdm_session_worker_process_pam_message),
	(worker_dbus_filter_function):
	* daemon/gdm-simple-slave.c: (on_session_selected_user_changed):
	* gui/simple-greeter/gdm-greeter-client.c:
	(emit_string_signal_for_message), (on_selected_user_changed),
	(on_info_query), (on_secret_info_query), (on_info), (on_problem),
	(on_ready), (on_reset), (send_dbus_string_method),
	(send_dbus_void_method),
	(gdm_greeter_client_call_begin_verification),
	(gdm_greeter_client_call_begin_verification_for_user),
	(gdm_greeter_client_call_answer_query),
	(gdm_greeter_client_call_select_session),
	(gdm_greeter_client_call_select_language),
	(gdm_greeter_client_call_select_user),
	(gdm_greeter_client_call_select_hostname),
	(gdm_greeter_client_call_cancel),
	(gdm_greeter_client_call_disconnect), (send_get_display_id),
	(gdm_greeter_client_call_get_display_id),
	(client_dbus_handle_message), (client_dbus_filter_function),
	(gdm_greeter_client_start), (gdm_greeter_client_class_init):
	* gui/simple-greeter/gdm-greeter-client.h:
	* gui/simple-greeter/gdm-greeter-session.c: (on_info),
	(on_problem), (on_ready), (on_reset), (on_selected_user_changed),
	(on_info_query), (on_secret_info_query),
	(gdm_greeter_session_init):
	Convert the GreeterClient to use dbus instead of dbus-glib.  Add
	support for the SelectedUserChanged signal.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_init):
	Make checkbox column smaller.

2007-10-29  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/gdm-factory-slave.c: (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_session_opened),
	(on_session_user_verified), (on_session_user_verification_error),
	(on_session_session_started), (create_product_display),
	(on_session_relay_disconnected), (on_session_relay_connected),
	(on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user), (on_greeter_answer),
	(on_greeter_session_selected), (on_greeter_language_selected),
	(on_greeter_user_selected), (on_greeter_cancel),
	(gdm_factory_slave_start), (gdm_factory_slave_stop):
	* daemon/gdm-product-slave.c: (setup_server),
	(add_user_authorization), (setup_session),
	(on_session_user_verified), (on_relay_start_session),
	(on_relay_begin_verification),
	(on_relay_begin_verification_for_user), (on_relay_answer),
	(reset_session), (on_relay_open), (create_new_session),
	(on_relay_cancelled), (connect_to_session_relay),
	(gdm_product_slave_stop):
	* daemon/gdm-session-direct.c: (on_user_verification_error),
	(on_session_started), (on_session_startup_error),
	(on_session_exited), (gdm_session_direct_handle_verified),
	(gdm_session_direct_handle_verification_failed),
	(gdm_session_direct_handle_username_changed),
	(gdm_session_direct_handle_info_query),
	(gdm_session_direct_handle_secret_info_query),
	(gdm_session_direct_handle_info),
	(gdm_session_direct_handle_problem),
	(gdm_session_direct_handle_session_started),
	(gdm_session_direct_handle_startup_failed),
	(gdm_session_direct_handle_session_exited),
	(gdm_session_direct_handle_session_died), (handle_connection),
	(gdm_session_direct_init), (worker_exited), (worker_died),
	(gdm_session_direct_open), (send_begin_verification),
	(send_begin_verification_for_user),
	(gdm_session_direct_begin_verification),
	(gdm_session_direct_begin_verification_for_user),
	(is_prog_in_path), (get_session_command_for_file),
	(get_session_command), (open_ck_session),
	(setup_session_environment), (gdm_session_direct_start_session),
	(gdm_session_direct_close), (gdm_session_direct_answer_query),
	(gdm_session_direct_cancel), (gdm_session_direct_get_username),
	(gdm_session_direct_select_session),
	(gdm_session_direct_select_language),
	(gdm_session_direct_select_user),
	(_gdm_session_direct_set_display_name),
	(_gdm_session_direct_set_display_hostname),
	(_gdm_session_direct_set_display_device),
	(_gdm_session_direct_set_user_x11_authority_file),
	(_gdm_session_direct_set_display_is_local),
	(gdm_session_direct_set_property),
	(gdm_session_direct_get_property), (gdm_session_direct_dispose),
	(gdm_session_direct_finalize), (gdm_session_iface_init),
	(gdm_session_direct_class_init), (gdm_session_direct_new):
	* daemon/gdm-session-direct.h:
	* daemon/gdm-session-private.h:
	* daemon/gdm-session-relay.c: (gdm_session_relay_open),
	(gdm_session_relay_close), (gdm_session_relay_begin_verification),
	(gdm_session_relay_begin_verification_for_user),
	(gdm_session_relay_answer_query),
	(gdm_session_relay_select_session),
	(gdm_session_relay_select_language),
	(gdm_session_relay_select_user), (gdm_session_relay_cancel),
	(gdm_session_relay_start_session), (handle_info_query),
	(handle_secret_info_query), (handle_info), (handle_problem),
	(handle_user_verified), (handle_user_verification_error),
	(handle_session_started), (handle_session_stopped),
	(handle_opened), (handle_reset), (do_introspect),
	(handle_connection), (gdm_session_iface_init),
	(gdm_session_relay_class_init):
	* daemon/gdm-session-relay.h:
	* daemon/gdm-session.c: (gdm_session_get_type), (gdm_session_open),
	(gdm_session_close), (gdm_session_begin_verification),
	(gdm_session_begin_verification_for_user),
	(gdm_session_answer_query), (gdm_session_select_session),
	(gdm_session_select_language), (gdm_session_select_user),
	(gdm_session_cancel), (gdm_session_start_session),
	(gdm_session_class_init), (_gdm_session_user_verified),
	(_gdm_session_user_verification_error), (_gdm_session_info_query),
	(_gdm_session_secret_info_query), (_gdm_session_info),
	(_gdm_session_problem), (_gdm_session_session_started),
	(_gdm_session_session_startup_error),
	(_gdm_session_session_exited), (_gdm_session_session_died),
	(_gdm_session_opened), (_gdm_session_closed),
	(_gdm_session_selected_user_changed):
	* daemon/gdm-session.h:
	* daemon/gdm-simple-slave.c: (on_session_started),
	(on_session_exited), (on_session_died), (on_session_user_verified),
	(on_session_user_verification_error), (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_session_opened),
	(on_session_selected_user_changed), (create_new_session),
	(on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user), (on_greeter_answer),
	(on_greeter_session_selected), (on_greeter_language_selected),
	(on_greeter_cancel), (on_greeter_connected),
	(gdm_simple_slave_stop), (gdm_simple_slave_init):
	* daemon/test-session.c: (on_open), (on_session_started),
	(on_session_exited), (on_session_died), (on_user_verified),
	(on_user_verification_error), (on_info_query), (on_info),
	(on_problem), (on_secret_info_query), (import_environment), (main):
	Make SessionRelay and SessionDirect (was Session) implement a common
	interface GdmSession.  Push some code that lived in the simple and product
	slaves into the SessionDirect class.  Using an interface has a few
	advantages besides ensuring consistency: makes it easier to do some
	abstraction in the slave classes, makes it possible to more easily
	implement other non-pam backends.

	Add a stub for a selected-user-changed signal from the session interface.
	This will be used to update the user selection in the greeter when the
	user is set from the backend.

2007-10-29  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/gdm-product-slave.c: (on_session_opened),
	(on_session_started), (on_session_exited), (on_session_died),
	(slave_open_ck_session), (setup_session_environment),
	(setup_session), (on_session_user_verified),
	(on_session_user_verification_error), (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_relay_begin_verification),
	(on_relay_begin_verification_for_user), (on_relay_answer),
	(reset_session), (on_relay_open), (create_new_session),
	(on_relay_cancelled), (gdm_product_slave_stop):
	* daemon/gdm-session-direct.c: (gdm_session_direct_error_quark),
	(send_dbus_string_signal),
	(gdm_session_direct_user_verification_error_handler),
	(gdm_session_direct_started_handler),
	(gdm_session_direct_startup_error_handler),
	(gdm_session_direct_exited_handler),
	(gdm_session_direct_class_install_signals),
	(gdm_session_direct_finalize), (gdm_session_direct_class_init),
	(gdm_session_direct_handle_verified),
	(gdm_session_direct_handle_verification_failed),
	(gdm_session_direct_handle_username_changed),
	(cancel_pending_query), (answer_pending_query),
	(set_pending_query), (gdm_session_direct_handle_info_query),
	(gdm_session_direct_handle_secret_info_query),
	(gdm_session_direct_handle_info),
	(gdm_session_direct_handle_problem),
	(gdm_session_direct_handle_session_started),
	(gdm_session_direct_handle_startup_failed),
	(gdm_session_direct_handle_session_exited),
	(gdm_session_direct_handle_session_died), (session_worker_message),
	(handle_connection), (setup_server), (gdm_session_direct_init),
	(gdm_session_direct_new), (worker_stopped), (worker_started),
	(worker_exited), (worker_died), (start_worker),
	(gdm_session_direct_open), (send_begin_verification),
	(send_begin_verification_for_user),
	(gdm_session_direct_begin_verification),
	(send_environment_variable), (send_environment),
	(gdm_session_direct_start_program), (gdm_session_direct_close),
	(gdm_session_direct_is_running),
	(gdm_session_direct_set_environment_variable),
	(gdm_session_direct_answer_query),
	(gdm_session_direct_get_username):
	* daemon/gdm-session-direct.h:
	* daemon/gdm-session-relay.h:
	* daemon/gdm-session.c:
	* daemon/gdm-session.h:
	* daemon/gdm-simple-slave.c: (on_session_started),
	(on_session_exited), (on_session_died), (add_user_authorization),
	(slave_open_ck_session), (setup_session_environment),
	(on_session_user_verified), (on_session_user_verification_error),
	(on_session_info), (on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_session_opened),
	(create_new_session), (on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user), (on_greeter_answer),
	(on_greeter_cancel), (on_greeter_connected),
	(gdm_simple_slave_stop):
	* daemon/gdm-slave.c:
	* daemon/test-session.c: (on_open), (on_session_started),
	(on_session_exited), (on_session_died), (on_user_verified),
	(on_user_verification_error), (on_info_query), (on_info),
	(on_problem), (on_secret_info_query), (import_environment), (main):
	Rename GdmSession to GdmSessionDirect in preparation for adding
	a GdmSession interface.  Naming is hard.

2007-10-29  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (setup_server), (run_greeter),
	(idle_connect_to_display):
	* daemon/gdm-product-slave.c: (setup_server):
	* daemon/gdm-simple-slave.c: (setup_server), (run_greeter),
	(idle_connect_to_display):
	Remove some unused code and make the slaves use similar code.

2007-10-29  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (run_greeter):
	* daemon/gdm-product-slave.c: (setup_server):
	* daemon/gdm-simple-slave.c: (run_greeter):
	* daemon/gdm-slave.c: (gdm_slave_whack_temp_auth_file),
	(create_temp_auth_file), (listify_hash), (get_script_environment),
	(gdm_slave_run_script):
	* daemon/gdm-slave.h:
	Move the exec_script stuff to the base class.

2007-10-29  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-server.c: (connection_filter_function):
	Don't handle object messages in filter func.

	* daemon/gdm-xdmcp-display-factory.c: (gdm_xdmcp_handle_request):
	Add debug for cookie.

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_constructor),
	(gdm_greeter_login_window_class_init),
	(gdm_greeter_login_window_init):
	Load theme in constructor so we get properties.

	* gui/simple-greeter/gdm-greeter-session.c: (toggle_login_window):
	Add debug.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(get_logged_in_pixbuf), (populate_model), (on_user_added),
	(on_user_is_logged_in_changed), (name_cell_data_func),
	(check_cell_data_func), (gdm_user_chooser_widget_init):
	* gui/simple-greeter/gdm-user-manager.c: (reload_passwd),
	(gdm_user_manager_class_init):
	* gui/simple-greeter/gdm-user-manager.h:
	* gui/simple-greeter/gdm-user-private.h:
	* gui/simple-greeter/gdm-user.c: (gdm_user_get_property),
	(gdm_user_class_init), (gdm_user_init), (gdm_user_is_logged_in),
	(render_icon_from_home):
	* gui/simple-greeter/gdm-user.h:
	Add some baseline stuff for getting logged in status.
	Add a new pixbuf column to show a checkmark for logged in users.
	Also nicely serves as a way to indent the userlist.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c: (clear_selection),
	(gdm_user_chooser_widget_set_chosen_user_name), (on_row_activated):
	Clear the selection after a user is chosen

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c: (on_user_removed):
	* gui/simple-greeter/gdm-user.h:
	Remove deleted users from the model

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(get_pixbuf_for_user), (on_user_added):
	* gui/simple-greeter/gdm-user.c: (check_user_file),
	(render_icon_from_home), (gdm_user_render_icon):
	Add loading face images.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode),
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_init):
	Spread the buttons in user-select mode.  Add some padding
	to the pixbuf column.  Make a bit less transparent.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Use a horizontal button style.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_size_request):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Set the default width of the login window.  Tweak
	some spacing.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user), (run_greeter):
	* daemon/gdm-greeter-server.c: (handle_begin_verification),
	(handle_begin_verification_for_user),
	(greeter_handle_child_message), (do_introspect),
	(gdm_greeter_server_class_init):
	* daemon/gdm-greeter-server.h:
	* daemon/gdm-product-slave.c: (on_relay_begin_verification),
	(on_relay_begin_verification_for_user), (connect_to_session_relay):
	* daemon/gdm-session-relay.c:
	(gdm_session_relay_begin_verification),
	(gdm_session_relay_begin_verification_for_user):
	* daemon/gdm-session-relay.h:
	* daemon/gdm-simple-slave.c: (on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user), (run_greeter):
	* gui/simple-greeter/gdm-greeter-client.c:
	(gdm_greeter_client_call_begin_verification),
	(gdm_greeter_client_call_begin_verification_for_user):
	* gui/simple-greeter/gdm-greeter-client.h:
	* gui/simple-greeter/gdm-greeter-login-window.c: (on_user_chosen),
	(gdm_greeter_login_window_class_init):
	* gui/simple-greeter/gdm-greeter-login-window.h:
	* gui/simple-greeter/gdm-greeter-session.c:
	(on_begin_verification), (on_begin_verification_for_user),
	(toggle_login_window):
	* gui/simple-greeter/gdm-user-chooser-widget.c: (populate_model),
	(user_visible_cb):
	* gui/simple-greeter/gdm-user-chooser-widget.h:
	Add a begin-verification-for-user.  Make clicking other
	start begin-verification to bring up a username prompt.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c: (activate_name),
	(gdm_user_chooser_widget_dispose), (populate_model),
	(gdm_user_chooser_widget_init), (gdm_user_chooser_widget_finalize):
	Remove some unneeded code.  Populate the model in an idle.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-user-chooser-dialog.c:
	(gdm_user_chooser_dialog_init):
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_set_show_other_user),
	(gdm_user_chooser_widget_set_show_guest_user), (populate_model),
	(compare_user_names), (on_user_added), (user_visible_cb):
	* gui/simple-greeter/gdm-user-chooser-widget.h:
	Add guest/other "special" items to user list.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/gdm-product-slave.c: (slave_open_ck_session),
	(setup_session_environment), (gdm_product_slave_init):
	Register CK session for product slave.  Boy we have
	to do something about this divergence problem...

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode):
	Unexpand the userlist when asking for the password.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(add_user_to_model), (compare_user), (on_user_added),
	(name_cell_data_func), (gdm_user_chooser_widget_init):
	Add some support for logged in status.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c: (send_dbus_string_method),
	(send_dbus_int_method), (send_user_verified),
	(send_startup_failed), (send_session_exited), (send_session_died),
	(send_username_changed), (send_user_verification_error),
	(send_session_started), (send_question_method),
	(gdm_session_worker_ask_question),
	(gdm_session_worker_ask_for_secret),
	(gdm_session_worker_report_info),
	(gdm_session_worker_report_problem),
	(gdm_session_worker_process_pam_message),
	(gdm_session_worker_pam_new_messages_handler),
	(on_set_environment_variable), (on_start_program),
	(on_begin_verification), (on_begin_verification_for_user),
	(worker_dbus_handle_message), (worker_dbus_filter_function),
	(gdm_session_worker_constructor):
	* daemon/gdm-session.c: (cancel_pending_query),
	(handle_connection), (gdm_session_close):
	* daemon/session-worker-main.c: (signal_cb):
	Make the authentication cancellation much more robust.
	Remove dbus-glib from session-worker.  Fix some problems
	with message handling in the session server.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Fix cancel stock icon.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-simple-slave.c: (on_session_started):
	Remove rogue (ie. undefined) signals.  Caught with
	assertions.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-common.c: (gdm_set_fatal_warnings_if_unstable):
	* common/gdm-common.h:
	* daemon/factory-slave-main.c: (main):
	* daemon/main.c: (main):
	* daemon/product-slave-main.c: (main):
	* daemon/simple-slave-main.c: (main):
	* gui/simple-greeter/greeter-main.c: (main):
	Use assertions for criticals everywhere for unstable
	builds.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode):
	Hide shutdown/restart/suspend buttons on remote displays.
	Can't see ever allowing this.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (do_cancel),
	(reset_dialog):
	Clear selected user when resetting dialog

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-client.c:
	(gdm_greeter_client_class_init):
	Fix typo in signal definition.  Thanks to assertion
	this was easy to find.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-simple-slave.c: (on_greeter_cancel):
	Make sure to set display_is_local

2007-10-26  Ray Strode  <rstrode@redhat.com>

	Get things working with pam_console again

	* daemon/gdm-server.c: (_gdm_server_query_ck_for_display_device),
	(gdm_server_get_display_device): cache display tty instead of
	invoking ck-get-x11-display-device each time.  Add new
	display-device property.

	* daemon/gdm-session-worker.c (_get_tty_for_pam),
	(gdm_session_worker_initialize_pam):
	use display name or tty depending on os

	* daemon/gdm-simple-slave.c (on_greeter_cancel),
	(on_greeter_connected):  don't hard code "/dev/console" for display
	device.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode):
	Make sure the default button is set.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (do_cancel),
	(on_user_chosen), (gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-user-chooser-dialog.c:
	(gdm_user_chooser_dialog_get_chosen_user_name),
	(gdm_user_chooser_dialog_init):
	* gui/simple-greeter/gdm-user-chooser-dialog.h:
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_set_show_only_chosen),
	(gdm_user_chooser_widget_get_chosen_user_name), (activate_name),
	(choose_user_id), (choose_selected_user),
	(gdm_user_chooser_widget_set_chosen_user_name),
	(gdm_user_chooser_widget_dispose),
	(gdm_user_chooser_widget_class_init), (on_selection_changed),
	(on_row_activated), (add_user_to_model), (on_user_added),
	(user_visible_cb), (gdm_user_chooser_widget_init):
	* gui/simple-greeter/gdm-user-chooser-widget.h:
	* gui/simple-greeter/test-user-chooser.c: (main):
	Hide other users when one is chosen.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode),
	(do_cancel), (reset_dialog), (on_user_activated), (load_theme),
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Get rid of notebook.  Put auth prompt box in main page.
	Make visible on demand and hope to animate at some point.
	Also a few spacing tweaks.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-signal-handler.c: (gdm_signal_handler_init),
	(gdm_signal_handler_finalize): only call signal_list_free on
	elements in signal lookup hash table, when the hash table is about
	to be destroyed. Previously, signal_list_free was set up as the
	value destroy notifier.  The problem is the destroy notifier gets
	called on every g_hash_table_insert call (well except for the
	first one), so the list being appended to/reinserted was getting
	clobbered.

	Patch from: Ray Strode <halfline@gmail.com>

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-manager.c:
	Add locale.h to fix build
	Patch from: Ray Strode <halfline@gmail.com>

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-session.c: (toggle_panel),
	(start_settings_daemon):
	Use new gdm-settings-daemon.  Disable panel for now.

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/settings-daemon/plugins/xsettings/Makefile.am:
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-manager.c:
	(translate_bool_int), (translate_int_int),
	(translate_string_string), (translate_string_string_toolbar),
	(dpi_from_pixels_and_mm), (get_dpi_from_x_server),
	(get_dpi_from_gconf_or_x_server), (xft_settings_get),
	(xft_settings_set_xsettings), (write_all), (child_watch_cb),
	(spawn_with_input), (xft_settings_set_xresources),
	(update_xft_settings), (xft_callback), (type_to_string),
	(process_value), (gdm_xsettings_manager_start),
	(gdm_xsettings_manager_stop), (gdm_xsettings_manager_set_property),
	(gdm_xsettings_manager_get_property),
	(gdm_xsettings_manager_constructor),
	(gdm_xsettings_manager_dispose),
	(gdm_xsettings_manager_class_init), (find_translation_entry),
	(xsettings_callback), (register_config_callback), (terminate_cb),
	(gdm_xsettings_manager_init), (gdm_xsettings_manager_finalize),
	(gdm_xsettings_manager_new):
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-manager.h:
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-plugin.c:
	(gdm_xsettings_plugin_init), (gdm_xsettings_plugin_finalize),
	(impl_activate), (impl_deactivate),
	(gdm_xsettings_plugin_class_init):
	* gui/settings-daemon/plugins/xsettings/xsettings-common.c:
	(xsettings_setting_copy), (xsettings_list_copy),
	(xsettings_setting_equal), (xsettings_setting_free),
	(xsettings_list_free), (xsettings_list_insert),
	(xsettings_list_delete), (xsettings_list_lookup),
	(xsettings_byte_order):
	* gui/settings-daemon/plugins/xsettings/xsettings-common.h:
	* gui/settings-daemon/plugins/xsettings/xsettings-manager.c:
	(timestamp_predicate), (get_server_time),
	(xsettings_manager_check_running), (xsettings_manager_new),
	(xsettings_manager_destroy), (xsettings_manager_get_window),
	(xsettings_manager_process_event),
	(xsettings_manager_delete_setting),
	(xsettings_manager_set_setting), (xsettings_manager_set_int),
	(xsettings_manager_set_string), (xsettings_manager_set_color),
	(setting_length), (setting_store), (xsettings_manager_notify):
	* gui/settings-daemon/plugins/xsettings/xsettings-manager.h:
	Add an xsettings manager.

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-manager.c (gdm_user_manager_init):
	Convert criticals to warnings.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/settings-daemon/Makefile.am:
	* gui/settings-daemon/plugins/xsettings/Makefile.am:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/libnotificationarea/Makefile.am:
	OMFG - I hate you.  Add gmodule to SETTINGS_DAEMON modules so we don't get:
	undefined symbol: gdm_settings_plugin_get_type
	Twiddled some other crap during the screaming.

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/settings-daemon/Makefile.am:
	* gui/settings-daemon/gdm-settings-manager.c:
	(gdm_settings_manager_start), (gdm_settings_manager_stop),
	(gdm_settings_manager_dispose), (gdm_settings_manager_init):
	* gui/settings-daemon/gdm-settings-module.c:
	(gdm_settings_module_load), (gdm_settings_module_unload),
	(gdm_settings_module_get_path), (gdm_settings_module_new_object),
	(gdm_settings_module_init), (gdm_settings_module_finalize),
	(gdm_settings_module_class_init), (gdm_settings_module_new):
	* gui/settings-daemon/gdm-settings-module.h:
	* gui/settings-daemon/gdm-settings-plugin.c: (dummy),
	(gdm_settings_plugin_class_init), (gdm_settings_plugin_init),
	(gdm_settings_plugin_activate), (gdm_settings_plugin_deactivate):
	* gui/settings-daemon/gdm-settings-plugin.h:
	* gui/settings-daemon/gdm-settings-plugins-engine.c:
	(gdm_settings_plugin_info_free),
	(gdm_settings_plugins_engine_load), (compare_plugin_info),
	(gdm_settings_plugins_engine_load_dir),
	(gdm_settings_plugins_engine_load_all),
	(gdm_settings_plugins_engine_init),
	(gdm_settings_plugins_engine_garbage_collect),
	(gdm_settings_plugins_engine_shutdown),
	(gdm_settings_plugins_engine_get_plugins_list),
	(load_plugin_module),
	(gdm_settings_plugins_engine_activate_plugin_real),
	(gdm_settings_plugins_engine_activate_plugin),
	(gdm_settings_plugins_engine_deactivate_plugin_real),
	(gdm_settings_plugins_engine_deactivate_plugin),
	(gdm_settings_plugins_engine_plugin_is_active),
	(gdm_settings_plugins_engine_plugin_is_available),
	(reactivate_all), (gdm_settings_plugins_engine_activate_all),
	(gdm_settings_plugins_engine_get_plugin_name),
	(gdm_settings_plugins_engine_get_plugin_description),
	(gdm_settings_plugins_engine_get_plugin_authors),
	(gdm_settings_plugins_engine_get_plugin_website),
	(gdm_settings_plugins_engine_get_plugin_copyright):
	* gui/settings-daemon/gdm-settings-plugins-engine.h:
	* gui/settings-daemon/main.c: (main):
	* gui/settings-daemon/plugins/Makefile.am:
	* gui/settings-daemon/plugins/xsettings/Makefile.am:
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-plugin.c:
	(gdm_xsettings_plugin_init), (gdm_xsettings_plugin_finalize),
	(impl_activate), (impl_deactivate),
	(gdm_xsettings_plugin_class_init):
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-plugin.h:
	* gui/settings-daemon/plugins/xsettings/xsettings.gdm-settings-plug
	in.desktop.in:
	Add a stub for xsettings plugin.

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* gui/settings-daemon/Makefile.am:
	* gui/settings-daemon/gdm-settings-manager.c:
	(gdm_settings_manager_start), (gdm_settings_manager_stop),
	(gdm_settings_manager_set_property),
	(gdm_settings_manager_get_property),
	(gdm_settings_manager_constructor), (gdm_settings_manager_dispose),
	(gdm_settings_manager_class_init), (gdm_settings_manager_init),
	(gdm_settings_manager_finalize), (gdm_settings_manager_new):
	* gui/settings-daemon/gdm-settings-manager.h:
	* gui/settings-daemon/main.c: (main):
	Add stub for settings manager class.

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/Makefile.am:
	* gui/settings-daemon/Makefile.am:
	* gui/settings-daemon/main.c: (main):
	* gui/simple-chooser/Makefile.am:
	Add a stub for settings-daemon.

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/greeter-main.c (set_fatal_warnings):
	Change to abort on criticals not just warnings.

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-session.c:
	(gdm_greeter_session_init):
	* gui/simple-greeter/gdm-session-client.c:
	(gdm_session_client_start), (gdm_session_client_stop):
	* gui/simple-greeter/gdm-session-manager.c:
	(gdm_session_manager_load_autostart_dir),
	(gdm_session_manager_load_system_dirs), (_change_level):
	* gui/simple-greeter/gdm-session-manager.h:
	* gui/simple-greeter/greeter-main.c: (assistive_registry_launch):
	Add autostart for LoginWindow greeter session levels.

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-marshal.list:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-session.c: (toggle_panel),
	(toggle_login_window), (toggle_all_levels),
	(gdm_greeter_session_start), (gdm_greeter_session_init):
	* gui/simple-greeter/gdm-session-client.c:
	(gdm_session_client_start), (gdm_session_client_stop),
	(_gdm_session_client_set_desktop_file),
	(gdm_session_client_set_property),
	(gdm_session_client_get_property), (load_from_desktop_file),
	(gdm_session_client_constructor), (gdm_session_client_dispose),
	(gdm_session_client_class_init), (gdm_session_client_init),
	(gdm_session_client_finalize), (gdm_session_client_new),
	(gdm_session_client_new_from_desktop_file):
	* gui/simple-greeter/gdm-session-client.h:
	* gui/simple-greeter/gdm-session-manager.c: (notify_data_free),
	(add_notify_for_level), (get_next_notify_id),
	(gdm_session_manager_add_notify), (add_client_to_level),
	(gdm_session_manager_add_client),
	(gdm_session_manager_load_autostart_dir),
	(gdm_session_manager_get_level), (_change_level),
	(gdm_session_manager_set_level), (gdm_session_manager_class_init),
	(gdm_session_manager_init):
	* gui/simple-greeter/gdm-session-manager.h:
	Use new session level based system.  Start/stop widgets
	on level transitions.

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-autostart-manager.c:
	* gui/simple-greeter/gdm-autostart-manager.h:
	* gui/simple-greeter/gdm-session-manager.c:
	(gdm_session_manager_start), (gdm_session_manager_init):
	* gui/simple-greeter/gdm-session-manager.h:
	* gui/simple-greeter/gdm-user.c: (gdm_user_set_property),
	(gdm_user_get_property):
	More stubbing.

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-autostart-manager.c:
	(gdm_session_manager_start), (gdm_session_manager_stop),
	(gdm_session_manager_set_property),
	(gdm_session_manager_get_property),
	(gdm_session_manager_constructor), (gdm_session_manager_dispose),
	(gdm_session_manager_class_init), (gdm_session_manager_init),
	(gdm_session_manager_finalize), (gdm_session_manager_new):
	* gui/simple-greeter/gdm-autostart-manager.h:
	Add stub for session manager.

2007-10-24  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-slave.c:
	* daemon/gdm-session-record.c:
	* daemon/gdm-xdmcp-display-factory.c: cast size_t values
	to int before passing to g_debug, to stop warnings on 64-bit

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* Makefile.am:
	* configure.ac:
	* gui/simple-greeter/Makefile.am:
	* libgreeter/Makefile.am:
	* libgreeter/gdm-greeter.c:
	* libgreeter/gdm-greeter.h:
	Remove libgreeter stuff.

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-background.c:
	(gdm_greeter_background_real_map), (gdm_greeter_background_init):
	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-session.c:
	(start_settings_daemon), (gdm_greeter_session_set_level):
	* gui/simple-greeter/greeter-main.c: (assistive_registry_launch),
	(filter_watch), (filter_timeout), (assistive_registry_start),
	(at_set_gtk_modules), (main):
	Start atspi-registryd and xsettings manager.

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (show_widget),
	(switch_page), (load_theme), (gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	* gui/simple-greeter/test-greeter-login-window.c: (main):
	Add some more buttons.  Toggle button visibility per page.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(get_system_version):
	Add support for other systems.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-login-window.c: (update_clock),
	(set_clock_timeout), (update_clock_timeout_cb),
	(remove_clock_timeout), (on_computer_info_label_button_press),
	(file_read_one_line), (get_system_version), (get_time_format),
	(create_computer_info), (load_theme),
	(gdm_greeter_login_window_init),
	(gdm_greeter_login_window_finalize):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Add a computer information widget.  Displays info about
	name, version, ip, network-status, and time.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (set_focus),
	(gdm_greeter_login_window_info_query):
	Fix a warning - only set focus if realized

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-session.c: (start_login_window):
	Oops.  Don't send NULL userdata.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (set_busy),
	(set_ready), (set_focus), (load_theme),
	(gdm_greeter_login_window_size_request),
	(gdm_greeter_login_window_constructor),
	(gdm_greeter_login_window_class_init),
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Only use first child of glade window.
	Set the default window height to be .6 of screen height.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/test-greeter-login-window.c: (main):
	Add a test for login window.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-client.c:
	(gdm_greeter_client_get_display_is_local), (cache_display_values),
	(gdm_greeter_client_start), (gdm_greeter_client_class_init):
	* gui/simple-greeter/gdm-greeter-client.h:
	* gui/simple-greeter/gdm-greeter-login-window.c: (set_busy),
	(set_ready), (set_sensitive), (set_focus), (set_message),
	(switch_page), (do_cancel), (reset_dialog),
	(gdm_greeter_login_window_ready), (gdm_greeter_login_window_reset),
	(gdm_greeter_login_window_info),
	(gdm_greeter_login_window_problem),
	(gdm_greeter_login_window_info_query),
	(gdm_greeter_login_window_secret_info_query),
	(_gdm_greeter_login_window_set_display_is_local),
	(gdm_greeter_login_window_set_property),
	(gdm_greeter_login_window_get_property), (log_in_button_clicked),
	(cancel_button_clicked), (on_user_activated), (create_greeter),
	(gdm_greeter_login_window_constructor),
	(gdm_greeter_login_window_class_init),
	(gdm_greeter_login_window_init),
	(gdm_greeter_login_window_finalize),
	(gdm_greeter_login_window_new):
	* gui/simple-greeter/gdm-greeter-login-window.h:
	* gui/simple-greeter/gdm-greeter-session.c: (on_info),
	(on_problem), (on_ready), (on_reset), (on_info_query),
	(on_secret_info_query), (on_begin_verification), (on_query_answer),
	(on_select_session), (on_select_language), (on_select_user),
	(on_select_hostname), (on_cancelled), (on_disconnected),
	(start_login_window), (stop_login_window), (launch_compiz),
	(launch_metacity), (start_panel), (start_background),
	(start_window_manager), (gdm_greeter_session_set_level),
	(gdm_greeter_session_goto_level), (gdm_greeter_session_start),
	(gdm_greeter_session_init):
	* gui/simple-greeter/gdm-simple-greeter.c:
	* gui/simple-greeter/gdm-simple-greeter.glade:
	* gui/simple-greeter/gdm-simple-greeter.h:
	* gui/simple-greeter/greeter-main.c: (set_fatal_warnings), (main):
	More refactoring.  Change gdm-greeter.c to be just a window.
	Make greeter warnings fatal in development releases.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-server.h:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-client.c:
	(gdm_greeter_client_error_quark), (on_info), (on_problem),
	(on_ready), (on_reset), (on_info_query), (on_secret_info_query),
	(gdm_greeter_client_call_begin_verification),
	(gdm_greeter_client_call_answer_query),
	(gdm_greeter_client_call_select_session),
	(gdm_greeter_client_call_select_language),
	(gdm_greeter_client_call_select_user),
	(gdm_greeter_client_call_select_hostname),
	(gdm_greeter_client_call_cancel),
	(gdm_greeter_client_call_disconnect),
	(gdm_greeter_client_call_get_display_id), (proxy_destroyed),
	(gdm_greeter_client_start), (gdm_greeter_client_stop),
	(gdm_greeter_client_set_property),
	(gdm_greeter_client_get_property),
	(gdm_greeter_client_constructor), (gdm_greeter_client_dispose),
	(gdm_greeter_client_class_init), (gdm_greeter_client_init),
	(gdm_greeter_client_finalize), (gdm_greeter_client_new):
	* gui/simple-greeter/gdm-greeter-client.h:
	* gui/simple-greeter/gdm-greeter-session.c: (on_info),
	(on_problem), (on_ready), (on_reset), (on_info_query),
	(on_secret_info_query), (on_begin_verification), (on_query_answer),
	(on_select_session), (on_select_language), (on_select_user),
	(on_select_hostname), (on_cancelled), (on_disconnected),
	(start_login_window), (gdm_greeter_session_set_level),
	(gdm_greeter_session_start), (gdm_greeter_session_stop),
	(gdm_greeter_session_set_property),
	(gdm_greeter_session_get_property),
	(gdm_greeter_session_constructor), (gdm_greeter_session_dispose),
	(gdm_greeter_session_class_init), (gdm_greeter_session_init),
	(gdm_greeter_session_finalize), (gdm_greeter_session_new):
	* gui/simple-greeter/gdm-greeter-session.h:
	* gui/simple-greeter/gdm-user-manager.c: (gdm_user_manager_init):
	* gui/simple-greeter/greeter-main.c: (main):
	Refactor some of the greeter.  Break DBus client into new class.
	Create a GdmGreeterSession that will run external apps.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-common.c: (gdm_signal_pid):
	* common/gdm-common.h:
	* daemon/Makefile.am:
	* daemon/gdm-greeter-session.c: (spawn_child_setup),
	(stop_dbus_daemon), (gdm_greeter_session_stop):
	* daemon/gdm-server.c: (gdm_server_stop):
	* daemon/gdm-session-worker-job.c: (gdm_session_worker_job_stop):
	* daemon/gdm-slave-proxy.c: (kill_slave):
	* gui/simple-greeter/gdm-simple-greeter.c: (set_sensitive),
	(set_focus), (reset_dialog), (gdm_simple_greeter_info_query),
	(gdm_simple_greeter_secret_info_query), (log_in_button_clicked),
	(create_greeter), (gdm_simple_greeter_init):
	* gui/simple-greeter/gdm-simple-greeter.glade:
	Rework the dialog design a bit.

2007-10-18  Brian Cameron  <brian.cameron@sun.com>

	* daemon/gdm-session-record.c: Some trivial fixes.  The #ifdef
	  GETUTXENT got lost in the logout function.  It should match the
	  login function.  Also make sure to set both tv_sec and tv_usec when
	  doing logout.

2007-10-19  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-common.c: (gdm_signal_pid):
	* common/gdm-common.h:
	* daemon/Makefile.am:
	* daemon/gdm-greeter-session.c: (spawn_child_setup),
	(stop_dbus_daemon), (gdm_greeter_session_stop):
	* daemon/gdm-server.c: (gdm_server_stop):
	* daemon/gdm-session-worker-job.c: (gdm_session_worker_job_stop):
	* daemon/gdm-slave-proxy.c: (kill_slave):
	Move the signal_pid func to common.  Make the greeter process
	a session leader.  Signal greeter and dbus process groups instead
	of just the individual processes so that we clean up the entire greeter
	session.

2007-10-19  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-signal-handler.c: (signal_io_watch), (catch_signal),
	(uncatch_signal), (gdm_signal_handler_add), (callback_data_free),
	(gdm_signal_handler_remove_and_free_data),
	(gdm_signal_handler_remove), (find_callback_data_by_func),
	(gdm_signal_handler_remove_func), (signal_list_free),
	(gdm_signal_handler_init), (gdm_signal_handler_finalize):
	* common/gdm-signal-handler.h:
	* daemon/gdm-server.c: (add_ready_handler), (remove_ready_handler),
	(gdm_server_spawn), (gdm_server_init), (gdm_server_finalize):
	Assign ids to signal handlers.  Add functions to remove handlers.
	Restore sigaction when no handlers are present.  Fix some
	memory management bugs.

2007-10-18  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-record.c: (record_set_username),
	(record_set_timestamp), (record_set_pid), (record_set_id),
	(record_set_host), (record_set_line), (gdm_session_record_login),
	(gdm_session_record_logout), (gdm_session_record_failed):
	* daemon/gdm-session-record.h:
	* daemon/gdm-session.c:
	(gdm_session_user_verification_error_handler),
	(gdm_session_started_handler), (gdm_session_startup_error_handler),
	(gdm_session_exited_handler), (gdm_session_close):
	Try to reduce the complexity of the utmp/wtmp recording code.

2007-10-18  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am (test_session_SOURCES): Add file.

	* daemon/gdm-session-record.c (gdm_session_write_record):
	Make username const.
	(gdm_session_record_write): not static.

2007-10-18  William Jon McCann  <mccannwj@acsnb1>

	* daemon/gdm-session.c:
	(gdm_session_user_verification_error_handler),
	(gdm_session_started_handler), (gdm_session_startup_error_handler),
	(gdm_session_exited_handler), (gdm_session_close):
	Fix missed stuff.

2007-10-18  William Jon McCann  <mccannwj@acsnb1>

	* daemon/Makefile.am:
	* daemon/gdm-session-record.c: (gdm_session_write_record):
	* daemon/gdm-session-record.h:
	* daemon/gdm-session.c:
	(gdm_session_user_verification_error_handler),
	(gdm_session_started_handler), (gdm_session_startup_error_handler),
	(gdm_session_exited_handler), (gdm_session_close):
	Separate session recording writing stuff.

2007-10-18  Brian Cameron  <brian.cameron@sun.com>

	* daemon/gdm-slave.c:  Add signal.h include.

2007-10-18  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/gdm-session.c: (gdm_session_write_record):
	Make previous patch build on linux.

2007-10-18  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/gdm-session.c: (gdm_session_write_record):
	Merge changes from 2.20 branch to fix utmp/wtmp handling.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-10-18  William Jon McCann  <mccann@jhu.edu>

	* HACKING: Futz with the order.

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-md5.c: (gdm_md5_final):
	* common/gdm-settings-backend.c:
	* common/gdm-signal-handler.c: (gdm_signal_handler_init):
	* common/test-settings-client.c: (test_settings_client):
	* configure.ac:
	* daemon/gdm-factory-slave.c:
	* daemon/gdm-greeter-session.c: (gdm_greeter_session_spawn):
	* daemon/gdm-local-display-factory.c:
	* daemon/gdm-manager.c:
	* daemon/gdm-product-slave.c:
	* daemon/gdm-session-relay.c: (session_handle_child_message):
	* daemon/gdm-session.c: (handle_connection):
	* daemon/gdm-simple-slave.c:
	* daemon/gdm-xdmcp-display-factory.c:
	* daemon/main.c: (main):
	* daemon/session-worker-main.c: (main):
	* gui/simple-chooser/gdm-host-chooser-dialog.c: (on_response):
	* gui/simple-chooser/gdm-host-chooser-widget.c:
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(languages_parse_start_tag), (territories_parse_start_tag):
	* gui/simple-greeter/gdm-simple-greeter.c:
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_init):
	* gui/simple-greeter/greeter-main.c: (activate_power_manager):
	* gui/simple-greeter/test-user-manager.c: (main):
	Fix a bunch of compiler warnings.  Add Werror for now to
	warning flags.

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/fstype.c:
	Remove unused file.

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* HACKING:
	* README:
	Add some more info.

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* HACKING:
	Add hacking guidelines.

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* MAINTAINERS:
	Add Brian.
	* configure.ac:
	Set version to 2.21.1.  Change bugzilla product.

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-address.c: (gdm_address_new_from_sockaddr),
	(gdm_address_peek_local_list):
	* common/gdm-address.h:
	* daemon/gdm-xdmcp-display-factory.c: (do_bind),
	(create_address_from_request), (decode_packet):
	* gui/simple-chooser/gdm-host-chooser-widget.c: (decode_packet),
	(find_broadcast_addresses), (add_hosts):
	The function gdm_address_new_from_sockaddr_storage gets called in a
	few places with socket addresses that aren't necessary
	sockaddr_storage bytes big (all the places that call getaddrinfo).
	This results in the memdup call in that function potentially copying
	out of bounds bytes.
	Patch from: Ray Strode <halfline@gmail.com>

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-background.c (update_background):
	Don't crash if background pattern can't be loaded.
	Patch from: Ray Strode <halfline@gmail.com>

2007-10-11  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-marshal.list:
	* daemon/gdm-product-slave.c: (reset_session), (on_relay_open):
	* daemon/gdm-session-worker.c: (gdm_session_worker_initialize_pam),
	(gdm_session_worker_verify_user), (gdm_session_worker_open),
	(open_idle), (queue_open), (on_begin_verification),
	(on_begin_verification_for_user), (gdm_session_worker_constructor):
	* daemon/gdm-session.c: (gdm_session_write_record),
	(do_introspect), (gdm_session_open), (send_begin_verification),
	(send_begin_verification_for_user):
	* daemon/gdm-session.h:
	* daemon/gdm-simple-slave.c: (on_greeter_cancel),
	(on_greeter_connected):
	* daemon/test-session.c: (main):
	Also pass x11-display when opening the session.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-10-10  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-server.c:
	Add include.

2007-10-09  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/Makefile.am:
	* daemon/main.c:
	* gui/simple-greeter/gdm-user-manager.c:
	Some build fixes for Solaris.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-10-05  William Jon McCann  <mccann@jhu.edu>

	* MAINTAINERS:
	Add name.

2007-10-05  William Jon McCann  <mccann@jhu.edu>

	* AUTHORS:
	Add Ray.

2007-10-05  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-simple-greeter.c: (launch_compiz),
	(launch_metacity), (create_greeter):
	Try to launch compiz or fallback to metacity.
	The test isn't a good one.

2007-10-05  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-background.c:
	(cairo_surface_get_width), (cairo_surface_get_height),
	(update_surface), (load_image), (update_background),
	(gdm_greeter_background_move_resize_window), (get_outside_region),
	(get_monitor_geometry), (update_geometry),
	(gdm_greeter_background_real_size_request),
	(gdm_greeter_background_real_expose),
	(gdm_greeter_background_real_configure),
	(gdm_greeter_background_class_init):
	* gui/simple-greeter/gdm-greeter-panel.c: (gdm_greeter_panel_init):
	* gui/simple-greeter/gdm-simple-greeter.c: (create_greeter):
	Make the background window sizing more robust.  And a little
	more efficient.  Also add some tranparency to the windows
	when running under a compositor.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* daemon/main.c: (set_effective_user), (set_effective_group),
	(set_effective_user_group), (gdm_daemon_check_permissions):
	Set euid to 0 before setting egid so it can succeed.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* AUTHORS:
	Add myself.

	* AUTHORS.pre-3.0:
	* ChangeLog.pre-3.0:
	* HACKING.pre-3.0:
	* MAINTAINERS.pre-3.0:
	* NEWS.pre-3.0:
	* README.pre-3.0:
	* TODO.pre-3.0:
	Remove obsolete files.

	* daemon/gdm-session.c:
	* daemon/gdm-session.h:
	* daemon/gdm-xdmcp-display-factory.h:
	Update copyright notices.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-common-unknown-origin.c: (gdm_safe_fopen_w):
	* common/gdm-common-unknown-origin.h:
	* common/gdm-common.c:
	* configure.ac:
	* daemon/gdm-slave.c: (gdm_slave_connect_to_x11_display):
	* daemon/gdm-xdmcp-display-factory.c:
	(gdm_xdmcp_handle_indirect_query),
	(gdm_xdmcp_handle_managed_forward):
	* daemon/main.c: (main_restoreenv), (gdm_restart_now),
	(check_logdir), (check_servauthdir), (set_effective_user_group),
	(gdm_daemon_check_permissions), (gdm_daemon_change_user), (main):
	Remove some more obsolete stuff.  Make distcheck happy.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* Makefile.am (SUBDIRS):
	* docs/C/.cvsignore:
	* docs/C/gdm.xml:
	* docs/C/legal.xml:
	* docs/C/make-and-upload.sh:
	* docs/Makefile.am:
	* docs/de/.cvsignore:
	* docs/de/Makefile.am:
	* docs/de/gdm-de.omf:
	* docs/de/gdm.xml:
	* docs/de/legal.xml:
	* docs/en_GB/Makefile.am:
	* docs/en_GB/en_GB.po:
	* docs/es/.cvsignore:
	* docs/es/Makefile.am:
	* docs/es/es.po:
	* docs/es/gdm-es.omf:
	* docs/es/gdm.xml:
	* docs/es/legal.xml:
	* docs/fr/.cvsignore:
	* docs/fr/Makefile.am:
	* docs/fr/gdm-fr.omf:
	* docs/fr/gdm.xml:
	* docs/fr/legal.xml:
	* docs/gdm.1:
	* docs/gdm.omf.in:
	* docs/it/.cvsignore:
	* docs/it/Makefile.am:
	* docs/it/gdm-it.omf:
	* docs/it/gdm.xml:
	* docs/it/legal.xml:
	* docs/ja/.cvsignore:
	* docs/ja/Makefile.am:
	* docs/ja/gdm-ja.omf:
	* docs/ja/gdm.xml:
	* docs/ja/legal.xml:
	* docs/ko/.cvsignore:
	* docs/ko/ko.po:
	* docs/sv/.cvsignore:
	* docs/sv/Makefile.am:
	* docs/sv/sv.po:
	* docs/uk/.cvsignore:
	* docs/uk/Makefile.am:
	* docs/uk/gdm-uk.omf:
	* docs/uk/gdm.xml:
	* docs/uk/legal.xml:
	* docs/uk/uk.po:
	* docs/zh_CN/.cvsignore:
	* docs/zh_CN/Makefile.am:
	* docs/zh_CN/gdm-zh_CN.omf:
	* docs/zh_CN/gdm.xml:
	* docs/zh_CN/legal.xml:
	* docs/zh_HK/.cvsignore:
	* docs/zh_HK/Makefile.am:
	* docs/zh_HK/gdm-zh_HK.omf:
	* docs/zh_HK/gdm.xml:
	* docs/zh_HK/legal.xml:
	* docs/zh_TW/.cvsignore:
	* docs/zh_TW/Makefile.am:
	* docs/zh_TW/gdm-zh_TW.omf:
	* docs/zh_TW/gdm.xml:
	* docs/zh_TW/legal.xml:
	Remove docs since they are obsolete.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* common/Makefile.am:
	* common/gdm-common-unknown-origin.c: (gdm_sigchld_block_push),
	(gdm_sigchld_block_pop), (gdm_sigterm_block_push),
	(gdm_sigterm_block_pop), (gdm_sigusr2_block_push),
	(gdm_sigusr2_block_pop), (gdm_safe_fopen_w), (ve_clearenv):
	* common/gdm-common-unknown-origin.h:
	* common/gdm-common.c:
	* common/gdm-common.h:
	* config/Makefile.am:
	* config/XKeepsCrashing:
	* config/default.desktop.in:
	* config/extract-shell.sh:
	* config/gdmprefetchlist.in:
	* config/gettextfoo.h:
	* config/locale.alias:
	* config/ssh.desktop.in.in:
	* configure.ac:
	* daemon/Makefile.am:
	* daemon/choose.c:
	* daemon/choose.h:
	* daemon/gdm-xdmcp-display-factory.c:
	(gdm_xdmcp_handle_indirect_query), (gdm_xdmcp_handle_manage),
	(gdm_xdmcp_handle_managed_forward):
	* daemon/main.c: (delete_pid):
	* utils/Makefile.am:
	* utils/gdm-dmx-reconnect-proxy.c:
	Remove some more obsolete code.  Move common
	code with unknown copyright status into separate file.
	Try to identify more copy with unknown copyright status.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* common/Makefile.am:
	* common/gdm-common.c:
	* common/gdm-common.h:
	* common/ve-signal.c:
	* common/ve-signal.h:
	* config/Makefile.am:
	* configure.ac:
	* daemon/Makefile.am:
	* daemon/auth.c:
	* daemon/filecheck.c:
	* daemon/filecheck.h:
	* daemon/gdm-factory-slave.c: (get_script_environment):
	* daemon/gdm-greeter-session.c: (get_greeter_environment):
	* daemon/gdm-product-slave.c: (get_script_environment):
	* daemon/gdm-server.c: (rotate_logs), (server_child_setup),
	(gdm_server_start):
	* daemon/gdm-simple-slave.c: (get_script_environment):
	* daemon/gdm-xdmcp-display-factory.c: (fd_set_close_on_exec),
	(open_port), (gdm_xdmcp_handle_request), (gdm_xdmcp_handle_manage):
	* libgreeter/Makefile.am:
	* libgreeter/gdmlanguages.c:
	* libgreeter/gdmlanguages.h:
	* libgreeter/gdmsession.c:
	* libgreeter/gdmsession.h:
	* libgreeter/gdmwm.c:
	* libgreeter/gdmwm.h:
	* utils/Makefile.am:
	* utils/gdm-ssh-session:
	* utils/gdmmktemp.c:
	* utils/gdmopen.c:
	* utils/gdmprefetch.c:
	* utils/gdmsetup-pam:
	* utils/gdmsetup-security.in:
	* utils/gdmtranslate.c:
	Remove lots of obsolete code.  Organize the configure checks a bit.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* acinclude.m4:
	* common/Makefile.am:
	* configure.ac:
	* daemon/Makefile.am:
	* daemon/gdm-factory-slave.c: (run_greeter),
	(idle_connect_to_display):
	* daemon/gdm-product-slave.c: (setup_server),
	(idle_connect_to_display):
	* daemon/gdm-simple-slave.c: (run_greeter),
	(idle_connect_to_display):
	* daemon/gdm-slave.c: (gdm_slave_set_busy_cursor),
	(set_local_auth), (gdm_slave_connect_to_x11_display):
	* daemon/gdm-slave.h:
	* gui/Makefile.am:
	* gui/modules/.cvsignore:
	* gui/modules/AccessDwellMouseEvents.in:
	* gui/modules/AccessKeyMouseEvents.in:
	* gui/modules/Makefile.am:
	* gui/modules/dwellmouselistener.c:
	* gui/modules/keymouselistener.c:
	* gui/simple-chooser/Makefile.am:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/libnotificationarea/Makefile.am:
	* libgreeter/Makefile.am:
	Fix up the handling of dependencies.  Make the daemon
	only depend on x11, glib, gobject, dbus.  Move some
	things from the slaves to the base class.
	Remove the unused modules for now.

2007-10-03  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/greeter-main.c: (main):
	Init gnome-vfs.

2007-10-03  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	Also add here.

2007-10-03  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-private.h:
	Oops add file.

2007-10-03  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-user-chooser-widget.c: (populate_model),
	(on_user_added), (on_user_removed), (gdm_user_chooser_widget_init):
	* gui/simple-greeter/gdm-user-manager.c:
	(gdm_user_manager_error_quark), (gdm_user_manager_get_user),
	(listify_hash_values_hfunc), (gdm_user_manager_list_users),
	(reload_passwd), (reload_shells), (shells_monitor_cb),
	(passwd_monitor_cb), (gdm_user_manager_class_init),
	(reload_passwd_timeout), (queue_reload_passwd),
	(gdm_user_manager_init), (gdm_user_manager_finalize),
	(gdm_user_manager_ref_default):
	* gui/simple-greeter/gdm-user-manager.h:
	* gui/simple-greeter/gdm-user.c: (gdm_user_class_init),
	(gdm_user_init), (gdm_user_set_property), (gdm_user_get_property),
	(gdm_user_finalize), (_gdm_user_update), (_gdm_user_add_session),
	(_gdm_user_remove_session), (_gdm_user_icon_changed),
	(gdm_user_get_uid), (gdm_user_get_real_name),
	(gdm_user_get_user_name), (gdm_user_get_home_directory),
	(gdm_user_get_shell), (gdm_user_get_sessions),
	(gdm_user_get_n_sessions), (gdm_user_collate):
	* gui/simple-greeter/gdm-user.h:
	* gui/simple-greeter/test-user-chooser.c: (main):
	* gui/simple-greeter/test-user-manager.c: (on_user_added),
	(on_user_removed), (main):
	Add basic user monitoring.  Hook up to user-list.

2007-10-02  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (on_session_relay_info),
	(on_session_relay_problem), (on_session_relay_info_query),
	(on_session_relay_secret_info_query), (on_session_relay_opened),
	(on_session_relay_user_verified), (greeter_reset_timeout),
	(queue_greeter_reset), (on_session_relay_user_verification_error),
	(on_session_relay_disconnected),
	(on_session_relay_session_started),
	(on_greeter_begin_verification), (run_greeter),
	(gdm_factory_slave_start), (gdm_factory_slave_finalize):
	* daemon/gdm-greeter-server.c: (gdm_greeter_server_ready),
	(handle_begin_verification), (greeter_handle_child_message),
	(do_introspect), (gdm_greeter_server_class_init):
	* daemon/gdm-greeter-server.h:
	* daemon/gdm-local-display-factory.c: (create_display_for_device):
	* daemon/gdm-product-slave.c: (relay_session_opened),
	(on_session_opened), (on_session_user_verified),
	(on_session_user_verification_error), (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_relay_begin_verification),
	(create_new_session), (on_relay_cancelled),
	(connect_to_session_relay), (gdm_product_slave_start):
	* daemon/gdm-session-relay.c:
	(gdm_session_relay_begin_verification), (handle_user_verified),
	(handle_user_verification_error), (handle_opened),
	(session_handle_child_message), (do_introspect),
	(handle_connection), (gdm_session_relay_class_init):
	* daemon/gdm-session-relay.h:
	* daemon/gdm-session.c:
	* daemon/gdm-simple-slave.c: (on_session_user_verified),
	(on_session_user_verification_error), (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_session_opened),
	(create_new_session), (on_greeter_begin_verification),
	(on_greeter_user_selected), (run_greeter),
	(gdm_simple_slave_finalize):
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-simple-greeter.c: (switch_page),
	(do_cancel), (reset_dialog), (gdm_simple_greeter_ready),
	(gdm_simple_greeter_reset), (on_user_activated), (create_greeter),
	(gdm_simple_greeter_class_init):
	* gui/simple-greeter/gdm-simple-greeter.glade:
	* gui/simple-greeter/gdm-user-chooser-widget.c: (populate_model):
	* gui/simple-greeter/greeter-main.c: (on_ready),
	(on_begin_verification), (main):
	* libgreeter/gdm-greeter.c: (gdm_greeter_real_ready),
	(gdm_greeter_ready), (gdm_greeter_emit_begin_verification),
	(gdm_greeter_emit_answer_query), (gdm_greeter_class_init):
	* libgreeter/gdm-greeter.h:
	Require the greeter to call BeginVerification.  But only
	after the greeter is sent a Ready.

	Make the factory-slave report verification status.

	Audit the communication paths and apply some fixes.

	Hook up the user chooser in the greeter.  Only has dummy users.

2007-10-02  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_init):
	Oops really revert this time.

2007-10-02  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(add_user_to_model), (populate_model),
	(gdm_user_chooser_widget_init):
	Revert last commit.  Use simpler widget.
	Add tooltips and change orientation.

2007-10-02  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-icon-nav.c: (gdm_icon_nav_scroll_event),
	(gdm_icon_nav_adj_changed), (gdm_icon_nav_adj_value_changed),
	(gdm_icon_nav_scroll_step), (gdm_icon_nav_button_clicked),
	(gdm_icon_nav_start_scroll), (gdm_icon_nav_stop_scroll),
	(gdm_icon_nav_get_property), (gdm_icon_nav_set_property),
	(gdm_icon_nav_constructor), (gdm_icon_nav_class_init),
	(gdm_icon_nav_init), (gdm_icon_nav_new),
	(gdm_icon_nav_get_show_buttons), (gdm_icon_nav_set_show_buttons),
	(gdm_icon_nav_get_mode), (gdm_icon_nav_set_mode):
	* gui/simple-greeter/gdm-icon-nav.h:
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_init):
	Use a custom scrolling widget for user list.  Adapted
	from eog-thumb-nav.

2007-10-02  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	* gui/simple-greeter/gdm-session-chooser-dialog.c:
	(gdm_session_chooser_dialog_init):
	* gui/simple-greeter/gdm-session-chooser-widget.c:
	* gui/simple-greeter/gdm-simple-greeter.c: (create_greeter):
	* gui/simple-greeter/gdm-user-chooser-dialog.c:
	(gdm_user_chooser_dialog_get_current_user_name),
	(gdm_user_chooser_dialog_set_property),
	(gdm_user_chooser_dialog_get_property),
	(gdm_user_chooser_dialog_constructor),
	(gdm_user_chooser_dialog_dispose),
	(gdm_user_chooser_dialog_class_init), (on_response),
	(gdm_user_chooser_dialog_init), (gdm_user_chooser_dialog_finalize),
	(gdm_user_chooser_dialog_new):
	* gui/simple-greeter/gdm-user-chooser-dialog.h:
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(chooser_user_free),
	(gdm_user_chooser_widget_get_current_user_name), (select_name),
	(gdm_user_chooser_widget_set_current_user_name),
	(gdm_user_chooser_widget_set_property),
	(gdm_user_chooser_widget_get_property),
	(gdm_user_chooser_widget_constructor),
	(gdm_user_chooser_widget_dispose),
	(gdm_user_chooser_widget_class_init), (on_selection_changed),
	(collect_users), (on_item_activated), (add_user_to_model),
	(get_pixbuf_for_user), (populate_model), (separator_func),
	(compare_user_names), (compare_user),
	(gdm_user_chooser_widget_init), (gdm_user_chooser_widget_finalize),
	(gdm_user_chooser_widget_new):
	* gui/simple-greeter/gdm-user-chooser-widget.h:
	* gui/simple-greeter/greeter-main.c: (activate_power_manager):
	* gui/simple-greeter/test-user-chooser.c: (main):
	Add skeleton for user switcher widget.

2007-10-01  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-session-chooser-widget.c:
	(gdm_session_chooser_widget_get_current_session_name),
	(select_name), (gdm_session_chooser_widget_dispose),
	(on_session_selected), (add_session_to_model), (populate_model),
	(separator_func), (compare_session_names), (compare_session),
	(gdm_session_chooser_widget_init):
	Add some "special" targets to the list for last and default.

2007-10-01  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-session-chooser-dialog.c:
	(gdm_session_chooser_dialog_get_current_session_name),
	(gdm_session_chooser_dialog_set_property),
	(gdm_session_chooser_dialog_get_property),
	(gdm_session_chooser_dialog_constructor),
	(gdm_session_chooser_dialog_dispose),
	(gdm_session_chooser_dialog_class_init), (on_response),
	(gdm_session_chooser_dialog_init),
	(gdm_session_chooser_dialog_finalize),
	(gdm_session_chooser_dialog_new):
	* gui/simple-greeter/gdm-session-chooser-dialog.h:
	* gui/simple-greeter/gdm-session-chooser-widget.c:
	(chooser_session_free),
	(gdm_session_chooser_widget_get_current_session_name),
	(select_name),
	(gdm_session_chooser_widget_set_current_session_name),
	(gdm_session_chooser_widget_set_property),
	(gdm_session_chooser_widget_get_property),
	(gdm_session_chooser_widget_constructor),
	(gdm_session_chooser_widget_dispose),
	(gdm_session_chooser_widget_class_init), (on_session_selected),
	(get_flags_from_key_file), (load_session_file),
	(collect_sessions_from_directory),
	(collect_sessions_from_directories), (collect_sessions),
	(on_row_activated), (add_session_to_model), (populate_model),
	(gdm_session_chooser_widget_init),
	(gdm_session_chooser_widget_finalize),
	(gdm_session_chooser_widget_new):
	* gui/simple-greeter/gdm-session-chooser-widget.h:
	* gui/simple-greeter/test-session-chooser.c: (main):
	Add a basic session chooser widget.

2007-09-24  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c: (gdm_session_worker_initialize_pam):
	Also check for empty hostname strings.
	* daemon/test-session.c: (on_open):
	Don't print null strings - solaris crashes.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-09-21  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-simple-greeter.c: (create_greeter):
	Use black circle for invisible char if '*' is currently default.

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(get_lc_identification), (add_locale_to_model):
	* gui/simple-greeter/test-language-chooser.c: (main):
	Don't print null strings - solaris crashes.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-language-chooser-dialog.c:
	(gdm_language_chooser_dialog_init):
	* gui/simple-greeter/gdm-language-chooser-widget.c: (parse_locale),
	(construct_language_name), (select_name),
	(gdm_language_chooser_widget_set_current_language_name),
	(collect_locales_from_archive), (collect_locales_from_directory):
	* gui/simple-greeter/gdm-language-chooser-widget.h:
	* gui/simple-greeter/test-language-chooser.c: (main):
	Add lang setting capability and set initially to $LANG

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-language-chooser-dialog.c:
	(gdm_language_chooser_dialog_dispose):
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(gdm_language_chooser_widget_get_current_language_name):
	Get the current selection.

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-language-chooser-widget.c: (parse_locale),
	(collect_locales_from_archive), (collect_locales_from_directory),
	(add_locale_to_model):
	Properly parse a locale name using the template [language[_territory][.codeset][@modifier]].

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-session.c: (get_greeter_environment),
	(signal_pid), (spawn_child_setup),
	(spawn_command_line_sync_as_user),
	(spawn_command_line_async_as_user), (parse_value_as_integer),
	(parse_dbus_launch_output), (start_dbus_daemon),
	(stop_dbus_daemon), (gdm_greeter_session_spawn),
	(gdm_greeter_session_stop), (gdm_greeter_session_init),
	(gdm_greeter_session_finalize):
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(parse_short_name):
	Manage the lifecycle of the D-Bus session since
	the X server doesn't exit.

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session.c:
	Remove old defines

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(get_lc_identification), (collect_locales_from_archive):
	Add ifdef LC_IDENTIFICATION.

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	* gui/simple-greeter/langinfo.h:
	Remove langinfo.h and use system header.

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-chooser/Makefile.am:
	Add XDMCP_LIBS.

2007-09-18  William Jon McCann  <mccann@jhu.edu>

	* config/gdm:
	Disallow root login in pam config.

2007-09-18  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	Add the locale-related headers to fix distcheck.

2007-09-18  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-language-chooser-dialog.c:
	(gdm_language_chooser_dialog_get_current_language_name),
	(gdm_language_chooser_dialog_set_property),
	(gdm_language_chooser_dialog_get_property),
	(gdm_language_chooser_dialog_constructor),
	(gdm_language_chooser_dialog_dispose),
	(gdm_language_chooser_dialog_class_init), (on_response),
	(gdm_language_chooser_dialog_init),
	(gdm_language_chooser_dialog_finalize),
	(gdm_language_chooser_dialog_new):
	* gui/simple-greeter/gdm-language-chooser-dialog.h:
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(chooser_locale_free),
	(gdm_language_chooser_widget_get_current_language_name),
	(gdm_language_chooser_widget_set_property),
	(gdm_language_chooser_widget_get_property),
	(gdm_language_chooser_widget_constructor),
	(gdm_language_chooser_widget_dispose),
	(gdm_language_chooser_widget_class_init), (on_language_selected),
	(locale_exists), (utf8_convert), (get_lc_identification),
	(get_short_name_for_locale), (parse_short_name), (nameentcmp),
	(collect_locales_from_archive), (select_dirs),
	(collect_locales_from_directory), (collect_locales_from_aliases),
	(collect_locales), (on_row_activated), (get_translated_language),
	(get_language), (get_territory), (get_translated_territory),
	(languages_parse_start_tag), (territories_parse_start_tag),
	(languages_init), (territories_init), (add_locale_to_model),
	(populate_model), (gdm_language_chooser_widget_init),
	(gdm_language_chooser_widget_finalize),
	(gdm_language_chooser_widget_new):
	* gui/simple-greeter/gdm-language-chooser-widget.h:
	* gui/simple-greeter/langinfo.h:
	* gui/simple-greeter/libnotificationarea/Makefile.am:
	* gui/simple-greeter/locarchive.h:
	* gui/simple-greeter/test-language-chooser.c: (main):
	First shot at a language chooser widget that uses locale
	archives and iso-codes.

2007-09-13  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-background.c:
	(read_background_image_placement_from_string),
	(read_color_shading_from_string), (on_key_changed),
	(settings_init), (scale_pixbuf), (load_image), (update_background),
	(gdm_greeter_background_constructor),
	(gdm_greeter_background_dispose),
	(gdm_greeter_background_real_map),
	(gdm_greeter_background_real_realize),
	(gdm_greeter_background_real_configure),
	(gdm_greeter_background_real_expose),
	(gdm_greeter_background_class_init), (gdm_greeter_background_init):
	* gui/simple-greeter/gdm-simple-greeter.c: (create_greeter):
	* gui/simple-greeter/libbackground/*:
	* gui/simple-greeter/test-greeter-background.c: (main):
	Make background widget functional.  Will follow the
	gconf defaults in /desktop/gnome/background.  Removed
	libbackground.

2007-09-12  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-simple-greeter.c:
	Fix build

2007-09-12  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/libbackground:
	Added cut-n-paste lib.

2007-09-12  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/cutnpaste/*:
	Rename directory.
	* gui/simple-greeter/gdm-greeter-background.c:
	(gdm_greeter_background_set_property),
	(gdm_greeter_background_get_property),
	(gdm_greeter_background_constructor),
	(gdm_greeter_background_dispose),
	(gdm_greeter_background_real_map), (on_screen_size_changed),
	(gdm_greeter_background_real_realize),
	(gdm_greeter_background_real_unrealize),
	(gdm_greeter_background_class_init), (on_delete_event),
	(gdm_greeter_background_init), (gdm_greeter_background_finalize),
	(gdm_greeter_background_new):
	* gui/simple-greeter/gdm-greeter-background.h:
	* gui/simple-greeter/gdm-simple-greeter.c: (create_panel):
	Add a background widget.

2007-09-11  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-address.c: (gdm_address_is_loopback):
	Convert address to network byte order before comparison.
	Patch from Jacob Berkman <jacob@gnome.org>

2007-09-11  William Jon McCann  <mccann@jhu.edu>

	* config/gdm:
	* config/gdm-autologin:
	Update PAM config.

2007-09-11  William Jon McCann  <mccann@jhu.edu>

	* config/Makefile.am:
	* config/gnome.desktop.in.in:
	* configure.ac:
	Remove gnome-session.desktop since it is provided
	by gnome-session.

2007-09-11  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	Fix distcheck.

2007-09-10  William Jon McCann  <mccann@jhu.edu>

	* daemon/INTERNALS:
	* daemon/Makefile.am:
	* daemon/gdm-factory-slave.c: (on_greeter_start),
	(on_greeter_stop), (run_greeter), (gdm_factory_slave_stop):
	* daemon/gdm-greeter-proxy.c:
	* daemon/gdm-greeter-proxy.h:
	* daemon/gdm-greeter-session.c: (change_user),
	(greeter_session_child_setup), (open_greeter_session),
	(close_greeter_session), (get_greeter_environment),
	(gdm_slave_whack_temp_auth_file), (create_temp_auth_file),
	(greeter_session_child_watch), (gdm_greeter_session_spawn),
	(gdm_greeter_session_start), (greeter_session_died),
	(gdm_greeter_session_stop),
	(gdm_greeter_session_set_server_address),
	(_gdm_greeter_session_set_x11_display_name),
	(_gdm_greeter_session_set_x11_display_hostname),
	(_gdm_greeter_session_set_x11_display_device),
	(_gdm_greeter_session_set_x11_display_is_local),
	(_gdm_greeter_session_set_x11_authority_file),
	(_gdm_greeter_session_set_user_name),
	(_gdm_greeter_session_set_group_name),
	(gdm_greeter_session_set_property),
	(gdm_greeter_session_get_property),
	(gdm_greeter_session_constructor),
	(gdm_greeter_session_class_init), (gdm_greeter_session_init),
	(gdm_greeter_session_finalize), (gdm_greeter_session_new):
	* daemon/gdm-greeter-session.h:
	* daemon/gdm-simple-slave.c: (on_user_verified),
	(on_greeter_start), (on_greeter_stop), (run_greeter),
	(gdm_simple_slave_stop):
	* daemon/gdm-slave.c:
	Rename GdmGreeterProxy->GdmGreeterSession

2007-09-10  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-simple-greeter.c: (set_focus),
	(reset_dialog), (gdm_simple_greeter_info_query),
	(gdm_simple_greeter_secret_info_query):
	* gui/simple-greeter/gdm-simple-greeter.glade:
	* gui/simple-greeter/greeter-main.c:
	Don't auto-activate g-p-m.  Try to get focus in entry.

2007-09-08  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-server.c: (greeter_server_message_handler),
	(connection_filter_function):
	* daemon/gdm-session-relay.c: (session_relay_message_handler),
	(connection_filter_function):
	* daemon/gdm-session.c: (session_message_handler),
	(connection_filter_function):
	Don't print null strings - solaris crashes.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-09-05  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/gdm-greeter-server.c: (handle_get_display_id):
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/cutnpaste/Makefile.am:
	* gui/simple-greeter/cutnpaste/fixedtip.c: (button_press_handler),
	(expose_handler), (na_fixed_tip_class_init), (na_fixed_tip_init),
	(na_fixed_tip_position), (na_fixed_tip_parent_size_allocated),
	(na_fixed_tip_parent_screen_changed), (na_fixed_tip_new),
	(na_fixed_tip_set_markup), (na_fixed_tip_set_orientation):
	* gui/simple-greeter/cutnpaste/fixedtip.h:
	* gui/simple-greeter/cutnpaste/na-marshal.list:
	* gui/simple-greeter/cutnpaste/na-tray-manager.c:
	(na_tray_manager_init), (na_tray_manager_class_init),
	(na_tray_manager_finalize), (na_tray_manager_set_property),
	(na_tray_manager_get_property), (na_tray_manager_new),
	(na_tray_manager_plug_removed),
	(na_tray_manager_make_socket_transparent),
	(na_tray_manager_socket_exposed),
	(na_tray_manager_socket_style_set),
	(na_tray_manager_handle_dock_request), (pending_message_free),
	(na_tray_manager_handle_client_message_message_data),
	(na_tray_manager_handle_begin_message),
	(na_tray_manager_handle_cancel_message),
	(na_tray_manager_handle_client_message_opcode),
	(na_tray_manager_window_filter),
	(na_tray_manager_selection_clear_event),
	(na_tray_manager_unmanage),
	(na_tray_manager_set_orientation_property),
	(na_tray_manager_manage_screen_x11),
	(na_tray_manager_manage_screen),
	(na_tray_manager_check_running_screen_x11),
	(na_tray_manager_check_running), (na_tray_manager_get_child_title),
	(na_tray_manager_set_orientation),
	(na_tray_manager_get_orientation):
	* gui/simple-greeter/cutnpaste/na-tray-manager.h:
	* gui/simple-greeter/cutnpaste/na-tray.c: (get_tray), (tray_added),
	(tray_removed), (icon_tip_buffer_free), (icon_tip_free),
	(icon_tip_buffer_compare), (icon_tip_show_next_clicked),
	(icon_tip_show_next_timeout), (icon_tip_show_next), (message_sent),
	(message_cancelled), (update_orientation_for_messages),
	(update_size_and_orientation), (na_tray_init),
	(na_tray_constructor), (na_tray_dispose), (na_tray_set_property),
	(na_tray_size_request), (na_tray_size_allocate),
	(na_tray_class_init), (na_tray_new_for_screen),
	(na_tray_set_orientation), (na_tray_get_orientation),
	(idle_redraw_cb), (na_tray_force_redraw):
	* gui/simple-greeter/cutnpaste/na-tray.h:
	* gui/simple-greeter/cutnpaste/obox.c: (na_obox_class_init),
	(na_obox_init), (na_obox_new), (get_class), (na_obox_size_request),
	(na_obox_size_allocate), (na_obox_set_orientation):
	* gui/simple-greeter/cutnpaste/obox.h:
	* gui/simple-greeter/cutnpaste/testtray.c: (do_add),
	(update_child_count), (tray_added_cb), (tray_removed_cb),
	(orientation_changed_cb), (maybe_quit),
	(warning_dialog_response_cb), (add_tray_cb),
	(create_tray_on_screen), (main):
	* gui/simple-greeter/gdm-greeter-panel.c:
	(gdm_greeter_panel_set_property), (gdm_greeter_panel_get_property),
	(gdm_greeter_panel_constructor), (gdm_greeter_panel_dispose),
	(gdm_greeter_panel_move_resize_window), (on_screen_size_changed),
	(gdm_greeter_panel_real_realize),
	(gdm_greeter_panel_real_unrealize), (get_outside_region),
	(get_monitor_geometry), (set_struts), (update_struts),
	(update_geometry), (gdm_greeter_panel_real_size_request),
	(gdm_greeter_panel_class_init), (gdm_greeter_panel_init),
	(gdm_greeter_panel_finalize), (gdm_greeter_panel_new):
	* gui/simple-greeter/gdm-greeter-panel.h:
	* gui/simple-greeter/gdm-simple-greeter.c: (set_sensitive),
	(set_message), (create_greeter), (create_panel),
	(gdm_simple_greeter_constructor):
	* gui/simple-greeter/gdm-simple-greeter.glade:
	* gui/simple-greeter/greeter-main.c: (get_display_id):
	* gui/simple-greeter/test-greeter-panel.c: (main):
	Add a greeter panel bar with an embedded notification area.

2007-09-05  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (run_greeter):
	* daemon/gdm-greeter-server.c: (handle_disconnect),
	(handle_get_display_id), (greeter_handle_child_message),
	(do_introspect), (_gdm_greeter_server_set_display_id),
	(gdm_greeter_server_set_property),
	(gdm_greeter_server_get_property), (gdm_greeter_server_class_init),
	(gdm_greeter_server_new):
	* daemon/gdm-greeter-server.h:
	* daemon/gdm-simple-slave.c: (run_greeter),
	(gdm_simple_slave_stop):
	* daemon/gdm-slave.c: (gdm_slave_finalize):
	* gui/simple-greeter/gdm-simple-greeter.c:
	(suspend_button_clicked), (gdm_simple_greeter_new):
	* gui/simple-greeter/gdm-simple-greeter.h:
	* gui/simple-greeter/greeter-main.c: (on_select_hostname),
	(on_disconnected), (get_display_id), (main):
	* libgreeter/gdm-greeter.c: (gdm_greeter_display_is_local),
	(gdm_greeter_emit_disconnected), (_gdm_greeter_set_display_id),
	(gdm_greeter_set_property), (gdm_greeter_get_property),
	(cache_display_values), (gdm_greeter_constructor),
	(gdm_greeter_class_init), (gdm_greeter_finalize):
	* libgreeter/gdm-greeter.h:
	Add SelectHostname, Disconnected, and GetDisplayId methods
	to the greeter server interface.

2007-09-05  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-server.c: (handle_select_hostname),
	(greeter_handle_child_message), (do_introspect),
	(gdm_greeter_server_class_init):
	* daemon/gdm-greeter-server.h:
	Add SelectHostname to greeter interface.  For use
	with xdmcp host choosers.

2007-09-04  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c (gdm_session_worker_verify_user):
	Don't print null strings - solaris crashes.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-09-04  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-address.c: (gdm_address_peek_local_list):
	* daemon/gdm-xdmcp-display-factory.c: (do_bind),
	(gdm_xdmcp_send_failed):
	* gui/simple-chooser/chooser-main.c: (main):
	* gui/simple-chooser/gdm-host-chooser-widget.c: (chooser_host_add),
	(chooser_host_remove), (chooser_host_free), (find_known_host),
	(browser_add_host), (decode_packet), (do_ping), (xdmcp_discover),
	(find_broadcast_addresses), (add_hosts), (xdmcp_init),
	(gdm_host_chooser_widget_get_current_hostname),
	(gdm_host_chooser_widget_dispose),
	(gdm_host_chooser_widget_class_init), (on_host_selected),
	(on_row_activated), (gdm_host_chooser_widget_init):
	* gui/simple-chooser/gdm-host-chooser-widget.h:
	Make the chooser kinda work.

2007-08-31  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-chooser/Makefile.am:
	* gui/simple-chooser/gdm-host-chooser-widget.c: (decode_packet),
	(do_ping), (ping_try), (xdmcp_discover), (xdmcp_init),
	(gdm_host_chooser_widget_init):
	A bit more stuff for the chooser

2007-08-31  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-server.c: (generate_address):
	* daemon/gdm-session-relay.c: (generate_address):
	* daemon/gdm-session.c: (generate_address):
	Remove subdirectory in dbus socket tmpdir.

2007-08-31  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/gdm-server.c: (gdm_server_init):
	Use X_SERVER define instead of hardcoding xorg.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-08-30  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/Makefile.am:
	* gui/simple-chooser/Makefile.am:
	* gui/simple-chooser/chooser-main.c: (main):
	* gui/simple-chooser/gdm-host-chooser-dialog.c:
	(gdm_host_chooser_dialog_get_current_hostname),
	(gdm_host_chooser_dialog_set_property),
	(gdm_host_chooser_dialog_get_property),
	(gdm_host_chooser_dialog_constructor),
	(gdm_host_chooser_dialog_dispose),
	(gdm_host_chooser_dialog_class_init), (on_response),
	(gdm_host_chooser_dialog_init), (gdm_host_chooser_dialog_finalize),
	(gdm_host_chooser_dialog_new):
	* gui/simple-chooser/gdm-host-chooser-dialog.h:
	* gui/simple-chooser/gdm-host-chooser-widget.c:
	(gdm_host_chooser_widget_refresh),
	(gdm_host_chooser_widget_get_current_hostname),
	(gdm_host_chooser_widget_set_property),
	(gdm_host_chooser_widget_get_property),
	(gdm_host_chooser_widget_constructor),
	(gdm_host_chooser_widget_dispose),
	(gdm_host_chooser_widget_class_init), (on_row_activated),
	(gdm_host_chooser_widget_init), (gdm_host_chooser_widget_finalize),
	(gdm_host_chooser_widget_new):
	* gui/simple-chooser/gdm-host-chooser-widget.h:
	* libgreeter/gdm-greeter.h:
	Add skeleton for chooser.

2007-08-29  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-local-display-factory.c:
	(create_displays_for_pci_devices):
	* daemon/test-hal-seats.c: (get_pci_seats):
	Initialize and free error in loop.

2007-08-28  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-address.c:
	* common/gdm-address.h:
	* common/gdm-common.c:
	* common/gdm-common.h:
	* common/gdm-log.c:
	* common/gdm-log.h:
	* common/gdm-md5.c:
	* common/gdm-md5.h:
	* common/gdm-settings-backend.c:
	* common/gdm-settings-backend.h:
	* common/gdm-settings-client.c:
	* common/gdm-settings-client.h:
	* common/gdm-settings-desktop-backend.c:
	* common/gdm-settings-desktop-backend.h:
	* common/gdm-settings-direct.c:
	* common/gdm-settings-direct.h:
	* common/gdm-settings-keys.h:
	* common/gdm-settings-utils.c:
	* common/gdm-settings-utils.h:
	* common/gdm-settings.c:
	* common/gdm-settings.h:
	* common/gdm-signal-handler.c:
	* common/gdm-signal-handler.h:
	* common/ve-signal.c:
	* common/ve-signal.h:
	* daemon/auth.c:
	* daemon/choose.c:
	* daemon/choose.h:
	* daemon/factory-slave-main.c:
	* daemon/filecheck.c:
	* daemon/gdm-display-factory.c:
	* daemon/gdm-display-factory.h:
	* daemon/gdm-display-store.c:
	* daemon/gdm-display-store.h:
	* daemon/gdm-display.c:
	* daemon/gdm-display.h:
	* daemon/gdm-factory-slave.c:
	* daemon/gdm-factory-slave.h:
	* daemon/gdm-greeter-proxy.c:
	* daemon/gdm-greeter-proxy.h:
	* daemon/gdm-greeter-server.c:
	* daemon/gdm-greeter-server.h:
	* daemon/gdm-local-display-factory.c:
	* daemon/gdm-local-display-factory.h:
	* daemon/gdm-manager.c:
	* daemon/gdm-manager.h:
	* daemon/gdm-product-display.c:
	* daemon/gdm-product-display.h:
	* daemon/gdm-product-slave.c:
	* daemon/gdm-product-slave.h:
	* daemon/gdm-server.c:
	* daemon/gdm-server.h:
	* daemon/gdm-session-relay.c:
	* daemon/gdm-session-relay.h:
	* daemon/gdm-session-worker-job.c:
	* daemon/gdm-session-worker-job.h:
	* daemon/gdm-session-worker.c:
	* daemon/gdm-session-worker.h:
	* daemon/gdm-session.c:
	* daemon/gdm-session.h:
	* daemon/gdm-simple-slave.c:
	* daemon/gdm-simple-slave.h:
	* daemon/gdm-slave-proxy.c:
	* daemon/gdm-slave-proxy.h:
	* daemon/gdm-slave.c:
	* daemon/gdm-slave.h:
	* daemon/gdm-static-display.c:
	* daemon/gdm-static-display.h:
	* daemon/gdm-static-factory-display.c:
	* daemon/gdm-static-factory-display.h:
	* daemon/gdm-xdmcp-display-factory.c:
	* daemon/gdm-xdmcp-display-factory.h:
	* daemon/gdm-xdmcp-display.c:
	* daemon/gdm-xdmcp-display.h:
	* daemon/main.c:
	* daemon/product-slave-main.c:
	* daemon/session-worker-main.c:
	* daemon/simple-slave-main.c:
	* daemon/test-hal-seats.c:
	* daemon/test-session.c:
	* gui/simple-greeter/gdm-simple-greeter.c:
	* gui/simple-greeter/gdm-simple-greeter.h:
	* gui/simple-greeter/greeter-main.c:
	* libgreeter/gdm-greeter.c:
	* libgreeter/gdm-greeter.h:
	* libgreeter/gdmlanguages.c:
	* libgreeter/gdmsession.c:
	Mass change tabs to spaces.  Tabs suck.

2007-08-28  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (on_greeter_answer):
	* daemon/gdm-greeter-server.c: (handle_answer_query):
	* daemon/gdm-product-slave.c: (on_relay_answer):
	* daemon/gdm-session-relay.c: (gdm_session_relay_answer_query):
	* daemon/gdm-session-worker.c:
	(gdm_session_worker_pam_new_messages_handler):
	* gui/simple-greeter/greeter-main.c: (on_query_answer):
	Don't echo authentication responses.

2007-08-23  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-display.c: (_gdm_display_set_seat_id),
	(gdm_display_set_property), (gdm_display_get_property),
	(gdm_display_class_init), (gdm_display_finalize):
	Add seat-id property.

2007-08-23  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	Add libresolv to EXTRA_DAEMON_LIBS on Solaris
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-08-22  William Jon McCann  <mccann@jhu.edu>

	* daemon/INTERNALS:
	Add some basic descriptions of some internals.

2007-08-22  William Jon McCann  <mccann@jhu.edu>

	* daemon/getvt.c:
	* daemon/getvt.h:
	* daemon/test-hal-seats.c:
	Remove getvt stuff.  Add little hal test tool.

2007-08-22  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (run_greeter):
	* daemon/gdm-product-slave.c: (setup_server):
	* daemon/gdm-simple-slave.c: (run_greeter):
	Remove tsol_init stuff for now

2007-08-22  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/gdm-session-worker.c:
	(gdm_session_worker_give_user_credentials):
	Add support for non POSIX getpwnam_r

2007-08-21  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-display-factory.c:
	* daemon/gdm-factory-slave.c:
	* daemon/gdm-product-slave.c: (on_session_started):
	* daemon/gdm-xdmcp-display-factory.c:
	Remove unused signals variable.

2007-08-21  William Jon McCann  <mccann@jhu.edu>

	* daemon/test-session.c: (on_secret_info_query):
	Convert termio to termios stuff.

2007-08-21  William Jon McCann  <mccann@jhu.edu>

	* acconfig.h:
	* acinclude.m4:
	* common/gdm-address.c:
	* configure.ac:
	* daemon/Makefile.am:
	* daemon/factory-slave-main.c:
	* daemon/gdm-server.c: (server_child_setup):
	* daemon/main.c: (main):
	* daemon/product-slave-main.c:
	* daemon/session-worker-main.c:
	* daemon/simple-slave-main.c:
	* daemon/test-session.c: (on_secret_info_query):
	Some Solaris build fixes.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-08-03  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-display-factory.c: (gdm_display_factory_start),
	(gdm_display_factory_stop):
	* daemon/gdm-display-factory.h:
	* daemon/gdm-local-display-factory.c:
	(gdm_local_display_factory_start),
	(gdm_local_display_factory_stop),
	(gdm_local_display_factory_class_init):
	* daemon/gdm-local-display-factory.h:
	* daemon/gdm-manager.c: (gdm_manager_start),
	(gdm_manager_set_wait_for_go):
	* daemon/gdm-xdmcp-display-factory.c:
	(gdm_xdmcp_display_factory_start),
	(gdm_xdmcp_display_factory_stop),
	(gdm_xdmcp_display_factory_class_init):
	* daemon/gdm-xdmcp-display-factory.h:
	Fix up inheritance.

2007-08-03  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/gdm-display-factory.c: (gdm_display_factory_error_quark),
	(gdm_display_factory_get_display_store),
	(gdm_display_factory_start), (gdm_display_factory_stop),
	(gdm_display_factory_set_display_store),
	(gdm_display_factory_set_property),
	(gdm_display_factory_get_property),
	(gdm_display_factory_class_init), (gdm_display_factory_init),
	(gdm_display_factory_finalize):
	* daemon/gdm-display-factory.h:
	* daemon/gdm-local-display-factory.c: (create_display_for_device),
	(create_displays_for_pci_devices),
	(gdm_local_display_factory_start),
	(gdm_local_display_factory_set_property),
	(gdm_local_display_factory_get_property),
	(gdm_local_display_factory_class_init):
	* daemon/gdm-local-display-factory.h:
	* daemon/gdm-manager.c: (gdm_manager_start),
	(gdm_manager_set_wait_for_go), (gdm_manager_constructor),
	(gdm_manager_finalize):
	* daemon/gdm-xdmcp-display-factory.c:
	(gdm_xdmcp_display_factory_error_quark), (get_next_session_serial),
	(setup_multicast), (open_port), (gdm_xdmcp_num_displays_from_host),
	(gdm_xdmcp_display_lookup_by_host), (get_willing_output),
	(gdm_xdmcp_send_willing), (gdm_xdmcp_send_unwilling),
	(gdm_xdmcp_send_forward_query), (handle_any_query),
	(handle_direct_query), (gdm_xdmcp_handle_broadcast_query),
	(gdm_xdmcp_handle_query), (gdm_xdmcp_handle_indirect_query),
	(gdm_forward_query_dispose), (remove_oldest_forward),
	(gdm_forward_query_alloc), (gdm_forward_query_lookup),
	(gdm_xdmcp_whack_queued_managed_forwards),
	(gdm_xdmcp_handle_forward_query),
	(gdm_xdmcp_really_send_managed_forward), (managed_forward_handler),
	(gdm_xdmcp_send_managed_forward),
	(gdm_xdmcp_send_got_managed_forward), (count_sessions),
	(gdm_xdmcp_recount_sessions), (purge_displays),
	(gdm_xdmcp_displays_purge), (display_dispose_check),
	(gdm_xdmcp_send_decline), (gdm_xdmcp_display_alloc),
	(gdm_xdmcp_send_accept), (gdm_xdmcp_handle_request),
	(gdm_xdmcp_display_lookup), (gdm_xdmcp_send_failed),
	(gdm_xdmcp_send_refuse), (gdm_xdmcp_handle_manage),
	(gdm_xdmcp_handle_managed_forward),
	(gdm_xdmcp_handle_got_managed_forward), (gdm_xdmcp_send_alive),
	(gdm_xdmcp_handle_keepalive), (decode_packet),
	(gdm_xdmcp_display_factory_start),
	(gdm_xdmcp_display_factory_stop),
	(gdm_xdmcp_display_factory_set_port),
	(gdm_xdmcp_display_factory_set_use_multicast),
	(gdm_xdmcp_display_factory_set_multicast_address),
	(gdm_xdmcp_display_factory_set_honor_indirect),
	(gdm_xdmcp_display_factory_set_max_displays_per_host),
	(gdm_xdmcp_display_factory_set_max_displays),
	(gdm_xdmcp_display_factory_set_max_pending_displays),
	(gdm_xdmcp_display_factory_set_max_wait),
	(gdm_xdmcp_display_factory_set_willing_script),
	(gdm_xdmcp_display_factory_set_property),
	(gdm_xdmcp_display_factory_get_property),
	(gdm_xdmcp_display_factory_class_init),
	(gdm_xdmcp_display_factory_init),
	(gdm_xdmcp_display_factory_finalize),
	(gdm_xdmcp_display_factory_new):
	* daemon/gdm-xdmcp-display-factory.h:
	* daemon/gdm-xdmcp-manager.c:
	* daemon/gdm-xdmcp-manager.h:
	Add an abstract base class for display factories.  Rename
	gdm-xdmcp-manager to gdm-xdmcp-display-factory.

2007-08-02  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/gdm-local-display-factory.c:
	(gdm_local_display_factory_error_quark), (get_pci_seat_devices),
	(gdm_local_display_factory_start),
	(gdm_local_display_factory_stop),
	(gdm_local_display_factory_set_display_store),
	(gdm_local_display_factory_set_property),
	(gdm_local_display_factory_get_property),
	(gdm_local_display_factory_class_init), (connect_to_hal),
	(disconnect_from_hal), (gdm_local_display_factory_init),
	(gdm_local_display_factory_finalize),
	(gdm_local_display_factory_new):
	* daemon/gdm-local-display-factory.h:
	* daemon/gdm-manager.c: (gdm_manager_start),
	(gdm_manager_set_wait_for_go), (gdm_manager_constructor):
	Add new object that will monitor HAL and act as a factory
	for displays.

2007-08-01  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c: (open_idle), (free_open_data),
	(queue_open), (on_begin_verification),
	(on_begin_verification_for_user):
	* daemon/gdm-session.c: (gdm_session_handle_verification_failed):
	* daemon/gdm-simple-slave.c: (greeter_reset_timeout),
	(queue_greeter_reset), (on_user_verification_error):
	* gui/simple-greeter/gdm-simple-greeter.c: (set_message),
	(do_cancel), (reset_dialog), (gdm_simple_greeter_reset),
	(gdm_simple_greeter_info), (gdm_simple_greeter_problem),
	(gdm_simple_greeter_info_query),
	(gdm_simple_greeter_secret_info_query), (cancel_button_clicked):
	* gui/simple-greeter/gdm-simple-greeter.glade:
	Report errors to the greeter.  Reset greeter after errors.
	Open the session in an idle.

2007-08-01  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-simple-greeter.c: (set_busy), (set_ready),
	(set_sensitive), (reset_dialog), (gdm_simple_greeter_info_query),
	(gdm_simple_greeter_secret_info_query), (ok_button_clicked),
	(cancel_button_clicked), (create_greeter):
	* gui/simple-greeter/gdm-simple-greeter.glade:
	Change sensitivity and cursor when waiting.

2007-08-01  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session.c: (answer_pending_query):
	* daemon/gdm-simple-slave.c: (create_new_session),
	(on_greeter_cancel):
	Reopen the session after the greeter is cancelled.

2007-08-01  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/ck-connector.c: (lookup_parameter_type),
	(add_param_basic), (_ck_connector_free), (ck_connector_unref),
	(ck_connector_ref), (ck_connector_new),
	(ck_connector_open_session),
	(ck_connector_open_session_with_parameters_valist),
	(ck_connector_open_session_with_parameters),
	(ck_connector_open_session_for_user), (ck_connector_get_cookie),
	(ck_connector_close_session):
	* daemon/ck-connector.h:
	* daemon/gdm-ck-session.c:
	* daemon/gdm-ck-session.h:
	* daemon/gdm-factory-slave.c: (run_greeter):
	* daemon/gdm-greeter-proxy.c: (open_greeter_session),
	(close_greeter_session), (get_greeter_environment),
	(greeter_proxy_child_watch), (gdm_greeter_proxy_spawn),
	(gdm_greeter_proxy_stop),
	(_gdm_greeter_proxy_set_x11_display_hostname),
	(_gdm_greeter_proxy_set_x11_display_is_local),
	(gdm_greeter_proxy_set_property), (gdm_greeter_proxy_get_property),
	(gdm_greeter_proxy_class_init), (gdm_greeter_proxy_init),
	(gdm_greeter_proxy_finalize), (gdm_greeter_proxy_new):
	* daemon/gdm-greeter-proxy.h:
	* daemon/gdm-simple-slave.c: (slave_open_ck_session),
	(setup_session_environment), (run_greeter):
	Make ConsoleKit session registration more robust and complete.

2007-07-26  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-proxy.c: (close_greeter_session),
	(greeter_proxy_child_watch), (gdm_greeter_proxy_stop):
	Close greeter ConsoleKit session.

2007-07-26  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-ck-session.c: (open_ck_session), (close_ck_session):
	* daemon/gdm-ck-session.h:
	* daemon/gdm-greeter-proxy.c: (open_greeter_session),
	(gdm_greeter_proxy_spawn):
	* daemon/gdm-simple-slave.c: (slave_open_ck_session),
	(setup_session_environment), (gdm_simple_slave_init):
	Register user session with ConsoleKit.

2007-07-25  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-address.c: (gdm_address_get_hostname),
	(gdm_address_get_numeric_info), (address_family_str),
	(gdm_address_debug):
	* common/gdm-address.h:
	* daemon/Makefile.am:
	* daemon/auth.c: (gdm_auth_add_entry),
	(gdm_auth_add_entry_for_display), (gdm_auth_user_add):
	* daemon/auth.h:
	* daemon/gdm-ck-session.c: (unlock_ck_session):
	* daemon/gdm-display.c: (gdm_display_real_add_user_authorization),
	(gdm_display_add_user_authorization),
	(gdm_display_real_remove_user_authorization),
	(gdm_display_remove_user_authorization),
	(gdm_display_get_x11_display_number),
	(gdm_display_get_x11_display_name),
	(_gdm_display_set_x11_display_number),
	(_gdm_display_set_x11_display_name), (gdm_display_set_property),
	(gdm_display_get_property), (gdm_display_class_init):
	* daemon/gdm-display.h:
	* daemon/gdm-display.xml:
	* daemon/gdm-factory-slave.c: (run_greeter):
	* daemon/gdm-greeter-proxy.c: (listify_hash):
	* daemon/gdm-product-display.c:
	(gdm_product_display_add_user_authorization),
	(gdm_product_display_remove_user_authorization),
	(gdm_product_display_class_init), (gdm_product_display_new):
	* daemon/gdm-simple-slave.c: (listify_hash),
	(get_script_environment), (add_user_authorization),
	(setup_session_environment), (run_greeter),
	(gdm_simple_slave_init):
	* daemon/gdm-slave.c: (gdm_slave_real_start),
	(gdm_slave_add_user_authorization),
	(_gdm_slave_set_display_number), (gdm_slave_set_property),
	(gdm_slave_get_property), (gdm_slave_class_init):
	* daemon/gdm-slave.h:
	* daemon/gdm-static-display.c:
	(gdm_static_display_add_user_authorization),
	(gdm_static_display_remove_user_authorization),
	(gdm_static_display_class_init), (gdm_static_display_new):
	* daemon/gdm-static-factory-display.c:
	(gdm_static_factory_display_add_user_authorization),
	(gdm_static_factory_display_remove_user_authorization),
	(gdm_static_factory_display_class_init),
	(gdm_static_factory_display_new):
	* daemon/gdm-xdmcp-display.c: (gdm_xdmcp_display_create_authority),
	(gdm_xdmcp_display_add_user_authorization),
	(gdm_xdmcp_display_remove_user_authorization),
	(_gdm_xdmcp_display_set_remote_address),
	(gdm_xdmcp_display_set_property), (gdm_xdmcp_display_class_init),
	(gdm_xdmcp_display_new):
	* daemon/gdm-xdmcp-manager.c: (do_bind), (gdm_xdmcp_host_allow),
	(lookup_by_host), (gdm_xdmcp_send_willing),
	(gdm_xdmcp_send_unwilling), (gdm_xdmcp_send_forward_query),
	(gdm_forward_query_dispose), (gdm_forward_query_lookup),
	(gdm_xdmcp_handle_forward_query),
	(gdm_xdmcp_really_send_managed_forward),
	(gdm_xdmcp_send_got_managed_forward), (remove_host),
	(gdm_xdmcp_send_decline), (gdm_xdmcp_display_alloc),
	(gdm_xdmcp_send_accept), (gdm_xdmcp_handle_request),
	(gdm_xdmcp_handle_manage), (gdm_xdmcp_handle_managed_forward),
	(gdm_xdmcp_handle_got_managed_forward),
	(gdm_xdmcp_handle_keepalive), (decode_packet):
	* data/gdm.conf:
	* gui/simple-greeter/greeter-main.c: (main):
	Make XDMCP logins work.

2007-07-24  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-display.c: (finish_idle), (queue_finish),
	(slave_exited), (slave_died), (gdm_display_manage),
	(gdm_display_real_finish), (gdm_display_finish),
	(gdm_display_dispose), (gdm_display_class_init):
	* daemon/gdm-display.h:
	* daemon/gdm-manager.c: (load_static_displays_from_file):
	* daemon/gdm-product-display.c: (gdm_product_display_finish),
	(gdm_product_display_class_init):
	* daemon/gdm-simple-slave.c: (on_session_exited),
	(on_session_died), (on_opened), (create_new_session),
	(on_greeter_start), (on_greeter_stop), (on_greeter_user_selected),
	(on_greeter_cancel), (on_greeter_connected), (run_greeter),
	(gdm_simple_slave_finalize):
	* daemon/gdm-slave-proxy.c: (child_watch),
	(gdm_slave_proxy_dispose), (gdm_slave_proxy_class_init):
	* daemon/gdm-static-display.c: (gdm_static_display_finish),
	(gdm_static_display_class_init):
	* daemon/gdm-static-factory-display.c:
	(gdm_static_factory_display_finish),
	(gdm_static_factory_display_class_init):
	Dogfood static display.  Make static display work.  Add a finished
	state to the Display.  Always restart static displays on finish.

2007-07-22  Richard Hughes  <richard@hughsie.com>

	* common/Makefile.am:
	* daemon/Makefile.am:
	* data/Makefile.am:
	* gui/simple-greeter/Makefile.am:
	* libgreeter/Makefile.am:
	* po/POTFILES.in:
	* po/POTFILES.skip:
	* utils/Makefile.am:
	Fix make distcheck.

