2007-12-21  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-background.c:
	* gui/simple-greeter/gdm-greeter-background.h:
	* gui/simple-greeter/gdm-greeter-session.c: (toggle_all_levels):
	* gui/simple-greeter/gdm-simple-greeter.schemas.in:
	Enable the background settings module and remove the
	gdm-greeter-background code.

2007-12-21  Brian Cameron  <brian.cameron@sun.com>

	* configure.ac, tests/Makefile.am:  Minor change to
	  add -lsocket and -lnsl when building the test programs
	  on Solaris.  This is needed to link getnameinfo,
	  getaddrinfo, freeaddrinfo, and gai_strerror which
	  are references from libgdmcommon.

2007-12-21  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-direct.c:
	(gdm_session_direct_handle_cancel_pending_query),
	(session_worker_message), (do_introspect):
	* daemon/gdm-session-worker.c: (send_question_method),
	(gdm_session_worker_process_pam_message):
	Handle D-Bus method timeouts.

2007-12-21  Ray Strode  <halfline@gnome.org>

	* gui/simple-greeter/gdm-greeter-login-window.c
	(gdm_greeter_login_window_key_press_event),
	(gdm_greeter_login_window_class_init):
	Reset dialog if escape key is pressed

2007-12-21  Ray Strode  <halfline@gnome.org>

	* gui/simple-greeter/gdm-chooser-widget.c:
	(shrink_edge_toward_active_row): bail if we're already at the top
	(run_animation): stop running if the animation finishes elsewhere
	between iterations.
	(set_inactive_items_visible): new function to hide or show all
	inactive items in one go
	(skip_animation): new function skip to the fully shrunk or fully
	grown state without any intermediate animation
	(gdm_chooser_widget_grow), (gdm_chooser_widget_shrink): skip
	animation if widget is hidden
	(gdm_chooser_widget_show), (gdm_chooser_widget_hide),
	(gdm_chooser_widget_class_init): stop any pending animations if
	the widget just gets shown or hidden

2007-12-21  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c:
	(gdm_session_worker_uninitialize_pam),
	(gdm_session_worker_initialize_pam),
	(gdm_session_worker_authenticate_user),
	(gdm_session_worker_authorize_user),
	(gdm_session_worker_accredit_user),
	(gdm_session_worker_start_user_session),
	(gdm_session_worker_open_user_session), (get_state_name),
	(state_change_idle):
	Add some debug output for the state changes.

	* gui/simple-greeter/gdm-chooser-widget.c:
	(update_column_visibility):
	* gui/simple-greeter/gdm-greeter-session.c: (start_window_manager):
	Prefer metacity over compiz.  We've had a number of compiz
	bugs show up and confuse us.

2007-12-20  Ray Strode  <halfline@gnome.org>

	* gui/simple-greeter/gdm-chooser-widget.c:
	(update_column_visibility): reenable
	(gdm_chooser_widget_add_item), (gdm_chooser_widget_remove_item),
	(gdm_chooser_widget_set_item_in_use): call
	queue_column_visibility_update as needed so columns get shown
	and hidden properly

2007-12-20  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-panel.c: (gdm_greeter_panel_init):
	* gui/simple-greeter/gdm-greeter-session.c: (toggle_panel):
	Re-enable the panel.  Don't show the hostname.

2007-12-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-manager.c:
	(get_x11_display_for_session), (add_sessions_for_user):
	Ignore sessions without an X11 display.

2007-12-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-chooser-widget.c:
	(gdm_chooser_widget_grow), (gdm_chooser_widget_shrink):
	Don't try to animate if not visible.

2007-12-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-manager.c (get_current_seat_id):
	Fix c-n-p error.

2007-12-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-manager.c: (get_seat_id_for_session),
	(get_current_seat_id):
	Make 2 warnings debugs instead

2007-12-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-manager.c: (get_seat_id_for_session),
	(add_sessions_for_user), (get_current_seat_id), (get_seat_proxy),
	(gdm_user_manager_finalize):
	Ignore sessions on other seats.

2007-12-19  Ray Strode  <rstrode@redhat.com>

	Improve the chooser animation

	* gui/simple-greeter/gdm-chooser-widget.c
	(iterate_animation): Support doing an arbitrary
	number of iterations, also rename to run_animation
	(activate_from_row), (stop_animation): Defer "activated"
	signal emission to here, so the toplevel won't react
	to user selection until the animation finishes.  Rename
	stop_animation to on_animation_done since it gets called in
	response to the animation stopping, not to initiate stopping.
	(start_animation): Before starting an animation (and thus
	expanding the scrolled window to the full height of the tree
	view), hide all rows that are currently occluded by the
	the scrolled window.  This prevents an initial grow flicker
	in the shrink sequence

2007-12-19  Ray Strode  <rstrode@redhat.com>

	* gui/simple-greeter/gdm-greeter-login-window.c
	(custom_widget_constructor), (load_theme): don't show
	custom widgets by default

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* configure.ac: Post release version bump

==== 2.21.4 ====

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* NEWS: Update for release

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	Fix distcheck.

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c (switch_mode):
	Make sure variable is initialized.

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/gdm-greeter-session.c:
	(start_settings_daemon):
	Require new gnome-settings-daemon.

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-chooser-widget.c: (set_frame_text),
	(gdm_chooser_widget_init):
	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode),
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	* gui/simple-greeter/gdm-greeter-session.c:
	(start_settings_daemon):
	Tweak some widget spacing and alignment.

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-chooser-widget.c (update_column_visibility):
	Disable hiding the image columns for now.

2007-12-18  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c: (on_user_added),
	(on_user_is_logged_in_changed):
	* gui/simple-greeter/gdm-user-manager.c: (add_sessions_for_user),
	(add_user), (add_new_user_for_pwent), (get_current_seat_id),
	(reload_passwd):
	Load the list of sessions for each user at startup.

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(fit_window_to_children), (gdm_greeter_login_window_size_request),
	(clear_animation_timeout_id),
	(gdm_greeter_login_window_size_allocate),
	(gdm_greeter_login_window_class_init):
	add lame animation to greeter login window
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode),
	(do_cancel), (reset_dialog), (on_user_unchosen),
	(on_session_activated), (custom_widget_constructor), (load_theme),
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	This change adds the session chooser to the login window.
	It changes the mechanism by the choosers are specified in
	the glade file to use custom widgets.
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/settings-daemon/gdm-settings-plugins-engine.c:
	(gdm_settings_plugins_engine_activate_plugin),
	(gdm_settings_plugins_engine_deactivate_plugin):
	Remove extra slashes.

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-dialog.c:
	(gdm_user_chooser_dialog_init):
	Don't shrink the chooser in the test program.
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-session-chooser-widget.c:
	(gdm_session_chooser_widget_get_current_session_name),
	(gdm_session_chooser_widget_set_current_session_name),
	(gdm_session_chooser_widget_set_show_only_chosen),
	(gdm_session_chooser_widget_dispose),
	(gdm_session_chooser_widget_class_init), (add_session),
	(add_available_sessions), (gdm_session_chooser_widget_init),
	(gdm_session_chooser_widget_new):
	* gui/simple-greeter/gdm-session-chooser-widget.h:
	Convert session chooser to derive from chooser widget.
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_set_show_other_user),
	(gdm_user_chooser_widget_set_show_guest_user),
	(gdm_user_chooser_widget_get_chosen_user_name),
	(gdm_user_chooser_widget_set_chosen_user_name),
	(gdm_user_chooser_widget_set_show_only_chosen),
	(gdm_user_chooser_widget_dispose),
	(gdm_user_chooser_widget_class_init), (add_special_users),
	(on_user_added), (on_user_removed), (on_user_is_logged_in_changed),
	(gdm_user_chooser_widget_init), (gdm_user_chooser_widget_finalize),
	(gdm_user_chooser_widget_new):
	* gui/simple-greeter/gdm-user-chooser-widget.h:
	Convert user chooser to derive from chooser widget.
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-chooser-widget.c: (find_item),
	(get_active_item_id), (gdm_chooser_widget_get_active_item),
	(activate_from_item_id), (set_frame_text),
	(translate_base_path_to_sorted_path),
	(shrink_edge_toward_active_row), (iterate_animation),
	(stop_animation), (start_animation), (gdm_chooser_widget_grow),
	(move_cursor_to_top), (clear_selection),
	(gdm_chooser_widget_shrink), (activate_from_row), (deactivate),
	(activate_selected_item), (gdm_chooser_widget_set_active_item),
	(gdm_chooser_widget_set_property),
	(gdm_chooser_widget_get_property),
	(gdm_chooser_widget_constructor), (gdm_chooser_widget_dispose),
	(gdm_chooser_widget_focus_in), (gdm_chooser_widget_size_request),
	(compare_allocation_height), (renegotiate_allocation),
	(gdm_chooser_widget_size_allocate),
	(gdm_chooser_widget_class_init), (on_row_activated),
	(path_is_separator), (compare_item), (name_cell_data_func),
	(check_cell_data_func), (get_is_in_use_pixbuf), (separator_func),
	(add_separator), (update_column_visibility),
	(clear_canceled_visibility_update),
	(queue_column_visibility_update), (on_row_changed), (add_frame),
	(on_button_release), (gdm_chooser_widget_init),
	(gdm_chooser_widget_finalize), (gdm_chooser_widget_new),
	(gdm_chooser_widget_add_item), (gdm_chooser_widget_remove_item),
	(gdm_chooser_widget_lookup_item),
	(gdm_chooser_widget_set_item_in_use),
	(gdm_chooser_widget_set_in_use_message),
	(gdm_chooser_widget_set_separator_position),
	(gdm_chooser_widget_set_hide_inactive_items):
	* gui/simple-greeter/gdm-chooser-widget.h:
	* gui/simple-greeter/gdm-greeter-session.c:
	(start_settings_daemon):
	Add a common "chooser" widget.
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-17  William Jon McCann  <mccann@jhu.edu>

	* configure.ac: Fix check for check.
	Patch from: Ray Strode  <rstrode@redhat.com>

2007-12-13  William Jon McCann  <mccann@jhu.edu>

	* gui/settings-daemon/main.c: (main):
	Also look for prefix in env var.

2007-12-13  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/settings-daemon/gdm-settings-manager.c:
	(gdm_settings_manager_start), (gdm_settings_manager_stop),
	(_set_gconf_prefix), (gdm_settings_manager_set_property),
	(gdm_settings_manager_get_property),
	(gdm_settings_manager_constructor), (gdm_settings_manager_dispose),
	(gdm_settings_manager_class_init), (gdm_settings_manager_init),
	(gdm_settings_manager_finalize), (gdm_settings_manager_new):
	* gui/settings-daemon/gdm-settings-manager.h:
	* gui/settings-daemon/gdm-settings-plugins-engine.c:
	(gdm_settings_plugins_engine_plugin_active_cb),
	(gdm_settings_plugins_engine_load_file),
	(gdm_settings_plugins_engine_load_dir),
	(gdm_settings_plugins_engine_init),
	(gdm_settings_plugins_engine_shutdown), (collate_values_cb),
	(gdm_settings_plugins_engine_get_plugins_list),
	(gdm_settings_plugins_engine_activate_plugin),
	(gdm_settings_plugins_engine_deactivate_plugin):
	* gui/settings-daemon/gdm-settings-plugins-engine.h:
	* gui/settings-daemon/main.c: (main):
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-session.c:
	(start_settings_daemon):
	* gui/simple-greeter/gdm-simple-greeter.schemas.in:
	Make the settings daemon load plugins from a specified gconf prefix.

2007-12-09  William Jon McCann  <mccann@jhu.edu>

	* Makefile.am:
	* common/gdm-address.c: (gdm_address_equal),
	(gdm_address_is_loopback):
	* common/gdm-common.c: (gdm_string_hex_encode),
	(gdm_string_hex_decode):
	* configure.ac:
	* tests/Makefile.am:
	* tests/m-common.c: (main):
	* tests/s-common-address.c: (setup), (teardown), (START_TEST),
	(suite_common_address):
	* tests/s-common-address.h:
	* tests/s-common-utils.c: (START_TEST), (suite_common_utils):
	* tests/s-common-utils.h:
	Add a unit testing framework.
	Based on a patch from Andrew Ziem <ahz001@gmail.com>

2007-11-30  Ray Strode  <rstrode@redhat.com>

	Fix some problems in the previous commit, spotted by
	Mike Oliver <Mike.Oliver@sun.com>

	* common/gdm-common.[ch] (gdm_generate_random_bytes):
	don't leak fd
	(_read_bytes): initialize bytes_left_to_read

2007-11-30  Ray Strode  <rstrode@redhat.com>

	Ensure second and subsequent auth cookies are
	random.  Spotted by George Lebl.

	* common/gdm-common.[ch] (gdm_generate_random_bytes):
	open /dev/urandom and read size bytes from it.
	(_fd_is_character_device): check if fd points to char
        device
	(_read_bytes): the usual loop until all bytes are read
	helper function for read().

	* daemon/gdm-display-access-file.c
	(generate_random_bytes): remove function
	(gdm_display_access_file_add_display):
	use gdm_generate_random_bytes instead of 
	_generate_random_bytes

2007-11-19  Ray Strode  <rstrode@redhat.com>

	Fix make distcheck

	* acconfig.h: add HAVE_LOG{IN,OUT,WTMP}
	* data/Makefile.am: uninstall pam and gconf files
	in uninstall-hook. fix builddir != srcdir issues

2007-11-19  Ray Strode  <rstrode@redhat.com>

	* data/Makefile.am:
	set up correct permissions on /var/lib/gdm

2007-11-19  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	Fix AC_PREREQ.  Fixes #497932

2007-11-19  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-common-unknown-origin.h:
	* configure.ac:
	* daemon/Makefile.am:
	* daemon/gdm-greeter-session.c:
	* daemon/gdm-server.c: (gdm_server_class_init):
	* daemon/gdm-session-record.c: (record_set_username),
	(gdm_session_record_login), (gdm_session_record_logout):
	* daemon/gdm-session-worker-job.c:
	(gdm_session_worker_job_class_init):
	* daemon/gdm-slave-proxy.c: (spawn_slave):
	* daemon/main.c:
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-manager.c:
	* gui/simple-chooser/gdm-host-chooser-widget.c: (do_ping):
	Fix build on FreeBSD.
	Patch from: Joe Marcus Clarke  <marcus@freebsd.org>

2007-11-19  Ray Strode  <rstrode@redhat.com>

	* data/Makefile.am:
	Add gconf.path and session-setup.entries to 
	Makefile.am

2007-11-19  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* data/Makefile.am:
	* data/gconf.path:
	* data/session-setup.entries:
	Setup gconf database for the GDM greeter session.

	Patch from: Ray Strode  <rstrode@redhat.com>
	and Matthias Clasen <mclasen@redhat.com>

2007-11-14  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-display.c (gdm_display_real_unmanage):
	 only close access file if it's open

2007-11-14  William Jon McCann  <mccann@jhu.edu>

	* configure.ac: Remove unused TSOL stuff.

2007-11-14  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-session-worker.c:
	(gdm_session_worker_start_user_session),
	(_open_session_log),
	(_fd_is_normal_file): log session console i/o to
	~/.xsession-errors

==== 2.21.2 ====

2007-11-12  William Jon McCann  <mccann@jhu.edu>

	* NEWS: Update for 2.21.2.

2007-11-09  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-display-access-file.c:
	(gdm_display_access_file_class_init),
	(gdm_display_access_file_new),
	(gdm_display_access_file_add_display):
	* daemon/gdm-display-access-file.h:
	Add emacs mode lines, split lines.

2007-11-09  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-common.c: (gdm_string_hex_decode):
	* common/gdm-common.h:
	* daemon/Makefile.am:
	* daemon/auth.c:
	* daemon/auth.h:
	* daemon/gdm-display.c: (_create_access_file_for_user),
	(gdm_display_real_create_authority),
	(gdm_display_real_add_user_authorization),
	(gdm_display_real_remove_user_authorization),
	(gdm_display_get_x11_cookie), (gdm_display_get_x11_authority_file),
	(gdm_display_real_unmanage), (gdm_display_set_property),
	(gdm_display_get_property), (gdm_display_class_init),
	(gdm_display_finalize):
	* daemon/gdm-display.h:
	* daemon/gdm-factory-slave.c: (gdm_factory_slave_run):
	* daemon/gdm-local-display-factory.c: (create_display_for_device):
	* daemon/gdm-manager.c: (gdm_manager_init), (gdm_manager_finalize):
	* daemon/gdm-product-slave.c: (gdm_product_slave_create_server):
	* daemon/gdm-server.c: (_gdm_server_set_auth_file),
	(gdm_server_set_property), (gdm_server_get_property),
	(gdm_server_class_init), (gdm_server_new):
	* daemon/gdm-server.h:
	* daemon/gdm-simple-slave.c: (gdm_simple_slave_run):
	* daemon/gdm-slave.c: (gdm_slave_connect_to_x11_display),
	(gdm_slave_real_start), (gdm_slave_set_property),
	(gdm_slave_get_property), (gdm_slave_class_init):
	* daemon/gdm-static-display.c:
	(gdm_static_display_add_user_authorization),
	(gdm_static_display_remove_user_authorization):
	* daemon/gdm-xdmcp-display-factory.c: (gdm_xdmcp_handle_request):
	* daemon/gdm-xdmcp-display.c: (gdm_xdmcp_display_create_authority),
	(gdm_xdmcp_display_add_user_authorization),
	(gdm_xdmcp_display_remove_user_authorization),
	(gdm_xdmcp_display_unmanage):
	* daemon/gdm-display-access-file.c:
	* daemon/gdm-display-access-file.h:
	With this patch we now invoke the X server with the -auth argument
	and disable machine wide access to the X server.  This patch also
	drops the md5 hashing of random bytes to create cookies and
	instead just creates cookies directly (like the X server would if
	we asked the X server to generate the cookies for us).

	Patch from: Ray Strode  <rstrode@redhat.com>

2007-11-07  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/test-hal-seats.c: (list_seats):
	Build the test hal seats tool

2007-11-07  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (greeter_reset_timeout),
	(queue_greeter_reset), (on_session_setup_complete),
	(on_session_setup_failed), (on_session_reset_complete),
	(on_session_reset_failed), (on_session_authenticated),
	(on_session_authentication_failed), (on_session_authorized),
	(on_session_authorization_failed), (on_session_accredited),
	(on_session_accreditation_failed), (on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user),
	(gdm_factory_slave_start):
	* daemon/gdm-product-slave.c: (on_session_setup_complete),
	(on_session_setup_failed), (on_session_reset_complete),
	(on_session_reset_failed), (on_session_authenticated),
	(on_session_authentication_failed), (on_session_authorized),
	(on_session_authorization_failed), (on_session_accredited),
	(on_session_accreditation_failed), (on_relay_setup),
	(on_relay_setup_for_user), (on_relay_authenticate),
	(on_relay_authorize), (on_relay_establish_credentials),
	(on_relay_renew_credentials), (create_new_session),
	(relay_dbus_handle_message):
	* daemon/gdm-session-direct.c: (send_dbus_void_signal),
	(on_authentication_failed), (on_session_start_failed),
	(gdm_session_direct_handle_setup_complete),
	(gdm_session_direct_handle_setup_failed),
	(gdm_session_direct_handle_reset_complete),
	(gdm_session_direct_handle_reset_failed),
	(gdm_session_direct_handle_authenticated),
	(gdm_session_direct_handle_authentication_failed),
	(gdm_session_direct_handle_authorized),
	(gdm_session_direct_handle_authorization_failed),
	(gdm_session_direct_handle_accredited),
	(gdm_session_direct_handle_accreditation_failed),
	(gdm_session_direct_handle_start_failed), (session_worker_message),
	(do_introspect), (gdm_session_direct_init), (worker_exited),
	(worker_died), (gdm_session_direct_open), (send_setup),
	(send_setup_for_user), (gdm_session_direct_setup),
	(gdm_session_direct_setup_for_user),
	(gdm_session_direct_authenticate), (gdm_session_direct_authorize),
	(gdm_session_direct_accredit), (gdm_session_direct_close),
	(gdm_session_iface_init):
	* daemon/gdm-session-direct.h:
	* daemon/gdm-session-private.h:
	* daemon/gdm-session-relay.c: (send_dbus_string_signal),
	(send_dbus_void_signal), (gdm_session_relay_setup),
	(gdm_session_relay_setup_for_user),
	(gdm_session_relay_authenticate), (gdm_session_relay_authorize),
	(gdm_session_relay_accredit), (gdm_session_relay_answer_query),
	(handle_setup_complete), (handle_setup_failed),
	(handle_authenticated), (handle_authentication_failed),
	(handle_authorized), (handle_authorization_failed),
	(handle_accredited), (handle_accreditation_failed),
	(handle_session_started), (handle_session_stopped),
	(handle_opened), (session_handle_child_message), (do_introspect),
	(gdm_session_iface_init):
	* daemon/gdm-session-worker.c: (gdm_session_execute),
	(gdm_session_worker_update_username),
	(gdm_session_worker_initialize_pam),
	(gdm_session_worker_accredit_user), (session_worker_child_watch),
	(gdm_session_worker_start_user_session), (do_setup),
	(do_authenticate), (do_authorize), (do_accredit),
	(do_open_session), (do_start_session), (state_change_idle),
	(on_setup), (on_setup_for_user), (on_authenticate), (on_authorize),
	(on_establish_credentials), (on_renew_credentials),
	(worker_dbus_handle_message):
	* daemon/gdm-session.c: (gdm_session_setup),
	(gdm_session_setup_for_user), (gdm_session_authenticate),
	(gdm_session_authorize), (gdm_session_accredit),
	(gdm_session_class_init), (_gdm_session_setup_complete),
	(_gdm_session_setup_failed), (_gdm_session_reset_complete),
	(_gdm_session_reset_failed), (_gdm_session_authenticated),
	(_gdm_session_authentication_failed), (_gdm_session_authorized),
	(_gdm_session_authorization_failed), (_gdm_session_accredited),
	(_gdm_session_accreditation_failed),
	(_gdm_session_session_start_failed):
	* daemon/gdm-session.h:
	* daemon/gdm-simple-slave.c: (greeter_reset_timeout),
	(queue_greeter_reset), (on_session_setup_complete),
	(on_session_setup_failed), (on_session_reset_complete),
	(on_session_reset_failed), (on_session_authenticated),
	(on_session_authentication_failed), (on_session_authorized),
	(on_session_authorization_failed), (on_session_accredited),
	(on_session_accreditation_failed), (create_new_session),
	(on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user):
	* daemon/test-session.c: (on_open), (on_session_setup_complete),
	(on_session_setup_failed), (on_session_reset_complete),
	(on_session_reset_failed), (on_session_authenticated),
	(on_session_authentication_failed), (on_session_authorized),
	(on_session_authorization_failed), (on_session_accredited),
	(on_session_accreditation_failed), (on_session_started),
	(on_session_exited), (on_session_died), (main):
	Split up the Verification step in the GdmSession interface into
	component parts: setup, authenticate, authorize, accredit.

2007-11-06  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c: (send_dbus_void_method),
	(send_authenticated), (send_session_startup_failed),
	(send_authentication_failed), (send_authorization_failed),
	(send_accreditation_failed), (gdm_session_worker_initialize_pam),
	(gdm_session_worker_authenticate_user),
	(gdm_session_worker_accredit_user),
	(gdm_session_worker_start_user_session),
	(gdm_session_worker_open_user_session), (do_initialize),
	(do_authenticate), (do_authorize), (do_accredit),
	(do_open_session), (do_start_session), (state_change_idle),
	(queue_state_change), (on_start_program), (on_begin_verification),
	(on_begin_verification_for_user):
	Make worker internally use a state machine.

2007-11-06  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c:
	(gdm_session_worker_uninitialize_pam),
	(gdm_session_worker_authenticate_user),
	(gdm_session_worker_authorize_user),
	(gdm_session_worker_give_user_credentials),
	(gdm_session_worker_open_user_session),
	(gdm_session_worker_start_program):
	* daemon/gdm-session-worker.h:
	Make a bit more like a state machine.  This will make it easier to
	separate the steps but make sure they occur in the proper order.

2007-11-05  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c: (choose_user_id),
	(on_user_added), (on_user_removed), (on_user_is_logged_in_changed):
	* gui/simple-greeter/gdm-user-manager.c:
	(on_user_sessions_changed), (on_user_icon_changed), (create_user),
	(add_new_user_for_pwent), (get_current_seat_id),
	(get_uid_from_session_id), (seat_session_added),
	(seat_session_removed), (on_proxy_destroy), (get_seat_proxy),
	(gdm_user_manager_get_user), (reload_passwd),
	(gdm_user_manager_init), (gdm_user_manager_finalize):
	* gui/simple-greeter/gdm-user-private.h:
	* gui/simple-greeter/gdm-user.c: (session_compare),
	(_gdm_user_add_session), (_gdm_user_remove_session):
	Use ConsoleKit to drive populate the list of sessions for each user.

2007-11-04  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c: (on_user_added),
	(on_user_is_logged_in_changed):
	* gui/simple-greeter/gdm-user.c: (gdm_user_get_num_sessions),
	(gdm_user_init):
	More session list stuff.

2007-11-04  William Jon McCann  <mccannwj@acsnb1>

	* gui/simple-greeter/gdm-user-manager.c: (reload_passwd):
	* gui/simple-greeter/gdm-user-private.h:
	* gui/simple-greeter/gdm-user.c: (_gdm_user_add_session),
	(_gdm_user_remove_session), (gdm_user_get_property),
	(gdm_user_class_init):
	* gui/simple-greeter/gdm-user.h:
	Add back the session list to GdmUser.

2007-11-02  William Jon McCann  <mccann@jhu.edu>

	* data/gdm.conf:
	Block Settings.SetValue by default in the dbus security policy.

2007-11-02  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-settings-keys.h:
	* common/gdm-settings.c: (gdm_settings_set_value):
	* common/test-settings-client.c: (test_settings_client):
	Remove obsolete config keys.  Add examples for
	using dbus-send.  Fix return value of SetValue.

2007-11-01  William Jon McCann  <mccann@jhu.edu>

	* Makefile.am:
	* data/Makefile.am:
	Fix build.

2007-11-01  William Jon McCann  <mccann@jhu.edu>

	* config/.cvsignore:
	Remove config dir.

2007-11-01  William Jon McCann  <mccann@jhu.edu>

	* config/Init.in:
	* config/Makefile.am:
	* config/PostLogin:
	* config/PostSession.in:
	* config/PreSession.in:
	* config/Xsession.in:
	* config/gdm:
	* config/gdm-autologin:
	* config/gdm.conf-custom.in:
	* configure.ac:
	* data/Makefile.am:
	Move stuff from config to data.

2007-11-01  William Jon McCann  <mccann@jhu.edu>

	* config/Makefile.am:
	* config/gdm.conf-custom.in:
	* config/gdm.conf.in:
	* data/gdm.schemas.in.in:
	Kill config options that we don't use.

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* configure.ac: Fix typo

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	Add Xau and Xext to XLIB_LIBS when x11.pc isn't
	found.  Fixes #492022 more

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/Makefile.am:
	If x11.pc doesn't exist then try a fallback.
	Fixes #492022

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-direct.c: (gdm_session_direct_start_session):
	This patch is sort of the minimum we need to get the session run
	through Xsession (which makes sure ssh-agent/dbus/etc get
	started).
	Patch from: Ray Strode <halfline@gmail.com>

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c:
	(gdm_session_worker_uninitialize_pam):
	change error_code to status to make it clear
	it isn't just for errors.

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c: (session_worker_child_watch):
	make sure we close the session on logout
	Patch from: Ray Strode <halfline@gmail.com>

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* configure.ac: Post release version bump

==== 2.21.1 ====

2007-10-31  William Jon McCann  <mccann@jhu.edu>

	* NEWS: Update for release

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/INTERNALS: Update with new GdmSession interface.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-direct.c: (send_begin_verification),
	(send_begin_verification_for_user), (open_ck_session):
	* daemon/gdm-session-record.c: (record_set_host),
	(record_set_line):
	Be careful about sending NULLs over DBus and etc.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c: (send_dbus_string_method),
	(send_dbus_int_method), (send_user_verified),
	(send_question_method), (gdm_session_worker_start_program):
	Convert some warnings to debugs

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (on_session_user_verified):
	* daemon/gdm-product-slave.c: (send_dbus_string_method),
	(send_dbus_void_method), (relay_session_started),
	(relay_session_opened), (on_session_opened), (disconnect_relay),
	(on_session_started), (on_session_exited), (on_session_died),
	(on_session_user_verified), (on_session_user_verification_error),
	(on_session_info), (on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_relay_begin_verification),
	(on_relay_begin_verification_for_user), (on_relay_answer_query),
	(on_relay_session_selected), (on_relay_language_selected),
	(on_relay_user_selected), (on_relay_open),
	(on_relay_start_session), (on_relay_cancelled),
	(relay_dbus_handle_message), (relay_dbus_filter_function),
	(connect_to_session_relay), (gdm_product_slave_init):
	* daemon/gdm-session-worker.c: (worker_dbus_handle_message),
	(worker_dbus_filter_function):
	* gui/simple-greeter/gdm-greeter-client.c:
	(client_dbus_handle_message):
	Convert to libdbus.  Complete the migration to the new GdmSession
	interface.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-background.c:
	(cairo_surface_get_height), (update_surface), (load_image),
	(update_background), (update_geometry),
	(gdm_greeter_background_real_expose),
	(gdm_greeter_background_real_configure):
	* gui/simple-greeter/gdm-greeter-client.c:
	(emit_string_signal_for_message), (on_ready), (on_reset),
	(send_dbus_string_method), (send_dbus_void_method),
	(send_get_display_id), (cache_display_values),
	(client_dbus_filter_function), (gdm_greeter_client_start),
	(gdm_greeter_client_dispose):
	* gui/simple-greeter/gdm-greeter-login-window.c: (reset_dialog),
	(gdm_greeter_login_window_info),
	(gdm_greeter_login_window_problem),
	(gdm_greeter_login_window_info_query):
	* gui/simple-greeter/gdm-greeter-session.c: (on_info),
	(on_problem), (on_ready), (on_reset), (on_selected_user_changed),
	(on_info_query), (on_secret_info_query), (toggle_login_window),
	(launch_compiz), (launch_metacity), (start_settings_daemon),
	(gdm_greeter_session_dispose):
	* gui/simple-greeter/gdm-session-client.c:
	(gdm_session_client_start), (gdm_session_client_stop):
	* gui/simple-greeter/gdm-session-manager.c:
	(gdm_session_manager_load_autostart_dir), (_change_level):
	Prefix debug messages with class name to make output easier to read.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-local-display-factory.c: (create_display_for_device):
	oops that sneaked in.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-signal-handler.c: (signal_io_watch), (catch_signal),
	(uncatch_signal), (gdm_signal_handler_add),
	(gdm_signal_handler_remove_and_free_data),
	(gdm_signal_handler_finalize):
	* daemon/gdm-display-store.c: (gdm_display_store_clear),
	(gdm_display_store_remove), (gdm_display_store_add),
	(display_unref):
	* daemon/gdm-factory-slave.c: (on_greeter_start),
	(on_greeter_stop), (on_session_info), (on_session_problem),
	(on_session_info_query), (on_session_secret_info_query),
	(on_session_opened), (on_session_user_verified),
	(on_session_user_verification_error), (on_session_session_started),
	(create_product_display), (on_session_relay_disconnected),
	(on_session_relay_connected), (on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user), (on_greeter_answer),
	(on_greeter_connected), (run_greeter), (idle_connect_to_display),
	(server_ready_cb), (gdm_factory_slave_run),
	(gdm_factory_slave_start), (gdm_factory_slave_stop),
	(gdm_factory_slave_finalize):
	* daemon/gdm-greeter-server.c: (send_dbus_message),
	(send_dbus_string_signal), (send_dbus_void_signal),
	(handle_begin_verification), (handle_begin_verification_for_user),
	(handle_answer_query), (handle_select_session),
	(handle_select_hostname), (handle_select_language),
	(handle_select_user), (do_introspect),
	(connection_filter_function), (handle_connection),
	(gdm_greeter_server_start), (gdm_greeter_server_stop):
	* daemon/gdm-greeter-session.c: (listify_hash),
	(open_greeter_session), (greeter_session_child_watch),
	(spawn_child_setup), (start_dbus_daemon),
	(gdm_greeter_session_spawn), (gdm_greeter_session_start),
	(wait_on_child), (greeter_session_died),
	(gdm_greeter_session_stop):
	* daemon/gdm-local-display-factory.c: (create_display_for_device),
	(create_displays_for_pci_devices):
	* daemon/gdm-manager.c: (gdm_manager_start),
	(gdm_manager_set_wait_for_go), (remove_displays_for_connection),
	(bus_name_owner_changed):
	* daemon/gdm-product-display.c:
	(gdm_product_display_get_relay_address):
	* daemon/gdm-product-slave.c: (on_session_opened),
	(on_session_started), (on_session_exited), (on_session_died),
	(gdm_product_slave_create_server), (on_session_user_verified),
	(on_session_user_verification_error), (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_relay_begin_verification),
	(on_relay_begin_verification_for_user), (on_relay_answer),
	(on_relay_session_selected), (on_relay_language_selected),
	(on_relay_user_selected), (create_new_session),
	(on_relay_cancelled), (session_relay_proxy_destroyed),
	(get_relay_address), (connect_to_session_relay),
	(gdm_product_slave_stop):
	* daemon/gdm-server.c: (_gdm_server_query_ck_for_display_device),
	(emit_ready_idle), (connect_to_parent), (change_user),
	(server_child_setup), (server_child_watch), (gdm_server_spawn),
	(wait_on_child), (server_died), (gdm_server_stop):
	* daemon/gdm-session-direct.c: (send_dbus_string_signal),
	(gdm_session_direct_handle_verified),
	(gdm_session_direct_handle_verification_failed),
	(gdm_session_direct_handle_username_changed),
	(cancel_pending_query), (gdm_session_direct_handle_info_query),
	(gdm_session_direct_handle_secret_info_query),
	(gdm_session_direct_handle_info),
	(gdm_session_direct_handle_problem),
	(gdm_session_direct_handle_session_started),
	(gdm_session_direct_handle_startup_failed),
	(gdm_session_direct_handle_session_exited),
	(gdm_session_direct_handle_session_died), (do_introspect),
	(session_message_handler), (allow_user_function),
	(handle_connection), (setup_server), (worker_stopped),
	(worker_started), (worker_exited), (worker_died),
	(gdm_session_direct_open), (send_begin_verification),
	(send_begin_verification_for_user), (send_environment_variable),
	(get_session_command_for_file), (gdm_session_direct_close),
	(_gdm_session_direct_set_display_device),
	(gdm_session_direct_dispose):
	* daemon/gdm-session-relay.c: (send_dbus_message),
	(send_dbus_string_signal), (send_dbus_void_signal),
	(gdm_session_relay_begin_verification),
	(gdm_session_relay_begin_verification_for_user),
	(gdm_session_relay_answer_query), (handle_info_query),
	(handle_secret_info_query), (handle_info), (handle_problem),
	(handle_user_verified), (handle_user_verification_error),
	(handle_session_started), (handle_session_stopped),
	(handle_opened), (handle_reset), (do_introspect),
	(session_relay_message_handler), (connection_filter_function),
	(handle_connection), (gdm_session_relay_start),
	(gdm_session_relay_stop):
	* daemon/gdm-session-worker-job.c:
	(session_worker_job_child_watch), (gdm_session_worker_job_spawn),
	(gdm_session_worker_job_start), (wait_on_child),
	(session_worker_job_died), (gdm_session_worker_job_stop):
	* daemon/gdm-session-worker.c: (send_dbus_string_method),
	(send_dbus_int_method), (send_user_verified),
	(gdm_session_worker_get_username),
	(gdm_session_worker_update_username), (send_question_method),
	(gdm_session_worker_process_pam_message),
	(gdm_session_worker_pam_new_messages_handler),
	(gdm_session_worker_uninitialize_pam),
	(gdm_session_worker_initialize_pam),
	(gdm_session_worker_authenticate_user),
	(gdm_session_worker_authorize_user),
	(gdm_session_worker_verify_user), (session_worker_child_watch),
	(gdm_session_worker_open_user_session), (gdm_session_worker_open),
	(on_set_environment_variable), (on_start_program), (open_idle),
	(on_begin_verification), (on_begin_verification_for_user),
	(worker_dbus_filter_function), (gdm_session_worker_constructor):
	* daemon/gdm-simple-slave.c: (on_session_started),
	(on_session_exited), (on_session_died), (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_session_opened),
	(on_session_selected_user_changed), (create_new_session),
	(on_greeter_start), (on_greeter_stop),
	(on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user),
	(on_greeter_user_selected), (on_greeter_cancel),
	(on_greeter_connected), (run_greeter), (gdm_simple_slave_run),
	(gdm_simple_slave_stop):
	* daemon/gdm-slave-proxy.c: (child_watch), (spawn_slave),
	(gdm_slave_proxy_stop), (gdm_slave_proxy_dispose):
	* daemon/gdm-slave.c: (listify_hash), (gdm_slave_run_script),
	(set_local_auth), (gdm_slave_connect_to_x11_display),
	(display_proxy_destroyed_cb), (gdm_slave_real_start),
	(gdm_slave_real_stop), (gdm_slave_start), (gdm_slave_stop),
	(gdm_slave_constructor):
	* daemon/gdm-static-factory-display.c:
	(gdm_static_factory_display_create_product_display):
	* daemon/gdm-xdmcp-display-factory.c: (debug_addrinfo), (do_bind),
	(setup_multicast), (open_port), (gdm_xdmcp_send_willing),
	(gdm_xdmcp_send_unwilling), (gdm_xdmcp_send_forward_query),
	(gdm_forward_query_dispose), (gdm_forward_query_lookup),
	(gdm_xdmcp_handle_forward_query),
	(gdm_xdmcp_really_send_managed_forward),
	(gdm_xdmcp_send_got_managed_forward), (display_dispose_check),
	(gdm_xdmcp_send_decline), (gdm_xdmcp_display_alloc),
	(gdm_xdmcp_send_accept), (gdm_xdmcp_handle_request),
	(gdm_xdmcp_send_failed), (gdm_xdmcp_send_refuse),
	(gdm_xdmcp_handle_manage), (gdm_xdmcp_handle_managed_forward),
	(gdm_xdmcp_handle_got_managed_forward), (gdm_xdmcp_send_alive),
	(gdm_xdmcp_handle_keepalive), (decode_packet),
	(gdm_xdmcp_display_factory_start):
	* daemon/gdm-xdmcp-display.c: (gdm_xdmcp_display_create_authority),
	(gdm_xdmcp_display_add_user_authorization):
	Prefix debug messages with class name to make output easier to read.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-direct.c: (stop_worker),
	(gdm_session_direct_close):
	Make a stop_worker function for symmetry.

	* daemon/session-worker-main.c: (main):
	Add gdm_set_fatal_warnings_if_unstable

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-server.c: (send_dbus_message),
	(send_dbus_string_signal),
	(gdm_greeter_server_selected_user_changed), (do_introspect):
	* daemon/gdm-greeter-server.h:
	* daemon/gdm-session-worker.c: (send_dbus_string_method),
	(gdm_session_worker_get_username),
	(gdm_session_worker_process_pam_message),
	(worker_dbus_filter_function):
	* daemon/gdm-simple-slave.c: (on_session_selected_user_changed):
	* gui/simple-greeter/gdm-greeter-client.c:
	(emit_string_signal_for_message), (on_selected_user_changed),
	(on_info_query), (on_secret_info_query), (on_info), (on_problem),
	(on_ready), (on_reset), (send_dbus_string_method),
	(send_dbus_void_method),
	(gdm_greeter_client_call_begin_verification),
	(gdm_greeter_client_call_begin_verification_for_user),
	(gdm_greeter_client_call_answer_query),
	(gdm_greeter_client_call_select_session),
	(gdm_greeter_client_call_select_language),
	(gdm_greeter_client_call_select_user),
	(gdm_greeter_client_call_select_hostname),
	(gdm_greeter_client_call_cancel),
	(gdm_greeter_client_call_disconnect), (send_get_display_id),
	(gdm_greeter_client_call_get_display_id),
	(client_dbus_handle_message), (client_dbus_filter_function),
	(gdm_greeter_client_start), (gdm_greeter_client_class_init):
	* gui/simple-greeter/gdm-greeter-client.h:
	* gui/simple-greeter/gdm-greeter-session.c: (on_info),
	(on_problem), (on_ready), (on_reset), (on_selected_user_changed),
	(on_info_query), (on_secret_info_query),
	(gdm_greeter_session_init):
	Convert the GreeterClient to use dbus instead of dbus-glib.  Add
	support for the SelectedUserChanged signal.

2007-10-30  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_init):
	Make checkbox column smaller.

2007-10-29  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/gdm-factory-slave.c: (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_session_opened),
	(on_session_user_verified), (on_session_user_verification_error),
	(on_session_session_started), (create_product_display),
	(on_session_relay_disconnected), (on_session_relay_connected),
	(on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user), (on_greeter_answer),
	(on_greeter_session_selected), (on_greeter_language_selected),
	(on_greeter_user_selected), (on_greeter_cancel),
	(gdm_factory_slave_start), (gdm_factory_slave_stop):
	* daemon/gdm-product-slave.c: (setup_server),
	(add_user_authorization), (setup_session),
	(on_session_user_verified), (on_relay_start_session),
	(on_relay_begin_verification),
	(on_relay_begin_verification_for_user), (on_relay_answer),
	(reset_session), (on_relay_open), (create_new_session),
	(on_relay_cancelled), (connect_to_session_relay),
	(gdm_product_slave_stop):
	* daemon/gdm-session-direct.c: (on_user_verification_error),
	(on_session_started), (on_session_startup_error),
	(on_session_exited), (gdm_session_direct_handle_verified),
	(gdm_session_direct_handle_verification_failed),
	(gdm_session_direct_handle_username_changed),
	(gdm_session_direct_handle_info_query),
	(gdm_session_direct_handle_secret_info_query),
	(gdm_session_direct_handle_info),
	(gdm_session_direct_handle_problem),
	(gdm_session_direct_handle_session_started),
	(gdm_session_direct_handle_startup_failed),
	(gdm_session_direct_handle_session_exited),
	(gdm_session_direct_handle_session_died), (handle_connection),
	(gdm_session_direct_init), (worker_exited), (worker_died),
	(gdm_session_direct_open), (send_begin_verification),
	(send_begin_verification_for_user),
	(gdm_session_direct_begin_verification),
	(gdm_session_direct_begin_verification_for_user),
	(is_prog_in_path), (get_session_command_for_file),
	(get_session_command), (open_ck_session),
	(setup_session_environment), (gdm_session_direct_start_session),
	(gdm_session_direct_close), (gdm_session_direct_answer_query),
	(gdm_session_direct_cancel), (gdm_session_direct_get_username),
	(gdm_session_direct_select_session),
	(gdm_session_direct_select_language),
	(gdm_session_direct_select_user),
	(_gdm_session_direct_set_display_name),
	(_gdm_session_direct_set_display_hostname),
	(_gdm_session_direct_set_display_device),
	(_gdm_session_direct_set_user_x11_authority_file),
	(_gdm_session_direct_set_display_is_local),
	(gdm_session_direct_set_property),
	(gdm_session_direct_get_property), (gdm_session_direct_dispose),
	(gdm_session_direct_finalize), (gdm_session_iface_init),
	(gdm_session_direct_class_init), (gdm_session_direct_new):
	* daemon/gdm-session-direct.h:
	* daemon/gdm-session-private.h:
	* daemon/gdm-session-relay.c: (gdm_session_relay_open),
	(gdm_session_relay_close), (gdm_session_relay_begin_verification),
	(gdm_session_relay_begin_verification_for_user),
	(gdm_session_relay_answer_query),
	(gdm_session_relay_select_session),
	(gdm_session_relay_select_language),
	(gdm_session_relay_select_user), (gdm_session_relay_cancel),
	(gdm_session_relay_start_session), (handle_info_query),
	(handle_secret_info_query), (handle_info), (handle_problem),
	(handle_user_verified), (handle_user_verification_error),
	(handle_session_started), (handle_session_stopped),
	(handle_opened), (handle_reset), (do_introspect),
	(handle_connection), (gdm_session_iface_init),
	(gdm_session_relay_class_init):
	* daemon/gdm-session-relay.h:
	* daemon/gdm-session.c: (gdm_session_get_type), (gdm_session_open),
	(gdm_session_close), (gdm_session_begin_verification),
	(gdm_session_begin_verification_for_user),
	(gdm_session_answer_query), (gdm_session_select_session),
	(gdm_session_select_language), (gdm_session_select_user),
	(gdm_session_cancel), (gdm_session_start_session),
	(gdm_session_class_init), (_gdm_session_user_verified),
	(_gdm_session_user_verification_error), (_gdm_session_info_query),
	(_gdm_session_secret_info_query), (_gdm_session_info),
	(_gdm_session_problem), (_gdm_session_session_started),
	(_gdm_session_session_startup_error),
	(_gdm_session_session_exited), (_gdm_session_session_died),
	(_gdm_session_opened), (_gdm_session_closed),
	(_gdm_session_selected_user_changed):
	* daemon/gdm-session.h:
	* daemon/gdm-simple-slave.c: (on_session_started),
	(on_session_exited), (on_session_died), (on_session_user_verified),
	(on_session_user_verification_error), (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_session_opened),
	(on_session_selected_user_changed), (create_new_session),
	(on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user), (on_greeter_answer),
	(on_greeter_session_selected), (on_greeter_language_selected),
	(on_greeter_cancel), (on_greeter_connected),
	(gdm_simple_slave_stop), (gdm_simple_slave_init):
	* daemon/test-session.c: (on_open), (on_session_started),
	(on_session_exited), (on_session_died), (on_user_verified),
	(on_user_verification_error), (on_info_query), (on_info),
	(on_problem), (on_secret_info_query), (import_environment), (main):
	Make SessionRelay and SessionDirect (was Session) implement a common
	interface GdmSession.  Push some code that lived in the simple and product
	slaves into the SessionDirect class.  Using an interface has a few
	advantages besides ensuring consistency: makes it easier to do some
	abstraction in the slave classes, makes it possible to more easily
	implement other non-pam backends.

	Add a stub for a selected-user-changed signal from the session interface.
	This will be used to update the user selection in the greeter when the
	user is set from the backend.

2007-10-29  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/gdm-product-slave.c: (on_session_opened),
	(on_session_started), (on_session_exited), (on_session_died),
	(slave_open_ck_session), (setup_session_environment),
	(setup_session), (on_session_user_verified),
	(on_session_user_verification_error), (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_relay_begin_verification),
	(on_relay_begin_verification_for_user), (on_relay_answer),
	(reset_session), (on_relay_open), (create_new_session),
	(on_relay_cancelled), (gdm_product_slave_stop):
	* daemon/gdm-session-direct.c: (gdm_session_direct_error_quark),
	(send_dbus_string_signal),
	(gdm_session_direct_user_verification_error_handler),
	(gdm_session_direct_started_handler),
	(gdm_session_direct_startup_error_handler),
	(gdm_session_direct_exited_handler),
	(gdm_session_direct_class_install_signals),
	(gdm_session_direct_finalize), (gdm_session_direct_class_init),
	(gdm_session_direct_handle_verified),
	(gdm_session_direct_handle_verification_failed),
	(gdm_session_direct_handle_username_changed),
	(cancel_pending_query), (answer_pending_query),
	(set_pending_query), (gdm_session_direct_handle_info_query),
	(gdm_session_direct_handle_secret_info_query),
	(gdm_session_direct_handle_info),
	(gdm_session_direct_handle_problem),
	(gdm_session_direct_handle_session_started),
	(gdm_session_direct_handle_startup_failed),
	(gdm_session_direct_handle_session_exited),
	(gdm_session_direct_handle_session_died), (session_worker_message),
	(handle_connection), (setup_server), (gdm_session_direct_init),
	(gdm_session_direct_new), (worker_stopped), (worker_started),
	(worker_exited), (worker_died), (start_worker),
	(gdm_session_direct_open), (send_begin_verification),
	(send_begin_verification_for_user),
	(gdm_session_direct_begin_verification),
	(send_environment_variable), (send_environment),
	(gdm_session_direct_start_program), (gdm_session_direct_close),
	(gdm_session_direct_is_running),
	(gdm_session_direct_set_environment_variable),
	(gdm_session_direct_answer_query),
	(gdm_session_direct_get_username):
	* daemon/gdm-session-direct.h:
	* daemon/gdm-session-relay.h:
	* daemon/gdm-session.c:
	* daemon/gdm-session.h:
	* daemon/gdm-simple-slave.c: (on_session_started),
	(on_session_exited), (on_session_died), (add_user_authorization),
	(slave_open_ck_session), (setup_session_environment),
	(on_session_user_verified), (on_session_user_verification_error),
	(on_session_info), (on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_session_opened),
	(create_new_session), (on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user), (on_greeter_answer),
	(on_greeter_cancel), (on_greeter_connected),
	(gdm_simple_slave_stop):
	* daemon/gdm-slave.c:
	* daemon/test-session.c: (on_open), (on_session_started),
	(on_session_exited), (on_session_died), (on_user_verified),
	(on_user_verification_error), (on_info_query), (on_info),
	(on_problem), (on_secret_info_query), (import_environment), (main):
	Rename GdmSession to GdmSessionDirect in preparation for adding
	a GdmSession interface.  Naming is hard.

2007-10-29  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (setup_server), (run_greeter),
	(idle_connect_to_display):
	* daemon/gdm-product-slave.c: (setup_server):
	* daemon/gdm-simple-slave.c: (setup_server), (run_greeter),
	(idle_connect_to_display):
	Remove some unused code and make the slaves use similar code.

2007-10-29  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (run_greeter):
	* daemon/gdm-product-slave.c: (setup_server):
	* daemon/gdm-simple-slave.c: (run_greeter):
	* daemon/gdm-slave.c: (gdm_slave_whack_temp_auth_file),
	(create_temp_auth_file), (listify_hash), (get_script_environment),
	(gdm_slave_run_script):
	* daemon/gdm-slave.h:
	Move the exec_script stuff to the base class.

2007-10-29  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-server.c: (connection_filter_function):
	Don't handle object messages in filter func.

	* daemon/gdm-xdmcp-display-factory.c: (gdm_xdmcp_handle_request):
	Add debug for cookie.

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_constructor),
	(gdm_greeter_login_window_class_init),
	(gdm_greeter_login_window_init):
	Load theme in constructor so we get properties.

	* gui/simple-greeter/gdm-greeter-session.c: (toggle_login_window):
	Add debug.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(get_logged_in_pixbuf), (populate_model), (on_user_added),
	(on_user_is_logged_in_changed), (name_cell_data_func),
	(check_cell_data_func), (gdm_user_chooser_widget_init):
	* gui/simple-greeter/gdm-user-manager.c: (reload_passwd),
	(gdm_user_manager_class_init):
	* gui/simple-greeter/gdm-user-manager.h:
	* gui/simple-greeter/gdm-user-private.h:
	* gui/simple-greeter/gdm-user.c: (gdm_user_get_property),
	(gdm_user_class_init), (gdm_user_init), (gdm_user_is_logged_in),
	(render_icon_from_home):
	* gui/simple-greeter/gdm-user.h:
	Add some baseline stuff for getting logged in status.
	Add a new pixbuf column to show a checkmark for logged in users.
	Also nicely serves as a way to indent the userlist.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c: (clear_selection),
	(gdm_user_chooser_widget_set_chosen_user_name), (on_row_activated):
	Clear the selection after a user is chosen

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c: (on_user_removed):
	* gui/simple-greeter/gdm-user.h:
	Remove deleted users from the model

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(get_pixbuf_for_user), (on_user_added):
	* gui/simple-greeter/gdm-user.c: (check_user_file),
	(render_icon_from_home), (gdm_user_render_icon):
	Add loading face images.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode),
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_init):
	Spread the buttons in user-select mode.  Add some padding
	to the pixbuf column.  Make a bit less transparent.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Use a horizontal button style.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_size_request):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Set the default width of the login window.  Tweak
	some spacing.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user), (run_greeter):
	* daemon/gdm-greeter-server.c: (handle_begin_verification),
	(handle_begin_verification_for_user),
	(greeter_handle_child_message), (do_introspect),
	(gdm_greeter_server_class_init):
	* daemon/gdm-greeter-server.h:
	* daemon/gdm-product-slave.c: (on_relay_begin_verification),
	(on_relay_begin_verification_for_user), (connect_to_session_relay):
	* daemon/gdm-session-relay.c:
	(gdm_session_relay_begin_verification),
	(gdm_session_relay_begin_verification_for_user):
	* daemon/gdm-session-relay.h:
	* daemon/gdm-simple-slave.c: (on_greeter_begin_verification),
	(on_greeter_begin_verification_for_user), (run_greeter):
	* gui/simple-greeter/gdm-greeter-client.c:
	(gdm_greeter_client_call_begin_verification),
	(gdm_greeter_client_call_begin_verification_for_user):
	* gui/simple-greeter/gdm-greeter-client.h:
	* gui/simple-greeter/gdm-greeter-login-window.c: (on_user_chosen),
	(gdm_greeter_login_window_class_init):
	* gui/simple-greeter/gdm-greeter-login-window.h:
	* gui/simple-greeter/gdm-greeter-session.c:
	(on_begin_verification), (on_begin_verification_for_user),
	(toggle_login_window):
	* gui/simple-greeter/gdm-user-chooser-widget.c: (populate_model),
	(user_visible_cb):
	* gui/simple-greeter/gdm-user-chooser-widget.h:
	Add a begin-verification-for-user.  Make clicking other
	start begin-verification to bring up a username prompt.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c: (activate_name),
	(gdm_user_chooser_widget_dispose), (populate_model),
	(gdm_user_chooser_widget_init), (gdm_user_chooser_widget_finalize):
	Remove some unneeded code.  Populate the model in an idle.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-user-chooser-dialog.c:
	(gdm_user_chooser_dialog_init):
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_set_show_other_user),
	(gdm_user_chooser_widget_set_show_guest_user), (populate_model),
	(compare_user_names), (on_user_added), (user_visible_cb):
	* gui/simple-greeter/gdm-user-chooser-widget.h:
	Add guest/other "special" items to user list.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/gdm-product-slave.c: (slave_open_ck_session),
	(setup_session_environment), (gdm_product_slave_init):
	Register CK session for product slave.  Boy we have
	to do something about this divergence problem...

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode):
	Unexpand the userlist when asking for the password.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(add_user_to_model), (compare_user), (on_user_added),
	(name_cell_data_func), (gdm_user_chooser_widget_init):
	Add some support for logged in status.

2007-10-27  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c: (send_dbus_string_method),
	(send_dbus_int_method), (send_user_verified),
	(send_startup_failed), (send_session_exited), (send_session_died),
	(send_username_changed), (send_user_verification_error),
	(send_session_started), (send_question_method),
	(gdm_session_worker_ask_question),
	(gdm_session_worker_ask_for_secret),
	(gdm_session_worker_report_info),
	(gdm_session_worker_report_problem),
	(gdm_session_worker_process_pam_message),
	(gdm_session_worker_pam_new_messages_handler),
	(on_set_environment_variable), (on_start_program),
	(on_begin_verification), (on_begin_verification_for_user),
	(worker_dbus_handle_message), (worker_dbus_filter_function),
	(gdm_session_worker_constructor):
	* daemon/gdm-session.c: (cancel_pending_query),
	(handle_connection), (gdm_session_close):
	* daemon/session-worker-main.c: (signal_cb):
	Make the authentication cancellation much more robust.
	Remove dbus-glib from session-worker.  Fix some problems
	with message handling in the session server.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Fix cancel stock icon.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-simple-slave.c: (on_session_started):
	Remove rogue (ie. undefined) signals.  Caught with
	assertions.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-common.c: (gdm_set_fatal_warnings_if_unstable):
	* common/gdm-common.h:
	* daemon/factory-slave-main.c: (main):
	* daemon/main.c: (main):
	* daemon/product-slave-main.c: (main):
	* daemon/simple-slave-main.c: (main):
	* gui/simple-greeter/greeter-main.c: (main):
	Use assertions for criticals everywhere for unstable
	builds.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode):
	Hide shutdown/restart/suspend buttons on remote displays.
	Can't see ever allowing this.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (do_cancel),
	(reset_dialog):
	Clear selected user when resetting dialog

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-client.c:
	(gdm_greeter_client_class_init):
	Fix typo in signal definition.  Thanks to assertion
	this was easy to find.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-simple-slave.c: (on_greeter_cancel):
	Make sure to set display_is_local

2007-10-26  Ray Strode  <rstrode@redhat.com>

	Get things working with pam_console again

	* daemon/gdm-server.c: (_gdm_server_query_ck_for_display_device),
	(gdm_server_get_display_device): cache display tty instead of
	invoking ck-get-x11-display-device each time.  Add new
	display-device property.

	* daemon/gdm-session-worker.c (_get_tty_for_pam),
	(gdm_session_worker_initialize_pam):
	use display name or tty depending on os

	* daemon/gdm-simple-slave.c (on_greeter_cancel),
	(on_greeter_connected):  don't hard code "/dev/console" for display
	device.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode):
	Make sure the default button is set.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (do_cancel),
	(on_user_chosen), (gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-user-chooser-dialog.c:
	(gdm_user_chooser_dialog_get_chosen_user_name),
	(gdm_user_chooser_dialog_init):
	* gui/simple-greeter/gdm-user-chooser-dialog.h:
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_set_show_only_chosen),
	(gdm_user_chooser_widget_get_chosen_user_name), (activate_name),
	(choose_user_id), (choose_selected_user),
	(gdm_user_chooser_widget_set_chosen_user_name),
	(gdm_user_chooser_widget_dispose),
	(gdm_user_chooser_widget_class_init), (on_selection_changed),
	(on_row_activated), (add_user_to_model), (on_user_added),
	(user_visible_cb), (gdm_user_chooser_widget_init):
	* gui/simple-greeter/gdm-user-chooser-widget.h:
	* gui/simple-greeter/test-user-chooser.c: (main):
	Hide other users when one is chosen.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (switch_mode),
	(do_cancel), (reset_dialog), (on_user_activated), (load_theme),
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Get rid of notebook.  Put auth prompt box in main page.
	Make visible on demand and hope to animate at some point.
	Also a few spacing tweaks.

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-signal-handler.c: (gdm_signal_handler_init),
	(gdm_signal_handler_finalize): only call signal_list_free on
	elements in signal lookup hash table, when the hash table is about
	to be destroyed. Previously, signal_list_free was set up as the
	value destroy notifier.  The problem is the destroy notifier gets
	called on every g_hash_table_insert call (well except for the
	first one), so the list being appended to/reinserted was getting
	clobbered.

	Patch from: Ray Strode <halfline@gmail.com>

2007-10-26  William Jon McCann  <mccann@jhu.edu>

	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-manager.c:
	Add locale.h to fix build
	Patch from: Ray Strode <halfline@gmail.com>

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-session.c: (toggle_panel),
	(start_settings_daemon):
	Use new gdm-settings-daemon.  Disable panel for now.

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/settings-daemon/plugins/xsettings/Makefile.am:
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-manager.c:
	(translate_bool_int), (translate_int_int),
	(translate_string_string), (translate_string_string_toolbar),
	(dpi_from_pixels_and_mm), (get_dpi_from_x_server),
	(get_dpi_from_gconf_or_x_server), (xft_settings_get),
	(xft_settings_set_xsettings), (write_all), (child_watch_cb),
	(spawn_with_input), (xft_settings_set_xresources),
	(update_xft_settings), (xft_callback), (type_to_string),
	(process_value), (gdm_xsettings_manager_start),
	(gdm_xsettings_manager_stop), (gdm_xsettings_manager_set_property),
	(gdm_xsettings_manager_get_property),
	(gdm_xsettings_manager_constructor),
	(gdm_xsettings_manager_dispose),
	(gdm_xsettings_manager_class_init), (find_translation_entry),
	(xsettings_callback), (register_config_callback), (terminate_cb),
	(gdm_xsettings_manager_init), (gdm_xsettings_manager_finalize),
	(gdm_xsettings_manager_new):
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-manager.h:
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-plugin.c:
	(gdm_xsettings_plugin_init), (gdm_xsettings_plugin_finalize),
	(impl_activate), (impl_deactivate),
	(gdm_xsettings_plugin_class_init):
	* gui/settings-daemon/plugins/xsettings/xsettings-common.c:
	(xsettings_setting_copy), (xsettings_list_copy),
	(xsettings_setting_equal), (xsettings_setting_free),
	(xsettings_list_free), (xsettings_list_insert),
	(xsettings_list_delete), (xsettings_list_lookup),
	(xsettings_byte_order):
	* gui/settings-daemon/plugins/xsettings/xsettings-common.h:
	* gui/settings-daemon/plugins/xsettings/xsettings-manager.c:
	(timestamp_predicate), (get_server_time),
	(xsettings_manager_check_running), (xsettings_manager_new),
	(xsettings_manager_destroy), (xsettings_manager_get_window),
	(xsettings_manager_process_event),
	(xsettings_manager_delete_setting),
	(xsettings_manager_set_setting), (xsettings_manager_set_int),
	(xsettings_manager_set_string), (xsettings_manager_set_color),
	(setting_length), (setting_store), (xsettings_manager_notify):
	* gui/settings-daemon/plugins/xsettings/xsettings-manager.h:
	Add an xsettings manager.

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-manager.c (gdm_user_manager_init):
	Convert criticals to warnings.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/settings-daemon/Makefile.am:
	* gui/settings-daemon/plugins/xsettings/Makefile.am:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/libnotificationarea/Makefile.am:
	OMFG - I hate you.  Add gmodule to SETTINGS_DAEMON modules so we don't get:
	undefined symbol: gdm_settings_plugin_get_type
	Twiddled some other crap during the screaming.

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/settings-daemon/Makefile.am:
	* gui/settings-daemon/gdm-settings-manager.c:
	(gdm_settings_manager_start), (gdm_settings_manager_stop),
	(gdm_settings_manager_dispose), (gdm_settings_manager_init):
	* gui/settings-daemon/gdm-settings-module.c:
	(gdm_settings_module_load), (gdm_settings_module_unload),
	(gdm_settings_module_get_path), (gdm_settings_module_new_object),
	(gdm_settings_module_init), (gdm_settings_module_finalize),
	(gdm_settings_module_class_init), (gdm_settings_module_new):
	* gui/settings-daemon/gdm-settings-module.h:
	* gui/settings-daemon/gdm-settings-plugin.c: (dummy),
	(gdm_settings_plugin_class_init), (gdm_settings_plugin_init),
	(gdm_settings_plugin_activate), (gdm_settings_plugin_deactivate):
	* gui/settings-daemon/gdm-settings-plugin.h:
	* gui/settings-daemon/gdm-settings-plugins-engine.c:
	(gdm_settings_plugin_info_free),
	(gdm_settings_plugins_engine_load), (compare_plugin_info),
	(gdm_settings_plugins_engine_load_dir),
	(gdm_settings_plugins_engine_load_all),
	(gdm_settings_plugins_engine_init),
	(gdm_settings_plugins_engine_garbage_collect),
	(gdm_settings_plugins_engine_shutdown),
	(gdm_settings_plugins_engine_get_plugins_list),
	(load_plugin_module),
	(gdm_settings_plugins_engine_activate_plugin_real),
	(gdm_settings_plugins_engine_activate_plugin),
	(gdm_settings_plugins_engine_deactivate_plugin_real),
	(gdm_settings_plugins_engine_deactivate_plugin),
	(gdm_settings_plugins_engine_plugin_is_active),
	(gdm_settings_plugins_engine_plugin_is_available),
	(reactivate_all), (gdm_settings_plugins_engine_activate_all),
	(gdm_settings_plugins_engine_get_plugin_name),
	(gdm_settings_plugins_engine_get_plugin_description),
	(gdm_settings_plugins_engine_get_plugin_authors),
	(gdm_settings_plugins_engine_get_plugin_website),
	(gdm_settings_plugins_engine_get_plugin_copyright):
	* gui/settings-daemon/gdm-settings-plugins-engine.h:
	* gui/settings-daemon/main.c: (main):
	* gui/settings-daemon/plugins/Makefile.am:
	* gui/settings-daemon/plugins/xsettings/Makefile.am:
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-plugin.c:
	(gdm_xsettings_plugin_init), (gdm_xsettings_plugin_finalize),
	(impl_activate), (impl_deactivate),
	(gdm_xsettings_plugin_class_init):
	* gui/settings-daemon/plugins/xsettings/gdm-xsettings-plugin.h:
	* gui/settings-daemon/plugins/xsettings/xsettings.gdm-settings-plug
	in.desktop.in:
	Add a stub for xsettings plugin.

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* gui/settings-daemon/Makefile.am:
	* gui/settings-daemon/gdm-settings-manager.c:
	(gdm_settings_manager_start), (gdm_settings_manager_stop),
	(gdm_settings_manager_set_property),
	(gdm_settings_manager_get_property),
	(gdm_settings_manager_constructor), (gdm_settings_manager_dispose),
	(gdm_settings_manager_class_init), (gdm_settings_manager_init),
	(gdm_settings_manager_finalize), (gdm_settings_manager_new):
	* gui/settings-daemon/gdm-settings-manager.h:
	* gui/settings-daemon/main.c: (main):
	Add stub for settings manager class.

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/Makefile.am:
	* gui/settings-daemon/Makefile.am:
	* gui/settings-daemon/main.c: (main):
	* gui/simple-chooser/Makefile.am:
	Add a stub for settings-daemon.

2007-10-25  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/greeter-main.c (set_fatal_warnings):
	Change to abort on criticals not just warnings.

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-session.c:
	(gdm_greeter_session_init):
	* gui/simple-greeter/gdm-session-client.c:
	(gdm_session_client_start), (gdm_session_client_stop):
	* gui/simple-greeter/gdm-session-manager.c:
	(gdm_session_manager_load_autostart_dir),
	(gdm_session_manager_load_system_dirs), (_change_level):
	* gui/simple-greeter/gdm-session-manager.h:
	* gui/simple-greeter/greeter-main.c: (assistive_registry_launch):
	Add autostart for LoginWindow greeter session levels.

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-marshal.list:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-session.c: (toggle_panel),
	(toggle_login_window), (toggle_all_levels),
	(gdm_greeter_session_start), (gdm_greeter_session_init):
	* gui/simple-greeter/gdm-session-client.c:
	(gdm_session_client_start), (gdm_session_client_stop),
	(_gdm_session_client_set_desktop_file),
	(gdm_session_client_set_property),
	(gdm_session_client_get_property), (load_from_desktop_file),
	(gdm_session_client_constructor), (gdm_session_client_dispose),
	(gdm_session_client_class_init), (gdm_session_client_init),
	(gdm_session_client_finalize), (gdm_session_client_new),
	(gdm_session_client_new_from_desktop_file):
	* gui/simple-greeter/gdm-session-client.h:
	* gui/simple-greeter/gdm-session-manager.c: (notify_data_free),
	(add_notify_for_level), (get_next_notify_id),
	(gdm_session_manager_add_notify), (add_client_to_level),
	(gdm_session_manager_add_client),
	(gdm_session_manager_load_autostart_dir),
	(gdm_session_manager_get_level), (_change_level),
	(gdm_session_manager_set_level), (gdm_session_manager_class_init),
	(gdm_session_manager_init):
	* gui/simple-greeter/gdm-session-manager.h:
	Use new session level based system.  Start/stop widgets
	on level transitions.

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-autostart-manager.c:
	* gui/simple-greeter/gdm-autostart-manager.h:
	* gui/simple-greeter/gdm-session-manager.c:
	(gdm_session_manager_start), (gdm_session_manager_init):
	* gui/simple-greeter/gdm-session-manager.h:
	* gui/simple-greeter/gdm-user.c: (gdm_user_set_property),
	(gdm_user_get_property):
	More stubbing.

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-autostart-manager.c:
	(gdm_session_manager_start), (gdm_session_manager_stop),
	(gdm_session_manager_set_property),
	(gdm_session_manager_get_property),
	(gdm_session_manager_constructor), (gdm_session_manager_dispose),
	(gdm_session_manager_class_init), (gdm_session_manager_init),
	(gdm_session_manager_finalize), (gdm_session_manager_new):
	* gui/simple-greeter/gdm-autostart-manager.h:
	Add stub for session manager.

2007-10-24  Ray Strode  <rstrode@redhat.com>

	* daemon/gdm-slave.c:
	* daemon/gdm-session-record.c:
	* daemon/gdm-xdmcp-display-factory.c: cast size_t values
	to int before passing to g_debug, to stop warnings on 64-bit

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* Makefile.am:
	* configure.ac:
	* gui/simple-greeter/Makefile.am:
	* libgreeter/Makefile.am:
	* libgreeter/gdm-greeter.c:
	* libgreeter/gdm-greeter.h:
	Remove libgreeter stuff.

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-background.c:
	(gdm_greeter_background_real_map), (gdm_greeter_background_init):
	* gui/simple-greeter/gdm-greeter-login-window.c:
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-session.c:
	(start_settings_daemon), (gdm_greeter_session_set_level):
	* gui/simple-greeter/greeter-main.c: (assistive_registry_launch),
	(filter_watch), (filter_timeout), (assistive_registry_start),
	(at_set_gtk_modules), (main):
	Start atspi-registryd and xsettings manager.

2007-10-24  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (show_widget),
	(switch_page), (load_theme), (gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	* gui/simple-greeter/test-greeter-login-window.c: (main):
	Add some more buttons.  Toggle button visibility per page.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c:
	(get_system_version):
	Add support for other systems.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-login-window.c: (update_clock),
	(set_clock_timeout), (update_clock_timeout_cb),
	(remove_clock_timeout), (on_computer_info_label_button_press),
	(file_read_one_line), (get_system_version), (get_time_format),
	(create_computer_info), (load_theme),
	(gdm_greeter_login_window_init),
	(gdm_greeter_login_window_finalize):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Add a computer information widget.  Displays info about
	name, version, ip, network-status, and time.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (set_focus),
	(gdm_greeter_login_window_info_query):
	Fix a warning - only set focus if realized

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-session.c: (start_login_window):
	Oops.  Don't send NULL userdata.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-login-window.c: (set_busy),
	(set_ready), (set_focus), (load_theme),
	(gdm_greeter_login_window_size_request),
	(gdm_greeter_login_window_constructor),
	(gdm_greeter_login_window_class_init),
	(gdm_greeter_login_window_init):
	* gui/simple-greeter/gdm-greeter-login-window.glade:
	Only use first child of glade window.
	Set the default window height to be .6 of screen height.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/test-greeter-login-window.c: (main):
	Add a test for login window.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-client.c:
	(gdm_greeter_client_get_display_is_local), (cache_display_values),
	(gdm_greeter_client_start), (gdm_greeter_client_class_init):
	* gui/simple-greeter/gdm-greeter-client.h:
	* gui/simple-greeter/gdm-greeter-login-window.c: (set_busy),
	(set_ready), (set_sensitive), (set_focus), (set_message),
	(switch_page), (do_cancel), (reset_dialog),
	(gdm_greeter_login_window_ready), (gdm_greeter_login_window_reset),
	(gdm_greeter_login_window_info),
	(gdm_greeter_login_window_problem),
	(gdm_greeter_login_window_info_query),
	(gdm_greeter_login_window_secret_info_query),
	(_gdm_greeter_login_window_set_display_is_local),
	(gdm_greeter_login_window_set_property),
	(gdm_greeter_login_window_get_property), (log_in_button_clicked),
	(cancel_button_clicked), (on_user_activated), (create_greeter),
	(gdm_greeter_login_window_constructor),
	(gdm_greeter_login_window_class_init),
	(gdm_greeter_login_window_init),
	(gdm_greeter_login_window_finalize),
	(gdm_greeter_login_window_new):
	* gui/simple-greeter/gdm-greeter-login-window.h:
	* gui/simple-greeter/gdm-greeter-session.c: (on_info),
	(on_problem), (on_ready), (on_reset), (on_info_query),
	(on_secret_info_query), (on_begin_verification), (on_query_answer),
	(on_select_session), (on_select_language), (on_select_user),
	(on_select_hostname), (on_cancelled), (on_disconnected),
	(start_login_window), (stop_login_window), (launch_compiz),
	(launch_metacity), (start_panel), (start_background),
	(start_window_manager), (gdm_greeter_session_set_level),
	(gdm_greeter_session_goto_level), (gdm_greeter_session_start),
	(gdm_greeter_session_init):
	* gui/simple-greeter/gdm-simple-greeter.c:
	* gui/simple-greeter/gdm-simple-greeter.glade:
	* gui/simple-greeter/gdm-simple-greeter.h:
	* gui/simple-greeter/greeter-main.c: (set_fatal_warnings), (main):
	More refactoring.  Change gdm-greeter.c to be just a window.
	Make greeter warnings fatal in development releases.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-server.h:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-client.c:
	(gdm_greeter_client_error_quark), (on_info), (on_problem),
	(on_ready), (on_reset), (on_info_query), (on_secret_info_query),
	(gdm_greeter_client_call_begin_verification),
	(gdm_greeter_client_call_answer_query),
	(gdm_greeter_client_call_select_session),
	(gdm_greeter_client_call_select_language),
	(gdm_greeter_client_call_select_user),
	(gdm_greeter_client_call_select_hostname),
	(gdm_greeter_client_call_cancel),
	(gdm_greeter_client_call_disconnect),
	(gdm_greeter_client_call_get_display_id), (proxy_destroyed),
	(gdm_greeter_client_start), (gdm_greeter_client_stop),
	(gdm_greeter_client_set_property),
	(gdm_greeter_client_get_property),
	(gdm_greeter_client_constructor), (gdm_greeter_client_dispose),
	(gdm_greeter_client_class_init), (gdm_greeter_client_init),
	(gdm_greeter_client_finalize), (gdm_greeter_client_new):
	* gui/simple-greeter/gdm-greeter-client.h:
	* gui/simple-greeter/gdm-greeter-session.c: (on_info),
	(on_problem), (on_ready), (on_reset), (on_info_query),
	(on_secret_info_query), (on_begin_verification), (on_query_answer),
	(on_select_session), (on_select_language), (on_select_user),
	(on_select_hostname), (on_cancelled), (on_disconnected),
	(start_login_window), (gdm_greeter_session_set_level),
	(gdm_greeter_session_start), (gdm_greeter_session_stop),
	(gdm_greeter_session_set_property),
	(gdm_greeter_session_get_property),
	(gdm_greeter_session_constructor), (gdm_greeter_session_dispose),
	(gdm_greeter_session_class_init), (gdm_greeter_session_init),
	(gdm_greeter_session_finalize), (gdm_greeter_session_new):
	* gui/simple-greeter/gdm-greeter-session.h:
	* gui/simple-greeter/gdm-user-manager.c: (gdm_user_manager_init):
	* gui/simple-greeter/greeter-main.c: (main):
	Refactor some of the greeter.  Break DBus client into new class.
	Create a GdmGreeterSession that will run external apps.

2007-10-23  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-common.c: (gdm_signal_pid):
	* common/gdm-common.h:
	* daemon/Makefile.am:
	* daemon/gdm-greeter-session.c: (spawn_child_setup),
	(stop_dbus_daemon), (gdm_greeter_session_stop):
	* daemon/gdm-server.c: (gdm_server_stop):
	* daemon/gdm-session-worker-job.c: (gdm_session_worker_job_stop):
	* daemon/gdm-slave-proxy.c: (kill_slave):
	* gui/simple-greeter/gdm-simple-greeter.c: (set_sensitive),
	(set_focus), (reset_dialog), (gdm_simple_greeter_info_query),
	(gdm_simple_greeter_secret_info_query), (log_in_button_clicked),
	(create_greeter), (gdm_simple_greeter_init):
	* gui/simple-greeter/gdm-simple-greeter.glade:
	Rework the dialog design a bit.

2007-10-18  Brian Cameron  <brian.cameron@sun.com>

	* daemon/gdm-session-record.c: Some trivial fixes.  The #ifdef
	  GETUTXENT got lost in the logout function.  It should match the
	  login function.  Also make sure to set both tv_sec and tv_usec when
	  doing logout.

2007-10-19  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-common.c: (gdm_signal_pid):
	* common/gdm-common.h:
	* daemon/Makefile.am:
	* daemon/gdm-greeter-session.c: (spawn_child_setup),
	(stop_dbus_daemon), (gdm_greeter_session_stop):
	* daemon/gdm-server.c: (gdm_server_stop):
	* daemon/gdm-session-worker-job.c: (gdm_session_worker_job_stop):
	* daemon/gdm-slave-proxy.c: (kill_slave):
	Move the signal_pid func to common.  Make the greeter process
	a session leader.  Signal greeter and dbus process groups instead
	of just the individual processes so that we clean up the entire greeter
	session.

2007-10-19  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-signal-handler.c: (signal_io_watch), (catch_signal),
	(uncatch_signal), (gdm_signal_handler_add), (callback_data_free),
	(gdm_signal_handler_remove_and_free_data),
	(gdm_signal_handler_remove), (find_callback_data_by_func),
	(gdm_signal_handler_remove_func), (signal_list_free),
	(gdm_signal_handler_init), (gdm_signal_handler_finalize):
	* common/gdm-signal-handler.h:
	* daemon/gdm-server.c: (add_ready_handler), (remove_ready_handler),
	(gdm_server_spawn), (gdm_server_init), (gdm_server_finalize):
	Assign ids to signal handlers.  Add functions to remove handlers.
	Restore sigaction when no handlers are present.  Fix some
	memory management bugs.

2007-10-18  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-record.c: (record_set_username),
	(record_set_timestamp), (record_set_pid), (record_set_id),
	(record_set_host), (record_set_line), (gdm_session_record_login),
	(gdm_session_record_logout), (gdm_session_record_failed):
	* daemon/gdm-session-record.h:
	* daemon/gdm-session.c:
	(gdm_session_user_verification_error_handler),
	(gdm_session_started_handler), (gdm_session_startup_error_handler),
	(gdm_session_exited_handler), (gdm_session_close):
	Try to reduce the complexity of the utmp/wtmp recording code.

2007-10-18  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am (test_session_SOURCES): Add file.

	* daemon/gdm-session-record.c (gdm_session_write_record):
	Make username const.
	(gdm_session_record_write): not static.

2007-10-18  William Jon McCann  <mccannwj@acsnb1>

	* daemon/gdm-session.c:
	(gdm_session_user_verification_error_handler),
	(gdm_session_started_handler), (gdm_session_startup_error_handler),
	(gdm_session_exited_handler), (gdm_session_close):
	Fix missed stuff.

2007-10-18  William Jon McCann  <mccannwj@acsnb1>

	* daemon/Makefile.am:
	* daemon/gdm-session-record.c: (gdm_session_write_record):
	* daemon/gdm-session-record.h:
	* daemon/gdm-session.c:
	(gdm_session_user_verification_error_handler),
	(gdm_session_started_handler), (gdm_session_startup_error_handler),
	(gdm_session_exited_handler), (gdm_session_close):
	Separate session recording writing stuff.

2007-10-18  Brian Cameron  <brian.cameron@sun.com>

	* daemon/gdm-slave.c:  Add signal.h include.

2007-10-18  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/gdm-session.c: (gdm_session_write_record):
	Make previous patch build on linux.

2007-10-18  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/gdm-session.c: (gdm_session_write_record):
	Merge changes from 2.20 branch to fix utmp/wtmp handling.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-10-18  William Jon McCann  <mccann@jhu.edu>

	* HACKING: Futz with the order.

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-md5.c: (gdm_md5_final):
	* common/gdm-settings-backend.c:
	* common/gdm-signal-handler.c: (gdm_signal_handler_init):
	* common/test-settings-client.c: (test_settings_client):
	* configure.ac:
	* daemon/gdm-factory-slave.c:
	* daemon/gdm-greeter-session.c: (gdm_greeter_session_spawn):
	* daemon/gdm-local-display-factory.c:
	* daemon/gdm-manager.c:
	* daemon/gdm-product-slave.c:
	* daemon/gdm-session-relay.c: (session_handle_child_message):
	* daemon/gdm-session.c: (handle_connection):
	* daemon/gdm-simple-slave.c:
	* daemon/gdm-xdmcp-display-factory.c:
	* daemon/main.c: (main):
	* daemon/session-worker-main.c: (main):
	* gui/simple-chooser/gdm-host-chooser-dialog.c: (on_response):
	* gui/simple-chooser/gdm-host-chooser-widget.c:
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(languages_parse_start_tag), (territories_parse_start_tag):
	* gui/simple-greeter/gdm-simple-greeter.c:
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_init):
	* gui/simple-greeter/greeter-main.c: (activate_power_manager):
	* gui/simple-greeter/test-user-manager.c: (main):
	Fix a bunch of compiler warnings.  Add Werror for now to
	warning flags.

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/fstype.c:
	Remove unused file.

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* HACKING:
	* README:
	Add some more info.

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* HACKING:
	Add hacking guidelines.

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* MAINTAINERS:
	Add Brian.
	* configure.ac:
	Set version to 2.21.1.  Change bugzilla product.

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-address.c: (gdm_address_new_from_sockaddr),
	(gdm_address_peek_local_list):
	* common/gdm-address.h:
	* daemon/gdm-xdmcp-display-factory.c: (do_bind),
	(create_address_from_request), (decode_packet):
	* gui/simple-chooser/gdm-host-chooser-widget.c: (decode_packet),
	(find_broadcast_addresses), (add_hosts):
	The function gdm_address_new_from_sockaddr_storage gets called in a
	few places with socket addresses that aren't necessary
	sockaddr_storage bytes big (all the places that call getaddrinfo).
	This results in the memdup call in that function potentially copying
	out of bounds bytes.
	Patch from: Ray Strode <halfline@gmail.com>

2007-10-15  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-background.c (update_background):
	Don't crash if background pattern can't be loaded.
	Patch from: Ray Strode <halfline@gmail.com>

2007-10-11  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-marshal.list:
	* daemon/gdm-product-slave.c: (reset_session), (on_relay_open):
	* daemon/gdm-session-worker.c: (gdm_session_worker_initialize_pam),
	(gdm_session_worker_verify_user), (gdm_session_worker_open),
	(open_idle), (queue_open), (on_begin_verification),
	(on_begin_verification_for_user), (gdm_session_worker_constructor):
	* daemon/gdm-session.c: (gdm_session_write_record),
	(do_introspect), (gdm_session_open), (send_begin_verification),
	(send_begin_verification_for_user):
	* daemon/gdm-session.h:
	* daemon/gdm-simple-slave.c: (on_greeter_cancel),
	(on_greeter_connected):
	* daemon/test-session.c: (main):
	Also pass x11-display when opening the session.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-10-10  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-server.c:
	Add include.

2007-10-09  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/Makefile.am:
	* daemon/main.c:
	* gui/simple-greeter/gdm-user-manager.c:
	Some build fixes for Solaris.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-10-05  William Jon McCann  <mccann@jhu.edu>

	* MAINTAINERS:
	Add name.

2007-10-05  William Jon McCann  <mccann@jhu.edu>

	* AUTHORS:
	Add Ray.

2007-10-05  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-simple-greeter.c: (launch_compiz),
	(launch_metacity), (create_greeter):
	Try to launch compiz or fallback to metacity.
	The test isn't a good one.

2007-10-05  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-greeter-background.c:
	(cairo_surface_get_width), (cairo_surface_get_height),
	(update_surface), (load_image), (update_background),
	(gdm_greeter_background_move_resize_window), (get_outside_region),
	(get_monitor_geometry), (update_geometry),
	(gdm_greeter_background_real_size_request),
	(gdm_greeter_background_real_expose),
	(gdm_greeter_background_real_configure),
	(gdm_greeter_background_class_init):
	* gui/simple-greeter/gdm-greeter-panel.c: (gdm_greeter_panel_init):
	* gui/simple-greeter/gdm-simple-greeter.c: (create_greeter):
	Make the background window sizing more robust.  And a little
	more efficient.  Also add some tranparency to the windows
	when running under a compositor.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* daemon/main.c: (set_effective_user), (set_effective_group),
	(set_effective_user_group), (gdm_daemon_check_permissions):
	Set euid to 0 before setting egid so it can succeed.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* AUTHORS:
	Add myself.

	* AUTHORS.pre-3.0:
	* ChangeLog.pre-3.0:
	* HACKING.pre-3.0:
	* MAINTAINERS.pre-3.0:
	* NEWS.pre-3.0:
	* README.pre-3.0:
	* TODO.pre-3.0:
	Remove obsolete files.

	* daemon/gdm-session.c:
	* daemon/gdm-session.h:
	* daemon/gdm-xdmcp-display-factory.h:
	Update copyright notices.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-common-unknown-origin.c: (gdm_safe_fopen_w):
	* common/gdm-common-unknown-origin.h:
	* common/gdm-common.c:
	* configure.ac:
	* daemon/gdm-slave.c: (gdm_slave_connect_to_x11_display):
	* daemon/gdm-xdmcp-display-factory.c:
	(gdm_xdmcp_handle_indirect_query),
	(gdm_xdmcp_handle_managed_forward):
	* daemon/main.c: (main_restoreenv), (gdm_restart_now),
	(check_logdir), (check_servauthdir), (set_effective_user_group),
	(gdm_daemon_check_permissions), (gdm_daemon_change_user), (main):
	Remove some more obsolete stuff.  Make distcheck happy.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* Makefile.am (SUBDIRS):
	* docs/C/.cvsignore:
	* docs/C/gdm.xml:
	* docs/C/legal.xml:
	* docs/C/make-and-upload.sh:
	* docs/Makefile.am:
	* docs/de/.cvsignore:
	* docs/de/Makefile.am:
	* docs/de/gdm-de.omf:
	* docs/de/gdm.xml:
	* docs/de/legal.xml:
	* docs/en_GB/Makefile.am:
	* docs/en_GB/en_GB.po:
	* docs/es/.cvsignore:
	* docs/es/Makefile.am:
	* docs/es/es.po:
	* docs/es/gdm-es.omf:
	* docs/es/gdm.xml:
	* docs/es/legal.xml:
	* docs/fr/.cvsignore:
	* docs/fr/Makefile.am:
	* docs/fr/gdm-fr.omf:
	* docs/fr/gdm.xml:
	* docs/fr/legal.xml:
	* docs/gdm.1:
	* docs/gdm.omf.in:
	* docs/it/.cvsignore:
	* docs/it/Makefile.am:
	* docs/it/gdm-it.omf:
	* docs/it/gdm.xml:
	* docs/it/legal.xml:
	* docs/ja/.cvsignore:
	* docs/ja/Makefile.am:
	* docs/ja/gdm-ja.omf:
	* docs/ja/gdm.xml:
	* docs/ja/legal.xml:
	* docs/ko/.cvsignore:
	* docs/ko/ko.po:
	* docs/sv/.cvsignore:
	* docs/sv/Makefile.am:
	* docs/sv/sv.po:
	* docs/uk/.cvsignore:
	* docs/uk/Makefile.am:
	* docs/uk/gdm-uk.omf:
	* docs/uk/gdm.xml:
	* docs/uk/legal.xml:
	* docs/uk/uk.po:
	* docs/zh_CN/.cvsignore:
	* docs/zh_CN/Makefile.am:
	* docs/zh_CN/gdm-zh_CN.omf:
	* docs/zh_CN/gdm.xml:
	* docs/zh_CN/legal.xml:
	* docs/zh_HK/.cvsignore:
	* docs/zh_HK/Makefile.am:
	* docs/zh_HK/gdm-zh_HK.omf:
	* docs/zh_HK/gdm.xml:
	* docs/zh_HK/legal.xml:
	* docs/zh_TW/.cvsignore:
	* docs/zh_TW/Makefile.am:
	* docs/zh_TW/gdm-zh_TW.omf:
	* docs/zh_TW/gdm.xml:
	* docs/zh_TW/legal.xml:
	Remove docs since they are obsolete.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* common/Makefile.am:
	* common/gdm-common-unknown-origin.c: (gdm_sigchld_block_push),
	(gdm_sigchld_block_pop), (gdm_sigterm_block_push),
	(gdm_sigterm_block_pop), (gdm_sigusr2_block_push),
	(gdm_sigusr2_block_pop), (gdm_safe_fopen_w), (ve_clearenv):
	* common/gdm-common-unknown-origin.h:
	* common/gdm-common.c:
	* common/gdm-common.h:
	* config/Makefile.am:
	* config/XKeepsCrashing:
	* config/default.desktop.in:
	* config/extract-shell.sh:
	* config/gdmprefetchlist.in:
	* config/gettextfoo.h:
	* config/locale.alias:
	* config/ssh.desktop.in.in:
	* configure.ac:
	* daemon/Makefile.am:
	* daemon/choose.c:
	* daemon/choose.h:
	* daemon/gdm-xdmcp-display-factory.c:
	(gdm_xdmcp_handle_indirect_query), (gdm_xdmcp_handle_manage),
	(gdm_xdmcp_handle_managed_forward):
	* daemon/main.c: (delete_pid):
	* utils/Makefile.am:
	* utils/gdm-dmx-reconnect-proxy.c:
	Remove some more obsolete code.  Move common
	code with unknown copyright status into separate file.
	Try to identify more copy with unknown copyright status.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* common/Makefile.am:
	* common/gdm-common.c:
	* common/gdm-common.h:
	* common/ve-signal.c:
	* common/ve-signal.h:
	* config/Makefile.am:
	* configure.ac:
	* daemon/Makefile.am:
	* daemon/auth.c:
	* daemon/filecheck.c:
	* daemon/filecheck.h:
	* daemon/gdm-factory-slave.c: (get_script_environment):
	* daemon/gdm-greeter-session.c: (get_greeter_environment):
	* daemon/gdm-product-slave.c: (get_script_environment):
	* daemon/gdm-server.c: (rotate_logs), (server_child_setup),
	(gdm_server_start):
	* daemon/gdm-simple-slave.c: (get_script_environment):
	* daemon/gdm-xdmcp-display-factory.c: (fd_set_close_on_exec),
	(open_port), (gdm_xdmcp_handle_request), (gdm_xdmcp_handle_manage):
	* libgreeter/Makefile.am:
	* libgreeter/gdmlanguages.c:
	* libgreeter/gdmlanguages.h:
	* libgreeter/gdmsession.c:
	* libgreeter/gdmsession.h:
	* libgreeter/gdmwm.c:
	* libgreeter/gdmwm.h:
	* utils/Makefile.am:
	* utils/gdm-ssh-session:
	* utils/gdmmktemp.c:
	* utils/gdmopen.c:
	* utils/gdmprefetch.c:
	* utils/gdmsetup-pam:
	* utils/gdmsetup-security.in:
	* utils/gdmtranslate.c:
	Remove lots of obsolete code.  Organize the configure checks a bit.

2007-10-04  William Jon McCann  <mccann@jhu.edu>

	* acinclude.m4:
	* common/Makefile.am:
	* configure.ac:
	* daemon/Makefile.am:
	* daemon/gdm-factory-slave.c: (run_greeter),
	(idle_connect_to_display):
	* daemon/gdm-product-slave.c: (setup_server),
	(idle_connect_to_display):
	* daemon/gdm-simple-slave.c: (run_greeter),
	(idle_connect_to_display):
	* daemon/gdm-slave.c: (gdm_slave_set_busy_cursor),
	(set_local_auth), (gdm_slave_connect_to_x11_display):
	* daemon/gdm-slave.h:
	* gui/Makefile.am:
	* gui/modules/.cvsignore:
	* gui/modules/AccessDwellMouseEvents.in:
	* gui/modules/AccessKeyMouseEvents.in:
	* gui/modules/Makefile.am:
	* gui/modules/dwellmouselistener.c:
	* gui/modules/keymouselistener.c:
	* gui/simple-chooser/Makefile.am:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/libnotificationarea/Makefile.am:
	* libgreeter/Makefile.am:
	Fix up the handling of dependencies.  Make the daemon
	only depend on x11, glib, gobject, dbus.  Move some
	things from the slaves to the base class.
	Remove the unused modules for now.

2007-10-03  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/greeter-main.c: (main):
	Init gnome-vfs.

2007-10-03  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	Also add here.

2007-10-03  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-private.h:
	Oops add file.

2007-10-03  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-user-chooser-widget.c: (populate_model),
	(on_user_added), (on_user_removed), (gdm_user_chooser_widget_init):
	* gui/simple-greeter/gdm-user-manager.c:
	(gdm_user_manager_error_quark), (gdm_user_manager_get_user),
	(listify_hash_values_hfunc), (gdm_user_manager_list_users),
	(reload_passwd), (reload_shells), (shells_monitor_cb),
	(passwd_monitor_cb), (gdm_user_manager_class_init),
	(reload_passwd_timeout), (queue_reload_passwd),
	(gdm_user_manager_init), (gdm_user_manager_finalize),
	(gdm_user_manager_ref_default):
	* gui/simple-greeter/gdm-user-manager.h:
	* gui/simple-greeter/gdm-user.c: (gdm_user_class_init),
	(gdm_user_init), (gdm_user_set_property), (gdm_user_get_property),
	(gdm_user_finalize), (_gdm_user_update), (_gdm_user_add_session),
	(_gdm_user_remove_session), (_gdm_user_icon_changed),
	(gdm_user_get_uid), (gdm_user_get_real_name),
	(gdm_user_get_user_name), (gdm_user_get_home_directory),
	(gdm_user_get_shell), (gdm_user_get_sessions),
	(gdm_user_get_n_sessions), (gdm_user_collate):
	* gui/simple-greeter/gdm-user.h:
	* gui/simple-greeter/test-user-chooser.c: (main):
	* gui/simple-greeter/test-user-manager.c: (on_user_added),
	(on_user_removed), (main):
	Add basic user monitoring.  Hook up to user-list.

2007-10-02  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (on_session_relay_info),
	(on_session_relay_problem), (on_session_relay_info_query),
	(on_session_relay_secret_info_query), (on_session_relay_opened),
	(on_session_relay_user_verified), (greeter_reset_timeout),
	(queue_greeter_reset), (on_session_relay_user_verification_error),
	(on_session_relay_disconnected),
	(on_session_relay_session_started),
	(on_greeter_begin_verification), (run_greeter),
	(gdm_factory_slave_start), (gdm_factory_slave_finalize):
	* daemon/gdm-greeter-server.c: (gdm_greeter_server_ready),
	(handle_begin_verification), (greeter_handle_child_message),
	(do_introspect), (gdm_greeter_server_class_init):
	* daemon/gdm-greeter-server.h:
	* daemon/gdm-local-display-factory.c: (create_display_for_device):
	* daemon/gdm-product-slave.c: (relay_session_opened),
	(on_session_opened), (on_session_user_verified),
	(on_session_user_verification_error), (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_relay_begin_verification),
	(create_new_session), (on_relay_cancelled),
	(connect_to_session_relay), (gdm_product_slave_start):
	* daemon/gdm-session-relay.c:
	(gdm_session_relay_begin_verification), (handle_user_verified),
	(handle_user_verification_error), (handle_opened),
	(session_handle_child_message), (do_introspect),
	(handle_connection), (gdm_session_relay_class_init):
	* daemon/gdm-session-relay.h:
	* daemon/gdm-session.c:
	* daemon/gdm-simple-slave.c: (on_session_user_verified),
	(on_session_user_verification_error), (on_session_info),
	(on_session_problem), (on_session_info_query),
	(on_session_secret_info_query), (on_session_opened),
	(create_new_session), (on_greeter_begin_verification),
	(on_greeter_user_selected), (run_greeter),
	(gdm_simple_slave_finalize):
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-simple-greeter.c: (switch_page),
	(do_cancel), (reset_dialog), (gdm_simple_greeter_ready),
	(gdm_simple_greeter_reset), (on_user_activated), (create_greeter),
	(gdm_simple_greeter_class_init):
	* gui/simple-greeter/gdm-simple-greeter.glade:
	* gui/simple-greeter/gdm-user-chooser-widget.c: (populate_model):
	* gui/simple-greeter/greeter-main.c: (on_ready),
	(on_begin_verification), (main):
	* libgreeter/gdm-greeter.c: (gdm_greeter_real_ready),
	(gdm_greeter_ready), (gdm_greeter_emit_begin_verification),
	(gdm_greeter_emit_answer_query), (gdm_greeter_class_init):
	* libgreeter/gdm-greeter.h:
	Require the greeter to call BeginVerification.  But only
	after the greeter is sent a Ready.

	Make the factory-slave report verification status.

	Audit the communication paths and apply some fixes.

	Hook up the user chooser in the greeter.  Only has dummy users.

2007-10-02  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_init):
	Oops really revert this time.

2007-10-02  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(add_user_to_model), (populate_model),
	(gdm_user_chooser_widget_init):
	Revert last commit.  Use simpler widget.
	Add tooltips and change orientation.

2007-10-02  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-icon-nav.c: (gdm_icon_nav_scroll_event),
	(gdm_icon_nav_adj_changed), (gdm_icon_nav_adj_value_changed),
	(gdm_icon_nav_scroll_step), (gdm_icon_nav_button_clicked),
	(gdm_icon_nav_start_scroll), (gdm_icon_nav_stop_scroll),
	(gdm_icon_nav_get_property), (gdm_icon_nav_set_property),
	(gdm_icon_nav_constructor), (gdm_icon_nav_class_init),
	(gdm_icon_nav_init), (gdm_icon_nav_new),
	(gdm_icon_nav_get_show_buttons), (gdm_icon_nav_set_show_buttons),
	(gdm_icon_nav_get_mode), (gdm_icon_nav_set_mode):
	* gui/simple-greeter/gdm-icon-nav.h:
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(gdm_user_chooser_widget_init):
	Use a custom scrolling widget for user list.  Adapted
	from eog-thumb-nav.

2007-10-02  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	* gui/simple-greeter/gdm-session-chooser-dialog.c:
	(gdm_session_chooser_dialog_init):
	* gui/simple-greeter/gdm-session-chooser-widget.c:
	* gui/simple-greeter/gdm-simple-greeter.c: (create_greeter):
	* gui/simple-greeter/gdm-user-chooser-dialog.c:
	(gdm_user_chooser_dialog_get_current_user_name),
	(gdm_user_chooser_dialog_set_property),
	(gdm_user_chooser_dialog_get_property),
	(gdm_user_chooser_dialog_constructor),
	(gdm_user_chooser_dialog_dispose),
	(gdm_user_chooser_dialog_class_init), (on_response),
	(gdm_user_chooser_dialog_init), (gdm_user_chooser_dialog_finalize),
	(gdm_user_chooser_dialog_new):
	* gui/simple-greeter/gdm-user-chooser-dialog.h:
	* gui/simple-greeter/gdm-user-chooser-widget.c:
	(chooser_user_free),
	(gdm_user_chooser_widget_get_current_user_name), (select_name),
	(gdm_user_chooser_widget_set_current_user_name),
	(gdm_user_chooser_widget_set_property),
	(gdm_user_chooser_widget_get_property),
	(gdm_user_chooser_widget_constructor),
	(gdm_user_chooser_widget_dispose),
	(gdm_user_chooser_widget_class_init), (on_selection_changed),
	(collect_users), (on_item_activated), (add_user_to_model),
	(get_pixbuf_for_user), (populate_model), (separator_func),
	(compare_user_names), (compare_user),
	(gdm_user_chooser_widget_init), (gdm_user_chooser_widget_finalize),
	(gdm_user_chooser_widget_new):
	* gui/simple-greeter/gdm-user-chooser-widget.h:
	* gui/simple-greeter/greeter-main.c: (activate_power_manager):
	* gui/simple-greeter/test-user-chooser.c: (main):
	Add skeleton for user switcher widget.

2007-10-01  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-session-chooser-widget.c:
	(gdm_session_chooser_widget_get_current_session_name),
	(select_name), (gdm_session_chooser_widget_dispose),
	(on_session_selected), (add_session_to_model), (populate_model),
	(separator_func), (compare_session_names), (compare_session),
	(gdm_session_chooser_widget_init):
	Add some "special" targets to the list for last and default.

2007-10-01  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-session-chooser-dialog.c:
	(gdm_session_chooser_dialog_get_current_session_name),
	(gdm_session_chooser_dialog_set_property),
	(gdm_session_chooser_dialog_get_property),
	(gdm_session_chooser_dialog_constructor),
	(gdm_session_chooser_dialog_dispose),
	(gdm_session_chooser_dialog_class_init), (on_response),
	(gdm_session_chooser_dialog_init),
	(gdm_session_chooser_dialog_finalize),
	(gdm_session_chooser_dialog_new):
	* gui/simple-greeter/gdm-session-chooser-dialog.h:
	* gui/simple-greeter/gdm-session-chooser-widget.c:
	(chooser_session_free),
	(gdm_session_chooser_widget_get_current_session_name),
	(select_name),
	(gdm_session_chooser_widget_set_current_session_name),
	(gdm_session_chooser_widget_set_property),
	(gdm_session_chooser_widget_get_property),
	(gdm_session_chooser_widget_constructor),
	(gdm_session_chooser_widget_dispose),
	(gdm_session_chooser_widget_class_init), (on_session_selected),
	(get_flags_from_key_file), (load_session_file),
	(collect_sessions_from_directory),
	(collect_sessions_from_directories), (collect_sessions),
	(on_row_activated), (add_session_to_model), (populate_model),
	(gdm_session_chooser_widget_init),
	(gdm_session_chooser_widget_finalize),
	(gdm_session_chooser_widget_new):
	* gui/simple-greeter/gdm-session-chooser-widget.h:
	* gui/simple-greeter/test-session-chooser.c: (main):
	Add a basic session chooser widget.

2007-09-24  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c: (gdm_session_worker_initialize_pam):
	Also check for empty hostname strings.
	* daemon/test-session.c: (on_open):
	Don't print null strings - solaris crashes.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-09-21  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-simple-greeter.c: (create_greeter):
	Use black circle for invisible char if '*' is currently default.

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(get_lc_identification), (add_locale_to_model):
	* gui/simple-greeter/test-language-chooser.c: (main):
	Don't print null strings - solaris crashes.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-language-chooser-dialog.c:
	(gdm_language_chooser_dialog_init):
	* gui/simple-greeter/gdm-language-chooser-widget.c: (parse_locale),
	(construct_language_name), (select_name),
	(gdm_language_chooser_widget_set_current_language_name),
	(collect_locales_from_archive), (collect_locales_from_directory):
	* gui/simple-greeter/gdm-language-chooser-widget.h:
	* gui/simple-greeter/test-language-chooser.c: (main):
	Add lang setting capability and set initially to $LANG

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-language-chooser-dialog.c:
	(gdm_language_chooser_dialog_dispose):
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(gdm_language_chooser_widget_get_current_language_name):
	Get the current selection.

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-language-chooser-widget.c: (parse_locale),
	(collect_locales_from_archive), (collect_locales_from_directory),
	(add_locale_to_model):
	Properly parse a locale name using the template [language[_territory][.codeset][@modifier]].

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-session.c: (get_greeter_environment),
	(signal_pid), (spawn_child_setup),
	(spawn_command_line_sync_as_user),
	(spawn_command_line_async_as_user), (parse_value_as_integer),
	(parse_dbus_launch_output), (start_dbus_daemon),
	(stop_dbus_daemon), (gdm_greeter_session_spawn),
	(gdm_greeter_session_stop), (gdm_greeter_session_init),
	(gdm_greeter_session_finalize):
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(parse_short_name):
	Manage the lifecycle of the D-Bus session since
	the X server doesn't exit.

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session.c:
	Remove old defines

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(get_lc_identification), (collect_locales_from_archive):
	Add ifdef LC_IDENTIFICATION.

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	* gui/simple-greeter/langinfo.h:
	Remove langinfo.h and use system header.

2007-09-19  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-chooser/Makefile.am:
	Add XDMCP_LIBS.

2007-09-18  William Jon McCann  <mccann@jhu.edu>

	* config/gdm:
	Disallow root login in pam config.

2007-09-18  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	Add the locale-related headers to fix distcheck.

2007-09-18  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-language-chooser-dialog.c:
	(gdm_language_chooser_dialog_get_current_language_name),
	(gdm_language_chooser_dialog_set_property),
	(gdm_language_chooser_dialog_get_property),
	(gdm_language_chooser_dialog_constructor),
	(gdm_language_chooser_dialog_dispose),
	(gdm_language_chooser_dialog_class_init), (on_response),
	(gdm_language_chooser_dialog_init),
	(gdm_language_chooser_dialog_finalize),
	(gdm_language_chooser_dialog_new):
	* gui/simple-greeter/gdm-language-chooser-dialog.h:
	* gui/simple-greeter/gdm-language-chooser-widget.c:
	(chooser_locale_free),
	(gdm_language_chooser_widget_get_current_language_name),
	(gdm_language_chooser_widget_set_property),
	(gdm_language_chooser_widget_get_property),
	(gdm_language_chooser_widget_constructor),
	(gdm_language_chooser_widget_dispose),
	(gdm_language_chooser_widget_class_init), (on_language_selected),
	(locale_exists), (utf8_convert), (get_lc_identification),
	(get_short_name_for_locale), (parse_short_name), (nameentcmp),
	(collect_locales_from_archive), (select_dirs),
	(collect_locales_from_directory), (collect_locales_from_aliases),
	(collect_locales), (on_row_activated), (get_translated_language),
	(get_language), (get_territory), (get_translated_territory),
	(languages_parse_start_tag), (territories_parse_start_tag),
	(languages_init), (territories_init), (add_locale_to_model),
	(populate_model), (gdm_language_chooser_widget_init),
	(gdm_language_chooser_widget_finalize),
	(gdm_language_chooser_widget_new):
	* gui/simple-greeter/gdm-language-chooser-widget.h:
	* gui/simple-greeter/langinfo.h:
	* gui/simple-greeter/libnotificationarea/Makefile.am:
	* gui/simple-greeter/locarchive.h:
	* gui/simple-greeter/test-language-chooser.c: (main):
	First shot at a language chooser widget that uses locale
	archives and iso-codes.

2007-09-13  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-greeter-background.c:
	(read_background_image_placement_from_string),
	(read_color_shading_from_string), (on_key_changed),
	(settings_init), (scale_pixbuf), (load_image), (update_background),
	(gdm_greeter_background_constructor),
	(gdm_greeter_background_dispose),
	(gdm_greeter_background_real_map),
	(gdm_greeter_background_real_realize),
	(gdm_greeter_background_real_configure),
	(gdm_greeter_background_real_expose),
	(gdm_greeter_background_class_init), (gdm_greeter_background_init):
	* gui/simple-greeter/gdm-simple-greeter.c: (create_greeter):
	* gui/simple-greeter/libbackground/*:
	* gui/simple-greeter/test-greeter-background.c: (main):
	Make background widget functional.  Will follow the
	gconf defaults in /desktop/gnome/background.  Removed
	libbackground.

2007-09-12  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/gdm-simple-greeter.c:
	Fix build

2007-09-12  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/libbackground:
	Added cut-n-paste lib.

2007-09-12  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/cutnpaste/*:
	Rename directory.
	* gui/simple-greeter/gdm-greeter-background.c:
	(gdm_greeter_background_set_property),
	(gdm_greeter_background_get_property),
	(gdm_greeter_background_constructor),
	(gdm_greeter_background_dispose),
	(gdm_greeter_background_real_map), (on_screen_size_changed),
	(gdm_greeter_background_real_realize),
	(gdm_greeter_background_real_unrealize),
	(gdm_greeter_background_class_init), (on_delete_event),
	(gdm_greeter_background_init), (gdm_greeter_background_finalize),
	(gdm_greeter_background_new):
	* gui/simple-greeter/gdm-greeter-background.h:
	* gui/simple-greeter/gdm-simple-greeter.c: (create_panel):
	Add a background widget.

2007-09-11  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-address.c: (gdm_address_is_loopback):
	Convert address to network byte order before comparison.
	Patch from Jacob Berkman <jacob@gnome.org>

2007-09-11  William Jon McCann  <mccann@jhu.edu>

	* config/gdm:
	* config/gdm-autologin:
	Update PAM config.

2007-09-11  William Jon McCann  <mccann@jhu.edu>

	* config/Makefile.am:
	* config/gnome.desktop.in.in:
	* configure.ac:
	Remove gnome-session.desktop since it is provided
	by gnome-session.

2007-09-11  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	Fix distcheck.

2007-09-10  William Jon McCann  <mccann@jhu.edu>

	* daemon/INTERNALS:
	* daemon/Makefile.am:
	* daemon/gdm-factory-slave.c: (on_greeter_start),
	(on_greeter_stop), (run_greeter), (gdm_factory_slave_stop):
	* daemon/gdm-greeter-proxy.c:
	* daemon/gdm-greeter-proxy.h:
	* daemon/gdm-greeter-session.c: (change_user),
	(greeter_session_child_setup), (open_greeter_session),
	(close_greeter_session), (get_greeter_environment),
	(gdm_slave_whack_temp_auth_file), (create_temp_auth_file),
	(greeter_session_child_watch), (gdm_greeter_session_spawn),
	(gdm_greeter_session_start), (greeter_session_died),
	(gdm_greeter_session_stop),
	(gdm_greeter_session_set_server_address),
	(_gdm_greeter_session_set_x11_display_name),
	(_gdm_greeter_session_set_x11_display_hostname),
	(_gdm_greeter_session_set_x11_display_device),
	(_gdm_greeter_session_set_x11_display_is_local),
	(_gdm_greeter_session_set_x11_authority_file),
	(_gdm_greeter_session_set_user_name),
	(_gdm_greeter_session_set_group_name),
	(gdm_greeter_session_set_property),
	(gdm_greeter_session_get_property),
	(gdm_greeter_session_constructor),
	(gdm_greeter_session_class_init), (gdm_greeter_session_init),
	(gdm_greeter_session_finalize), (gdm_greeter_session_new):
	* daemon/gdm-greeter-session.h:
	* daemon/gdm-simple-slave.c: (on_user_verified),
	(on_greeter_start), (on_greeter_stop), (run_greeter),
	(gdm_simple_slave_stop):
	* daemon/gdm-slave.c:
	Rename GdmGreeterProxy->GdmGreeterSession

2007-09-10  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-simple-greeter.c: (set_focus),
	(reset_dialog), (gdm_simple_greeter_info_query),
	(gdm_simple_greeter_secret_info_query):
	* gui/simple-greeter/gdm-simple-greeter.glade:
	* gui/simple-greeter/greeter-main.c:
	Don't auto-activate g-p-m.  Try to get focus in entry.

2007-09-08  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-server.c: (greeter_server_message_handler),
	(connection_filter_function):
	* daemon/gdm-session-relay.c: (session_relay_message_handler),
	(connection_filter_function):
	* daemon/gdm-session.c: (session_message_handler),
	(connection_filter_function):
	Don't print null strings - solaris crashes.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-09-05  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/gdm-greeter-server.c: (handle_get_display_id):
	* gui/simple-greeter/Makefile.am:
	* gui/simple-greeter/cutnpaste/Makefile.am:
	* gui/simple-greeter/cutnpaste/fixedtip.c: (button_press_handler),
	(expose_handler), (na_fixed_tip_class_init), (na_fixed_tip_init),
	(na_fixed_tip_position), (na_fixed_tip_parent_size_allocated),
	(na_fixed_tip_parent_screen_changed), (na_fixed_tip_new),
	(na_fixed_tip_set_markup), (na_fixed_tip_set_orientation):
	* gui/simple-greeter/cutnpaste/fixedtip.h:
	* gui/simple-greeter/cutnpaste/na-marshal.list:
	* gui/simple-greeter/cutnpaste/na-tray-manager.c:
	(na_tray_manager_init), (na_tray_manager_class_init),
	(na_tray_manager_finalize), (na_tray_manager_set_property),
	(na_tray_manager_get_property), (na_tray_manager_new),
	(na_tray_manager_plug_removed),
	(na_tray_manager_make_socket_transparent),
	(na_tray_manager_socket_exposed),
	(na_tray_manager_socket_style_set),
	(na_tray_manager_handle_dock_request), (pending_message_free),
	(na_tray_manager_handle_client_message_message_data),
	(na_tray_manager_handle_begin_message),
	(na_tray_manager_handle_cancel_message),
	(na_tray_manager_handle_client_message_opcode),
	(na_tray_manager_window_filter),
	(na_tray_manager_selection_clear_event),
	(na_tray_manager_unmanage),
	(na_tray_manager_set_orientation_property),
	(na_tray_manager_manage_screen_x11),
	(na_tray_manager_manage_screen),
	(na_tray_manager_check_running_screen_x11),
	(na_tray_manager_check_running), (na_tray_manager_get_child_title),
	(na_tray_manager_set_orientation),
	(na_tray_manager_get_orientation):
	* gui/simple-greeter/cutnpaste/na-tray-manager.h:
	* gui/simple-greeter/cutnpaste/na-tray.c: (get_tray), (tray_added),
	(tray_removed), (icon_tip_buffer_free), (icon_tip_free),
	(icon_tip_buffer_compare), (icon_tip_show_next_clicked),
	(icon_tip_show_next_timeout), (icon_tip_show_next), (message_sent),
	(message_cancelled), (update_orientation_for_messages),
	(update_size_and_orientation), (na_tray_init),
	(na_tray_constructor), (na_tray_dispose), (na_tray_set_property),
	(na_tray_size_request), (na_tray_size_allocate),
	(na_tray_class_init), (na_tray_new_for_screen),
	(na_tray_set_orientation), (na_tray_get_orientation),
	(idle_redraw_cb), (na_tray_force_redraw):
	* gui/simple-greeter/cutnpaste/na-tray.h:
	* gui/simple-greeter/cutnpaste/obox.c: (na_obox_class_init),
	(na_obox_init), (na_obox_new), (get_class), (na_obox_size_request),
	(na_obox_size_allocate), (na_obox_set_orientation):
	* gui/simple-greeter/cutnpaste/obox.h:
	* gui/simple-greeter/cutnpaste/testtray.c: (do_add),
	(update_child_count), (tray_added_cb), (tray_removed_cb),
	(orientation_changed_cb), (maybe_quit),
	(warning_dialog_response_cb), (add_tray_cb),
	(create_tray_on_screen), (main):
	* gui/simple-greeter/gdm-greeter-panel.c:
	(gdm_greeter_panel_set_property), (gdm_greeter_panel_get_property),
	(gdm_greeter_panel_constructor), (gdm_greeter_panel_dispose),
	(gdm_greeter_panel_move_resize_window), (on_screen_size_changed),
	(gdm_greeter_panel_real_realize),
	(gdm_greeter_panel_real_unrealize), (get_outside_region),
	(get_monitor_geometry), (set_struts), (update_struts),
	(update_geometry), (gdm_greeter_panel_real_size_request),
	(gdm_greeter_panel_class_init), (gdm_greeter_panel_init),
	(gdm_greeter_panel_finalize), (gdm_greeter_panel_new):
	* gui/simple-greeter/gdm-greeter-panel.h:
	* gui/simple-greeter/gdm-simple-greeter.c: (set_sensitive),
	(set_message), (create_greeter), (create_panel),
	(gdm_simple_greeter_constructor):
	* gui/simple-greeter/gdm-simple-greeter.glade:
	* gui/simple-greeter/greeter-main.c: (get_display_id):
	* gui/simple-greeter/test-greeter-panel.c: (main):
	Add a greeter panel bar with an embedded notification area.

2007-09-05  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (run_greeter):
	* daemon/gdm-greeter-server.c: (handle_disconnect),
	(handle_get_display_id), (greeter_handle_child_message),
	(do_introspect), (_gdm_greeter_server_set_display_id),
	(gdm_greeter_server_set_property),
	(gdm_greeter_server_get_property), (gdm_greeter_server_class_init),
	(gdm_greeter_server_new):
	* daemon/gdm-greeter-server.h:
	* daemon/gdm-simple-slave.c: (run_greeter),
	(gdm_simple_slave_stop):
	* daemon/gdm-slave.c: (gdm_slave_finalize):
	* gui/simple-greeter/gdm-simple-greeter.c:
	(suspend_button_clicked), (gdm_simple_greeter_new):
	* gui/simple-greeter/gdm-simple-greeter.h:
	* gui/simple-greeter/greeter-main.c: (on_select_hostname),
	(on_disconnected), (get_display_id), (main):
	* libgreeter/gdm-greeter.c: (gdm_greeter_display_is_local),
	(gdm_greeter_emit_disconnected), (_gdm_greeter_set_display_id),
	(gdm_greeter_set_property), (gdm_greeter_get_property),
	(cache_display_values), (gdm_greeter_constructor),
	(gdm_greeter_class_init), (gdm_greeter_finalize):
	* libgreeter/gdm-greeter.h:
	Add SelectHostname, Disconnected, and GetDisplayId methods
	to the greeter server interface.

2007-09-05  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-server.c: (handle_select_hostname),
	(greeter_handle_child_message), (do_introspect),
	(gdm_greeter_server_class_init):
	* daemon/gdm-greeter-server.h:
	Add SelectHostname to greeter interface.  For use
	with xdmcp host choosers.

2007-09-04  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c (gdm_session_worker_verify_user):
	Don't print null strings - solaris crashes.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-09-04  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-address.c: (gdm_address_peek_local_list):
	* daemon/gdm-xdmcp-display-factory.c: (do_bind),
	(gdm_xdmcp_send_failed):
	* gui/simple-chooser/chooser-main.c: (main):
	* gui/simple-chooser/gdm-host-chooser-widget.c: (chooser_host_add),
	(chooser_host_remove), (chooser_host_free), (find_known_host),
	(browser_add_host), (decode_packet), (do_ping), (xdmcp_discover),
	(find_broadcast_addresses), (add_hosts), (xdmcp_init),
	(gdm_host_chooser_widget_get_current_hostname),
	(gdm_host_chooser_widget_dispose),
	(gdm_host_chooser_widget_class_init), (on_host_selected),
	(on_row_activated), (gdm_host_chooser_widget_init):
	* gui/simple-chooser/gdm-host-chooser-widget.h:
	Make the chooser kinda work.

2007-08-31  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-chooser/Makefile.am:
	* gui/simple-chooser/gdm-host-chooser-widget.c: (decode_packet),
	(do_ping), (ping_try), (xdmcp_discover), (xdmcp_init),
	(gdm_host_chooser_widget_init):
	A bit more stuff for the chooser

2007-08-31  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-server.c: (generate_address):
	* daemon/gdm-session-relay.c: (generate_address):
	* daemon/gdm-session.c: (generate_address):
	Remove subdirectory in dbus socket tmpdir.

2007-08-31  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/gdm-server.c: (gdm_server_init):
	Use X_SERVER define instead of hardcoding xorg.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-08-30  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* gui/Makefile.am:
	* gui/simple-chooser/Makefile.am:
	* gui/simple-chooser/chooser-main.c: (main):
	* gui/simple-chooser/gdm-host-chooser-dialog.c:
	(gdm_host_chooser_dialog_get_current_hostname),
	(gdm_host_chooser_dialog_set_property),
	(gdm_host_chooser_dialog_get_property),
	(gdm_host_chooser_dialog_constructor),
	(gdm_host_chooser_dialog_dispose),
	(gdm_host_chooser_dialog_class_init), (on_response),
	(gdm_host_chooser_dialog_init), (gdm_host_chooser_dialog_finalize),
	(gdm_host_chooser_dialog_new):
	* gui/simple-chooser/gdm-host-chooser-dialog.h:
	* gui/simple-chooser/gdm-host-chooser-widget.c:
	(gdm_host_chooser_widget_refresh),
	(gdm_host_chooser_widget_get_current_hostname),
	(gdm_host_chooser_widget_set_property),
	(gdm_host_chooser_widget_get_property),
	(gdm_host_chooser_widget_constructor),
	(gdm_host_chooser_widget_dispose),
	(gdm_host_chooser_widget_class_init), (on_row_activated),
	(gdm_host_chooser_widget_init), (gdm_host_chooser_widget_finalize),
	(gdm_host_chooser_widget_new):
	* gui/simple-chooser/gdm-host-chooser-widget.h:
	* libgreeter/gdm-greeter.h:
	Add skeleton for chooser.

2007-08-29  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-local-display-factory.c:
	(create_displays_for_pci_devices):
	* daemon/test-hal-seats.c: (get_pci_seats):
	Initialize and free error in loop.

2007-08-28  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-address.c:
	* common/gdm-address.h:
	* common/gdm-common.c:
	* common/gdm-common.h:
	* common/gdm-log.c:
	* common/gdm-log.h:
	* common/gdm-md5.c:
	* common/gdm-md5.h:
	* common/gdm-settings-backend.c:
	* common/gdm-settings-backend.h:
	* common/gdm-settings-client.c:
	* common/gdm-settings-client.h:
	* common/gdm-settings-desktop-backend.c:
	* common/gdm-settings-desktop-backend.h:
	* common/gdm-settings-direct.c:
	* common/gdm-settings-direct.h:
	* common/gdm-settings-keys.h:
	* common/gdm-settings-utils.c:
	* common/gdm-settings-utils.h:
	* common/gdm-settings.c:
	* common/gdm-settings.h:
	* common/gdm-signal-handler.c:
	* common/gdm-signal-handler.h:
	* common/ve-signal.c:
	* common/ve-signal.h:
	* daemon/auth.c:
	* daemon/choose.c:
	* daemon/choose.h:
	* daemon/factory-slave-main.c:
	* daemon/filecheck.c:
	* daemon/gdm-display-factory.c:
	* daemon/gdm-display-factory.h:
	* daemon/gdm-display-store.c:
	* daemon/gdm-display-store.h:
	* daemon/gdm-display.c:
	* daemon/gdm-display.h:
	* daemon/gdm-factory-slave.c:
	* daemon/gdm-factory-slave.h:
	* daemon/gdm-greeter-proxy.c:
	* daemon/gdm-greeter-proxy.h:
	* daemon/gdm-greeter-server.c:
	* daemon/gdm-greeter-server.h:
	* daemon/gdm-local-display-factory.c:
	* daemon/gdm-local-display-factory.h:
	* daemon/gdm-manager.c:
	* daemon/gdm-manager.h:
	* daemon/gdm-product-display.c:
	* daemon/gdm-product-display.h:
	* daemon/gdm-product-slave.c:
	* daemon/gdm-product-slave.h:
	* daemon/gdm-server.c:
	* daemon/gdm-server.h:
	* daemon/gdm-session-relay.c:
	* daemon/gdm-session-relay.h:
	* daemon/gdm-session-worker-job.c:
	* daemon/gdm-session-worker-job.h:
	* daemon/gdm-session-worker.c:
	* daemon/gdm-session-worker.h:
	* daemon/gdm-session.c:
	* daemon/gdm-session.h:
	* daemon/gdm-simple-slave.c:
	* daemon/gdm-simple-slave.h:
	* daemon/gdm-slave-proxy.c:
	* daemon/gdm-slave-proxy.h:
	* daemon/gdm-slave.c:
	* daemon/gdm-slave.h:
	* daemon/gdm-static-display.c:
	* daemon/gdm-static-display.h:
	* daemon/gdm-static-factory-display.c:
	* daemon/gdm-static-factory-display.h:
	* daemon/gdm-xdmcp-display-factory.c:
	* daemon/gdm-xdmcp-display-factory.h:
	* daemon/gdm-xdmcp-display.c:
	* daemon/gdm-xdmcp-display.h:
	* daemon/main.c:
	* daemon/product-slave-main.c:
	* daemon/session-worker-main.c:
	* daemon/simple-slave-main.c:
	* daemon/test-hal-seats.c:
	* daemon/test-session.c:
	* gui/simple-greeter/gdm-simple-greeter.c:
	* gui/simple-greeter/gdm-simple-greeter.h:
	* gui/simple-greeter/greeter-main.c:
	* libgreeter/gdm-greeter.c:
	* libgreeter/gdm-greeter.h:
	* libgreeter/gdmlanguages.c:
	* libgreeter/gdmsession.c:
	Mass change tabs to spaces.  Tabs suck.

2007-08-28  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (on_greeter_answer):
	* daemon/gdm-greeter-server.c: (handle_answer_query):
	* daemon/gdm-product-slave.c: (on_relay_answer):
	* daemon/gdm-session-relay.c: (gdm_session_relay_answer_query):
	* daemon/gdm-session-worker.c:
	(gdm_session_worker_pam_new_messages_handler):
	* gui/simple-greeter/greeter-main.c: (on_query_answer):
	Don't echo authentication responses.

2007-08-23  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-display.c: (_gdm_display_set_seat_id),
	(gdm_display_set_property), (gdm_display_get_property),
	(gdm_display_class_init), (gdm_display_finalize):
	Add seat-id property.

2007-08-23  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	Add libresolv to EXTRA_DAEMON_LIBS on Solaris
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-08-22  William Jon McCann  <mccann@jhu.edu>

	* daemon/INTERNALS:
	Add some basic descriptions of some internals.

2007-08-22  William Jon McCann  <mccann@jhu.edu>

	* daemon/getvt.c:
	* daemon/getvt.h:
	* daemon/test-hal-seats.c:
	Remove getvt stuff.  Add little hal test tool.

2007-08-22  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-factory-slave.c: (run_greeter):
	* daemon/gdm-product-slave.c: (setup_server):
	* daemon/gdm-simple-slave.c: (run_greeter):
	Remove tsol_init stuff for now

2007-08-22  William Jon McCann  <mccann@jhu.edu>

	* configure.ac:
	* daemon/gdm-session-worker.c:
	(gdm_session_worker_give_user_credentials):
	Add support for non POSIX getpwnam_r

2007-08-21  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-display-factory.c:
	* daemon/gdm-factory-slave.c:
	* daemon/gdm-product-slave.c: (on_session_started):
	* daemon/gdm-xdmcp-display-factory.c:
	Remove unused signals variable.

2007-08-21  William Jon McCann  <mccann@jhu.edu>

	* daemon/test-session.c: (on_secret_info_query):
	Convert termio to termios stuff.

2007-08-21  William Jon McCann  <mccann@jhu.edu>

	* acconfig.h:
	* acinclude.m4:
	* common/gdm-address.c:
	* configure.ac:
	* daemon/Makefile.am:
	* daemon/factory-slave-main.c:
	* daemon/gdm-server.c: (server_child_setup):
	* daemon/main.c: (main):
	* daemon/product-slave-main.c:
	* daemon/session-worker-main.c:
	* daemon/simple-slave-main.c:
	* daemon/test-session.c: (on_secret_info_query):
	Some Solaris build fixes.
	Patch from Brian Cameron <brian.cameron@sun.com>

2007-08-03  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-display-factory.c: (gdm_display_factory_start),
	(gdm_display_factory_stop):
	* daemon/gdm-display-factory.h:
	* daemon/gdm-local-display-factory.c:
	(gdm_local_display_factory_start),
	(gdm_local_display_factory_stop),
	(gdm_local_display_factory_class_init):
	* daemon/gdm-local-display-factory.h:
	* daemon/gdm-manager.c: (gdm_manager_start),
	(gdm_manager_set_wait_for_go):
	* daemon/gdm-xdmcp-display-factory.c:
	(gdm_xdmcp_display_factory_start),
	(gdm_xdmcp_display_factory_stop),
	(gdm_xdmcp_display_factory_class_init):
	* daemon/gdm-xdmcp-display-factory.h:
	Fix up inheritance.

2007-08-03  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/gdm-display-factory.c: (gdm_display_factory_error_quark),
	(gdm_display_factory_get_display_store),
	(gdm_display_factory_start), (gdm_display_factory_stop),
	(gdm_display_factory_set_display_store),
	(gdm_display_factory_set_property),
	(gdm_display_factory_get_property),
	(gdm_display_factory_class_init), (gdm_display_factory_init),
	(gdm_display_factory_finalize):
	* daemon/gdm-display-factory.h:
	* daemon/gdm-local-display-factory.c: (create_display_for_device),
	(create_displays_for_pci_devices),
	(gdm_local_display_factory_start),
	(gdm_local_display_factory_set_property),
	(gdm_local_display_factory_get_property),
	(gdm_local_display_factory_class_init):
	* daemon/gdm-local-display-factory.h:
	* daemon/gdm-manager.c: (gdm_manager_start),
	(gdm_manager_set_wait_for_go), (gdm_manager_constructor),
	(gdm_manager_finalize):
	* daemon/gdm-xdmcp-display-factory.c:
	(gdm_xdmcp_display_factory_error_quark), (get_next_session_serial),
	(setup_multicast), (open_port), (gdm_xdmcp_num_displays_from_host),
	(gdm_xdmcp_display_lookup_by_host), (get_willing_output),
	(gdm_xdmcp_send_willing), (gdm_xdmcp_send_unwilling),
	(gdm_xdmcp_send_forward_query), (handle_any_query),
	(handle_direct_query), (gdm_xdmcp_handle_broadcast_query),
	(gdm_xdmcp_handle_query), (gdm_xdmcp_handle_indirect_query),
	(gdm_forward_query_dispose), (remove_oldest_forward),
	(gdm_forward_query_alloc), (gdm_forward_query_lookup),
	(gdm_xdmcp_whack_queued_managed_forwards),
	(gdm_xdmcp_handle_forward_query),
	(gdm_xdmcp_really_send_managed_forward), (managed_forward_handler),
	(gdm_xdmcp_send_managed_forward),
	(gdm_xdmcp_send_got_managed_forward), (count_sessions),
	(gdm_xdmcp_recount_sessions), (purge_displays),
	(gdm_xdmcp_displays_purge), (display_dispose_check),
	(gdm_xdmcp_send_decline), (gdm_xdmcp_display_alloc),
	(gdm_xdmcp_send_accept), (gdm_xdmcp_handle_request),
	(gdm_xdmcp_display_lookup), (gdm_xdmcp_send_failed),
	(gdm_xdmcp_send_refuse), (gdm_xdmcp_handle_manage),
	(gdm_xdmcp_handle_managed_forward),
	(gdm_xdmcp_handle_got_managed_forward), (gdm_xdmcp_send_alive),
	(gdm_xdmcp_handle_keepalive), (decode_packet),
	(gdm_xdmcp_display_factory_start),
	(gdm_xdmcp_display_factory_stop),
	(gdm_xdmcp_display_factory_set_port),
	(gdm_xdmcp_display_factory_set_use_multicast),
	(gdm_xdmcp_display_factory_set_multicast_address),
	(gdm_xdmcp_display_factory_set_honor_indirect),
	(gdm_xdmcp_display_factory_set_max_displays_per_host),
	(gdm_xdmcp_display_factory_set_max_displays),
	(gdm_xdmcp_display_factory_set_max_pending_displays),
	(gdm_xdmcp_display_factory_set_max_wait),
	(gdm_xdmcp_display_factory_set_willing_script),
	(gdm_xdmcp_display_factory_set_property),
	(gdm_xdmcp_display_factory_get_property),
	(gdm_xdmcp_display_factory_class_init),
	(gdm_xdmcp_display_factory_init),
	(gdm_xdmcp_display_factory_finalize),
	(gdm_xdmcp_display_factory_new):
	* daemon/gdm-xdmcp-display-factory.h:
	* daemon/gdm-xdmcp-manager.c:
	* daemon/gdm-xdmcp-manager.h:
	Add an abstract base class for display factories.  Rename
	gdm-xdmcp-manager to gdm-xdmcp-display-factory.

2007-08-02  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/gdm-local-display-factory.c:
	(gdm_local_display_factory_error_quark), (get_pci_seat_devices),
	(gdm_local_display_factory_start),
	(gdm_local_display_factory_stop),
	(gdm_local_display_factory_set_display_store),
	(gdm_local_display_factory_set_property),
	(gdm_local_display_factory_get_property),
	(gdm_local_display_factory_class_init), (connect_to_hal),
	(disconnect_from_hal), (gdm_local_display_factory_init),
	(gdm_local_display_factory_finalize),
	(gdm_local_display_factory_new):
	* daemon/gdm-local-display-factory.h:
	* daemon/gdm-manager.c: (gdm_manager_start),
	(gdm_manager_set_wait_for_go), (gdm_manager_constructor):
	Add new object that will monitor HAL and act as a factory
	for displays.

2007-08-01  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session-worker.c: (open_idle), (free_open_data),
	(queue_open), (on_begin_verification),
	(on_begin_verification_for_user):
	* daemon/gdm-session.c: (gdm_session_handle_verification_failed):
	* daemon/gdm-simple-slave.c: (greeter_reset_timeout),
	(queue_greeter_reset), (on_user_verification_error):
	* gui/simple-greeter/gdm-simple-greeter.c: (set_message),
	(do_cancel), (reset_dialog), (gdm_simple_greeter_reset),
	(gdm_simple_greeter_info), (gdm_simple_greeter_problem),
	(gdm_simple_greeter_info_query),
	(gdm_simple_greeter_secret_info_query), (cancel_button_clicked):
	* gui/simple-greeter/gdm-simple-greeter.glade:
	Report errors to the greeter.  Reset greeter after errors.
	Open the session in an idle.

2007-08-01  William Jon McCann  <mccann@jhu.edu>

	* gui/simple-greeter/gdm-simple-greeter.c: (set_busy), (set_ready),
	(set_sensitive), (reset_dialog), (gdm_simple_greeter_info_query),
	(gdm_simple_greeter_secret_info_query), (ok_button_clicked),
	(cancel_button_clicked), (create_greeter):
	* gui/simple-greeter/gdm-simple-greeter.glade:
	Change sensitivity and cursor when waiting.

2007-08-01  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-session.c: (answer_pending_query):
	* daemon/gdm-simple-slave.c: (create_new_session),
	(on_greeter_cancel):
	Reopen the session after the greeter is cancelled.

2007-08-01  William Jon McCann  <mccann@jhu.edu>

	* daemon/Makefile.am:
	* daemon/ck-connector.c: (lookup_parameter_type),
	(add_param_basic), (_ck_connector_free), (ck_connector_unref),
	(ck_connector_ref), (ck_connector_new),
	(ck_connector_open_session),
	(ck_connector_open_session_with_parameters_valist),
	(ck_connector_open_session_with_parameters),
	(ck_connector_open_session_for_user), (ck_connector_get_cookie),
	(ck_connector_close_session):
	* daemon/ck-connector.h:
	* daemon/gdm-ck-session.c:
	* daemon/gdm-ck-session.h:
	* daemon/gdm-factory-slave.c: (run_greeter):
	* daemon/gdm-greeter-proxy.c: (open_greeter_session),
	(close_greeter_session), (get_greeter_environment),
	(greeter_proxy_child_watch), (gdm_greeter_proxy_spawn),
	(gdm_greeter_proxy_stop),
	(_gdm_greeter_proxy_set_x11_display_hostname),
	(_gdm_greeter_proxy_set_x11_display_is_local),
	(gdm_greeter_proxy_set_property), (gdm_greeter_proxy_get_property),
	(gdm_greeter_proxy_class_init), (gdm_greeter_proxy_init),
	(gdm_greeter_proxy_finalize), (gdm_greeter_proxy_new):
	* daemon/gdm-greeter-proxy.h:
	* daemon/gdm-simple-slave.c: (slave_open_ck_session),
	(setup_session_environment), (run_greeter):
	Make ConsoleKit session registration more robust and complete.

2007-07-26  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-greeter-proxy.c: (close_greeter_session),
	(greeter_proxy_child_watch), (gdm_greeter_proxy_stop):
	Close greeter ConsoleKit session.

2007-07-26  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-ck-session.c: (open_ck_session), (close_ck_session):
	* daemon/gdm-ck-session.h:
	* daemon/gdm-greeter-proxy.c: (open_greeter_session),
	(gdm_greeter_proxy_spawn):
	* daemon/gdm-simple-slave.c: (slave_open_ck_session),
	(setup_session_environment), (gdm_simple_slave_init):
	Register user session with ConsoleKit.

2007-07-25  William Jon McCann  <mccann@jhu.edu>

	* common/gdm-address.c: (gdm_address_get_hostname),
	(gdm_address_get_numeric_info), (address_family_str),
	(gdm_address_debug):
	* common/gdm-address.h:
	* daemon/Makefile.am:
	* daemon/auth.c: (gdm_auth_add_entry),
	(gdm_auth_add_entry_for_display), (gdm_auth_user_add):
	* daemon/auth.h:
	* daemon/gdm-ck-session.c: (unlock_ck_session):
	* daemon/gdm-display.c: (gdm_display_real_add_user_authorization),
	(gdm_display_add_user_authorization),
	(gdm_display_real_remove_user_authorization),
	(gdm_display_remove_user_authorization),
	(gdm_display_get_x11_display_number),
	(gdm_display_get_x11_display_name),
	(_gdm_display_set_x11_display_number),
	(_gdm_display_set_x11_display_name), (gdm_display_set_property),
	(gdm_display_get_property), (gdm_display_class_init):
	* daemon/gdm-display.h:
	* daemon/gdm-display.xml:
	* daemon/gdm-factory-slave.c: (run_greeter):
	* daemon/gdm-greeter-proxy.c: (listify_hash):
	* daemon/gdm-product-display.c:
	(gdm_product_display_add_user_authorization),
	(gdm_product_display_remove_user_authorization),
	(gdm_product_display_class_init), (gdm_product_display_new):
	* daemon/gdm-simple-slave.c: (listify_hash),
	(get_script_environment), (add_user_authorization),
	(setup_session_environment), (run_greeter),
	(gdm_simple_slave_init):
	* daemon/gdm-slave.c: (gdm_slave_real_start),
	(gdm_slave_add_user_authorization),
	(_gdm_slave_set_display_number), (gdm_slave_set_property),
	(gdm_slave_get_property), (gdm_slave_class_init):
	* daemon/gdm-slave.h:
	* daemon/gdm-static-display.c:
	(gdm_static_display_add_user_authorization),
	(gdm_static_display_remove_user_authorization),
	(gdm_static_display_class_init), (gdm_static_display_new):
	* daemon/gdm-static-factory-display.c:
	(gdm_static_factory_display_add_user_authorization),
	(gdm_static_factory_display_remove_user_authorization),
	(gdm_static_factory_display_class_init),
	(gdm_static_factory_display_new):
	* daemon/gdm-xdmcp-display.c: (gdm_xdmcp_display_create_authority),
	(gdm_xdmcp_display_add_user_authorization),
	(gdm_xdmcp_display_remove_user_authorization),
	(_gdm_xdmcp_display_set_remote_address),
	(gdm_xdmcp_display_set_property), (gdm_xdmcp_display_class_init),
	(gdm_xdmcp_display_new):
	* daemon/gdm-xdmcp-manager.c: (do_bind), (gdm_xdmcp_host_allow),
	(lookup_by_host), (gdm_xdmcp_send_willing),
	(gdm_xdmcp_send_unwilling), (gdm_xdmcp_send_forward_query),
	(gdm_forward_query_dispose), (gdm_forward_query_lookup),
	(gdm_xdmcp_handle_forward_query),
	(gdm_xdmcp_really_send_managed_forward),
	(gdm_xdmcp_send_got_managed_forward), (remove_host),
	(gdm_xdmcp_send_decline), (gdm_xdmcp_display_alloc),
	(gdm_xdmcp_send_accept), (gdm_xdmcp_handle_request),
	(gdm_xdmcp_handle_manage), (gdm_xdmcp_handle_managed_forward),
	(gdm_xdmcp_handle_got_managed_forward),
	(gdm_xdmcp_handle_keepalive), (decode_packet):
	* data/gdm.conf:
	* gui/simple-greeter/greeter-main.c: (main):
	Make XDMCP logins work.

2007-07-24  William Jon McCann  <mccann@jhu.edu>

	* daemon/gdm-display.c: (finish_idle), (queue_finish),
	(slave_exited), (slave_died), (gdm_display_manage),
	(gdm_display_real_finish), (gdm_display_finish),
	(gdm_display_dispose), (gdm_display_class_init):
	* daemon/gdm-display.h:
	* daemon/gdm-manager.c: (load_static_displays_from_file):
	* daemon/gdm-product-display.c: (gdm_product_display_finish),
	(gdm_product_display_class_init):
	* daemon/gdm-simple-slave.c: (on_session_exited),
	(on_session_died), (on_opened), (create_new_session),
	(on_greeter_start), (on_greeter_stop), (on_greeter_user_selected),
	(on_greeter_cancel), (on_greeter_connected), (run_greeter),
	(gdm_simple_slave_finalize):
	* daemon/gdm-slave-proxy.c: (child_watch),
	(gdm_slave_proxy_dispose), (gdm_slave_proxy_class_init):
	* daemon/gdm-static-display.c: (gdm_static_display_finish),
	(gdm_static_display_class_init):
	* daemon/gdm-static-factory-display.c:
	(gdm_static_factory_display_finish),
	(gdm_static_factory_display_class_init):
	Dogfood static display.  Make static display work.  Add a finished
	state to the Display.  Always restart static displays on finish.

2007-07-22  Richard Hughes  <richard@hughsie.com>

	* common/Makefile.am:
	* daemon/Makefile.am:
	* data/Makefile.am:
	* gui/simple-greeter/Makefile.am:
	* libgreeter/Makefile.am:
	* po/POTFILES.in:
	* po/POTFILES.skip:
	* utils/Makefile.am:
	Fix make distcheck.

